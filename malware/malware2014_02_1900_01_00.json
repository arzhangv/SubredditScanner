{"data": [{"link_id": "t3_1yadqc", "score_hidden": false, "edited": false, "author_flair_css_class": null, "id": "cfjmrpe", "subreddit_id": "t5_2qrkp", "ups": 5, "controversiality": 0, "score": 5, "body": "Actually, the data can be decrypted. I threw together a little program that uses cryptlib and the hard coded key that jtsylve discovered and I was able to decrypt all of the samples that NeoSulc posted.\n\n[Here's the source code](http://pastebin.com/F6RfGrRh) if anyone's interested. It was only ment to be a test so the code isn't the best. I've only run it on Linux but it should compile and run on Windows as well.", "created_utc": 1392851146, "parent_id": 27060838135, "gilded": 0, "archived": true, "distinguished": null, "removal_reason": null, "author": "epinull", "author_flair_text": null, "subreddit": "Malware", "downs": 0, "retrieved_utc": 1432471986, "updated_utc": 1668791222, "body_sha1": "5b0bdb54e8549642fe20ccaf4f4c8e90169dda35", "utc_datetime_str": "2014-02-19 23:05:46"}, {"archived": true, "gilded": 0, "parent_id": 27060858632, "created_utc": 1392850569, "downs": 0, "subreddit": "Malware", "author_flair_text": null, "removal_reason": null, "author": "flex_mentallo", "distinguished": null, "author_flair_css_class": null, "id": "cfjmhb6", "subreddit_id": "t5_2qrkp", "ups": 4, "edited": false, "link_id": "t3_1yc9os", "score_hidden": false, "body": "oddly enough all of OP's posts are from Techworm.net. ", "score": 4, "controversiality": 0, "retrieved_utc": 1432471857, "updated_utc": 1668791222, "body_sha1": "1eaddf4ddc414c1e37037a74fff69dce561f3d7b", "utc_datetime_str": "2014-02-19 22:56:09"}, {"controversiality": 0, "body": "Do we know for certain that it wasn't ECB mode? The 193 bytes might just be jargon, or some kind of identifier that allows the malware to identify files that it has encrypted.\n\nA quick way to check is to make a file that's full of null bytes (0x00) and get the malware to encrypt it. If there are repeating patterns, it's ECB.", "removal_reason": null, "score_hidden": false, "edited": false, "archived": true, "downs": 0, "distinguished": null, "link_id": "t3_1yadqc", "id": "cfjh9uy", "author_flair_css_class": null, "subreddit_id": "t5_2qrkp", "subreddit": "Malware", "ups": 1, "author_flair_text": null, "parent_id": 27060838135, "created_utc": 1392840782, "score": 1, "author": "gsuberland", "gilded": 0, "retrieved_utc": 1432469388, "updated_utc": 1668791218, "body_sha1": "8c868cc8a822ceba3d41bc82d8a605531b36aa5c", "utc_datetime_str": "2014-02-19 20:13:02"}, {"author": "NeoSulc", "gilded": 0, "score": 2, "created_utc": 1392840168, "parent_id": 27060948684, "author_flair_text": null, "ups": 2, "subreddit_id": "t5_2qrkp", "subreddit": "Malware", "author_flair_css_class": null, "id": "cfjgyhr", "link_id": "t3_1yadqc", "downs": 0, "distinguished": null, "archived": true, "edited": false, "score_hidden": false, "removal_reason": null, "body": "I'll try this.\n\nThank you for your hard work.\n", "controversiality": 0, "retrieved_utc": 1432469238, "updated_utc": 1668791217, "body_sha1": "58a5309334cae1d7f9a08770af1951cbbd003d3d", "utc_datetime_str": "2014-02-19 20:02:48"}, {"archived": true, "score_hidden": false, "edited": false, "body": "The original files do not appear to be overwritten or securely deleted, so they may be recoverable.", "controversiality": 0, "removal_reason": null, "id": "cfje1n0", "link_id": "t3_1yadqc", "distinguished": null, "downs": 0, "ups": 3, "subreddit_id": "t5_2qrkp", "subreddit": "Malware", "author_flair_css_class": null, "score": 3, "author": "jtsylve", "gilded": 0, "created_utc": 1392834435, "parent_id": 27060838135, "author_flair_text": null, "retrieved_utc": 1432467867, "updated_utc": 1668791214, "body_sha1": "fd87b98728ec793965a56d95d557d1df2dcf55df", "utc_datetime_str": "2014-02-19 18:27:15"}, {"ups": 7, "archived": true, "removal_reason": null, "controversiality": 0, "author_flair_css_class": null, "id": "cfjc45k", "link_id": "t3_1yc9os", "subreddit": "Malware", "gilded": 0, "distinguished": null, "score_hidden": false, "edited": true, "score": 7, "parent_id": null, "body": "&gt; Segura wrote in the post that to make identification more difficult the appended data is encrypted with Base64, RC4.\n\nEncrypted with base64? Are they even reading what they're writing?\n\n---\n\n[Original blogpost](http://blog.malwarebytes.org/security-threat/2014/02/hiding-in-plain-sight-a-story-about-a-sneaky-banking-trojan/). Techworm.net adds *nothing* of value.", "author": "[deleted]", "downs": 0, "created_utc": 1392830609, "subreddit_id": "t5_2qrkp", "author_flair_text": null, "retrieved_utc": 1432466927, "updated_utc": 1668791212, "body_sha1": "091b32abd9ad9d45b60a096c055d0614d8f1503d", "edited_on": 1392830862, "nest_level": 1, "utc_datetime_str": "2014-02-19 17:23:29"}, {"edited": false, "score": 5, "score_hidden": false, "gilded": 0, "distinguished": null, "subreddit": "Malware", "link_id": "t3_1yadqc", "id": "cfjboc7", "controversiality": 0, "author_flair_css_class": null, "removal_reason": null, "archived": true, "ups": 5, "author_flair_text": null, "subreddit_id": "t5_2qrkp", "downs": 0, "created_utc": 1392829708, "body": "So I have some bad news... After reading more about cryptlib and diving a bit more into the malware, It's likely that it won't be possible to decrypt these files.\n\n The cryptlib documentation [here](ftp://ftp.franken.de/pub/crypt/cryptlib/manual.pdf) states that if you don't provide an IV before encryption, that cryptlib will generate one for you.  You're supposed to call *cryptGetAttributeString* to get the generated IV and then store it or transmit it so you can decrypt later.\n\nLooking at the encryption routine, they didn't do this.  In fact there aren't any calls to cryptGetAttributeString at all and the only call to cryptSetAttributeString was to set the key, so they didn't choose an IV either.\n\nSince these assholes never intended on decrypting the data, they didn't bother collecting and storing the IV.  Without the IV it won't be possible to decrypt the data.\n\nI'm sorry for the bad news.  If it's okay with you I'm going to do a write up of my analysis and post it on my company's blog ([www.504ensics.com](http://www.504ensics.com)).  Hopefully someone will read it and prove me wrong, but sadly it doesn't seem to be the case.", "author": "jtsylve", "parent_id": 27060502570, "retrieved_utc": 1432466721, "updated_utc": 1668791212, "body_sha1": "584acd14164e7970d62fa008cdc5e91dc6a736b0", "utc_datetime_str": "2014-02-19 17:08:28"}, {"ups": 1, "created_utc": 1392826530, "score": 1, "archived": true, "author": "jtsylve", "body": "You don't have to write the decryption routine in delphi.  I'll see if I have time to work up something today.  It depends on how busy things are at work.", "gilded": 0, "downs": 0, "score_hidden": false, "author_flair_css_class": null, "author_flair_text": null, "edited": false, "link_id": "t3_1yadqc", "subreddit_id": "t5_2qrkp", "distinguished": null, "subreddit": "Malware", "parent_id": 27060352384, "id": "cfja5zu", "controversiality": 0, "removal_reason": null, "retrieved_utc": 1432465943, "updated_utc": 1668791211, "body_sha1": "ade0a155ebf3a4dbaec619b13ecc1e9ecbe4eb01", "utc_datetime_str": "2014-02-19 16:15:30"}, {"id": "cfja1rq", "parent_id": 27060502570, "subreddit": "Malware", "removal_reason": null, "controversiality": 0, "distinguished": null, "downs": 0, "score_hidden": false, "gilded": 0, "author": "jtsylve", "body": "Yes:\n\n    call    cryptCreateEnvelopeWrapper\n    mov     ebx, eax\n    mov     ecx, offset _str_8j9Ak3N5a9m4s0J.Text ; 8j9Ak3N5a9m4s0J2b3H7d1P2b6\n    mov     edx, 5007       ; CRYPT_ENVINFO_KEY\n    mov     eax, ebx\n    call    cryptSetAttributeStringWrapper\n    mov     ecx, 8          ; CRYPT_ALGO_AES\n    mov     edx, 106        ; CRYPT_OPTION_ENCR_ALGO\n    mov     eax, ebx\n    call    cryptSetAttributeWrapper\n    ", "author_flair_text": null, "edited": true, "link_id": "t3_1yadqc", "subreddit_id": "t5_2qrkp", "author_flair_css_class": null, "score": 1, "ups": 1, "created_utc": 1392826270, "archived": true, "retrieved_utc": 1432465886, "updated_utc": 1668791211, "body_sha1": "844fc0c3ce39524831b97b97e8a215c27a1fb703", "edited_on": 1392829784, "utc_datetime_str": "2014-02-19 16:11:10"}, {"score": 1, "ups": 1, "created_utc": 1392819565, "archived": true, "gilded": 0, "downs": 0, "score_hidden": false, "author": "GFandango", "body": "No what you have provided so far is great, thanks. I'll try carve out some time and see if I can do anything tomorrow night.\n\nIn the meantime please backup all the files (encrypted or otherwise).\n\nChances are this will become more widespread in the near future and people will figure out how to decrypt it.", "author_flair_text": null, "link_id": "t3_1yadqc", "edited": false, "subreddit_id": "t5_2qrkp", "author_flair_css_class": null, "distinguished": null, "parent_id": 27060508033, "id": "cfj7ecl", "subreddit": "Malware", "removal_reason": null, "controversiality": 0, "retrieved_utc": 1432464637, "updated_utc": 1668791209, "body_sha1": "37649665473bc22f345e3bcb74cca317f37d3de4", "utc_datetime_str": "2014-02-19 14:19:25"}], "error": null, "metadata": {"es": {"took": 61, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 19, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1392796860000}}}, {"range": {"created_utc": {"lt": 1392883260000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1392796860000}}},{\"range\":{\"created_utc\":{\"lt\":1392883260000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1673945683.810305, "api_request_start": 1674102479.0552607, "api_request_end": 1674102479.1422334, "api_total_time": 0.08697271347045898}}