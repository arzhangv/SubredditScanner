{"data": [{"all_awardings": [], "associated_award": null, "author": "DrinkMoreCodeMore", "author_created_utc": 1427838830, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_mm8g4", "author_patreon_flair": false, "author_premium": false, "awarders": [], "body": "The group that keeps on giving!", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "comment_type": null, "controversiality": 0, "created_utc": 1608789412, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "ggvjdgb", "is_submitter": true, "link_id": "t3_kj8d54", "locked": false, "no_follow": false, "parent_id": 35848545460, "permalink": "/r/Malware/comments/kj8d54/emotet_returns_to_hit_100k_mailboxes_per_day/ggvjdgb/", "quarantined": false, "removal_reason": null, "score": 3, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1619681598, "updated_utc": 1668698332, "body_sha1": "1d1e41896f94db268ef8ece2804e289ae89334ea", "utc_datetime_str": "2020-12-24 05:56:52"}, {"all_awardings": [], "associated_award": null, "author": "[deleted]", "author_created_utc": null, "author_flair_background_color": "", "author_flair_css_class": null, "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": "dark", "author_fullname": null, "awarders": [], "body": "How wholesome, dropping Christmas presents!", "can_gild": false, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "comment_type": null, "controversiality": 0, "created_utc": 1608783431, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "ggvaqpg", "is_submitter": false, "link_id": "t3_kj8d54", "locked": false, "no_follow": false, "parent_id": null, "permalink": "/r/Malware/comments/kj8d54/emotet_returns_to_hit_100k_mailboxes_per_day/ggvaqpg/", "quarantined": false, "removal_reason": null, "score": 11, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1619677561, "updated_utc": 1668698319, "body_sha1": "edf4854f02672c8362f58a172e309e58f36d9602", "nest_level": 1, "utc_datetime_str": "2020-12-24 04:17:11"}, {"all_awardings": [], "associated_award": null, "author": "[deleted]", "author_created_utc": null, "author_flair_background_color": "", "author_flair_css_class": null, "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": "dark", "author_fullname": null, "awarders": [], "body": "[deleted]", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "comment_type": null, "controversiality": 0, "created_utc": 1608773000, "distinguished": null, "edited": true, "gilded": 0, "gildings": {}, "id": "ggusrdk", "is_submitter": false, "link_id": "t3_khsv1n", "locked": false, "no_follow": true, "parent_id": 35834727679, "permalink": "/r/Malware/comments/khsv1n/wikipedia_article_about_memz_a_trojan_originally/ggusrdk/", "quarantined": false, "removal_reason": null, "score": 1, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1619669169, "updated_utc": 1668698297, "body_sha1": "228f7d207920fb84335fac5b2b06ed7b472ece9e", "edited_on": 1609659960, "utc_datetime_str": "2020-12-24 01:23:20"}, {"all_awardings": [], "associated_award": null, "author": "[deleted]", "author_created_utc": null, "author_flair_background_color": "", "author_flair_css_class": null, "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": "dark", "author_fullname": null, "awarders": [], "body": "[removed]", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "comment_type": null, "controversiality": 0, "created_utc": 1608762514, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "ggu9hfx", "is_submitter": false, "link_id": "t3_kiohgu", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/kiohgu/what_language_is_malware_usually_coded_in/ggu9hfx/", "quarantined": false, "removal_reason": null, "score": 1, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1619660168, "updated_utc": 1668698275, "body_sha1": "fe993932d6dced4c0a879e9aa5d7a6e0fbb467f5", "nest_level": 1, "utc_datetime_str": "2020-12-23 22:28:34"}, {"all_awardings": [], "associated_award": null, "author": "AutoModerator", "author_created_utc": 1325741068, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_6l4z3", "author_patreon_flair": false, "author_premium": true, "awarders": [], "body": "It looks like you are posting a question, possibly looking for technical support. \n\nThis subreddit\u2019s purpose is to discuss malware internals and technical details. *This is NOT a place for help with malware removal or various other end-user questions. Please redirect questions related to malware removal to /r/Antivirus or /r/techsupport. Ransomware related questions can be directed to /r/ransomware*\n\nIf this was removed in error, please message the moderators - we love reading quality content just as much as you do!\n\n\n*I am a bot, and this action was performed automatically. Please [contact the moderators of this subreddit](/message/compose/?to=/r/Malware) if you have any questions or concerns.*", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "comment_type": null, "controversiality": 0, "created_utc": 1608746951, "distinguished": "moderator", "edited": false, "gilded": 0, "gildings": {}, "id": "ggtgat2", "is_submitter": false, "link_id": "t3_kiy17x", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/kiy17x/thoughts_on_the_giantlittle_black_book_of/ggtgat2/", "quarantined": false, "removal_reason": null, "score": 1, "send_replies": false, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1619646555, "updated_utc": 1668698241, "body_sha1": "240ff2447bb15e3553a1a89555ccd732d7f241bc", "nest_level": 1, "utc_datetime_str": "2020-12-23 18:09:11"}, {"all_awardings": [], "associated_award": null, "author": "backtickbot", "author_created_utc": null, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_8n9fijwc", "author_patreon_flair": false, "author_premium": false, "awarders": [], "body": "[Fixed formatting.](https://np.reddit.com/r/backtickbot/comments/kiw3bw/httpsnpredditcomrmalwarecommentski4m8dtrickbot_a/)\n\nHello, sysopfb: code blocks using triple backticks (\\`\\`\\`) don't work on all versions of Reddit!\n\nSome users see [this](https://stalas.alm.lt/backformat/ggt4czc.png) / [this](https://stalas.alm.lt/backformat/ggt4czc.html) instead.\n\nTo fix this, **indent every line with 4 spaces** instead.\n\n[FAQ](https://www.reddit.com/r/backtickbot/wiki/index)\n\n^(You can opt out by replying with backtickopt6 to this comment.)", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "comment_type": null, "controversiality": 0, "created_utc": 1608740770, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "ggt4eaa", "is_submitter": false, "link_id": "t3_ki4m8d", "locked": false, "no_follow": true, "parent_id": 35844888504, "permalink": "/r/Malware/comments/ki4m8d/trickbot_a_closer_look_malware_analysis/ggt4eaa/", "quarantined": false, "removal_reason": null, "score": 1, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1619640991, "updated_utc": 1668698225, "body_sha1": "ebbbb7efe7c3fe4a900250c54870108790602782", "utc_datetime_str": "2020-12-23 16:26:10"}, {"all_awardings": [], "associated_award": null, "author": "sysopfb", "author_created_utc": 1387246287, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_ee6tl", "author_patreon_flair": false, "author_premium": false, "awarders": [], "body": "Hey nice writeup, a few observations from me.\nThe dynamically generated key and xor decryption you talk about on the first layer of the DLL is a custom RC4 routine that is very common in TrickBots crypter, I've written about previous versions of it before: https://zero2auto.com/2020/06/22/decrypting-trickbot-crypter/. It's basically the RC4 routine with a custom length SBOX.\n\nThe last layer you talk about where the decoded bytecode ends up using heavens gate technique is actually the decoded TrickBot Loader bytecode blob, it's basically a DLL that's been mangled into a bytecode blob. I've also talked about this layer which you can read about here: https://labs.sentinelone.com/revealing-the-trick-a-deep-dive-into-trickloader-obfuscation/ but the important piece here is that in terms of 'TrickBot' this piece at the end is the beginning or 'The Trick' project, from there it will eventually decompress out either a LZO compressed 32 bit DLL or 64 bit DLL which is the actual 'bot' component of 'The Trick' project. This then has the encoded initial configuration inside of it, for your sample it is GTAG rob2, the IP addresses are a little obfuscated and need deobfuscating.\n\n```\n'MD5': 'de36a3732f03369d5d7cfd0b568c128f', 'IMPHASH': '', 'SHA256': '22840ca738d43e9f57e2006e04d8a3cfe637b2ef92db391168a18a6c47802521', 'CONFIG': '&lt;mcconf&gt;&lt;ver&gt;100001&lt;/ver&gt;&lt;gtag&gt;rob2&lt;/gtag&gt;&lt;servs&gt;&lt;srva&gt;165.226.231.80:1273&lt;/srva&gt;&lt;srva&gt;168.140.17.62:39938&lt;/srva&gt;&lt;srva&gt;194.255.156.239:25317&lt;/srva&gt;&lt;srva&gt;96.139.163.83:10616&lt;/srva&gt;&lt;srva&gt;171.138.104.153:58232&lt;/srva&gt;&lt;/servs&gt;&lt;autorun&gt;&lt;module name=\"pwgrab\"/&gt;&lt;/autorun&gt;&lt;/mcconf&gt;', 'CONF_MD5': 'aadc570f15f320e622b59a5710bfb424'\n```\n\nSo to get the real C2s you would need to demangle them\n```\n&gt;&gt;&gt; a = '171.138.104.153:58232'\n&gt;&gt;&gt; (ip,port) = a.split(':')\n&gt;&gt;&gt; ip\n'171.138.104.153'\n&gt;&gt;&gt; port\n'58232'\n&gt;&gt;&gt; ip = ip.split('.')\n&gt;&gt;&gt; ip\n['171', '138', '104', '153']\n&gt;&gt;&gt; int(ip[0])\n171\n&gt;&gt;&gt; map(int, ip)\n[171, 138, 104, 153]\n&gt;&gt;&gt; ip = map(int, ip)\n&gt;&gt;&gt; port\n'58232'\n&gt;&gt;&gt; port = int(port)\n&gt;&gt;&gt; ip[0] ^= ip[2]\n&gt;&gt;&gt; ip[2] ^= ip[3]\n&gt;&gt;&gt; ip[1] ^= ip[2]\n&gt;&gt;&gt; ip[3] ^= ip[1]\n&gt;&gt;&gt; port ^= ip[0] | (ip[3] &lt;&lt; 8)\n&gt;&gt;&gt; port\n443\n&gt;&gt;&gt; ip\n[195, 123, 241, 226]\n&gt;&gt;&gt; '.'.join(map(str, ip))\n'195.123.241.226'\n&gt;&gt;&gt; '.'.join(map(str, ip))+':'+str(port)\n'195.123.241.226:443'\n```", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "comment_type": null, "controversiality": 0, "created_utc": 1608740751, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "ggt4czc", "is_submitter": false, "link_id": "t3_ki4m8d", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/ki4m8d/trickbot_a_closer_look_malware_analysis/ggt4czc/", "quarantined": false, "removal_reason": null, "score": 2, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1619640974, "updated_utc": 1668698225, "body_sha1": "db557c2d47f806c766fd87da15cf182b2d8d931e", "nest_level": 1, "utc_datetime_str": "2020-12-23 16:25:51"}, {"all_awardings": [], "associated_award": null, "author": "[deleted]", "author_created_utc": null, "author_flair_background_color": "", "author_flair_css_class": null, "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": "dark", "author_fullname": null, "awarders": [], "body": "[removed]", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "comment_type": null, "controversiality": 0, "created_utc": 1608739813, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "ggt2m9z", "is_submitter": false, "link_id": "t3_kiohgu", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/kiohgu/what_language_is_malware_usually_coded_in/ggt2m9z/", "quarantined": false, "removal_reason": null, "score": 1, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1619640174, "updated_utc": 1668698222, "body_sha1": "fe993932d6dced4c0a879e9aa5d7a6e0fbb467f5", "nest_level": 1, "utc_datetime_str": "2020-12-23 16:10:13"}, {"all_awardings": [], "associated_award": null, "author": "[deleted]", "author_created_utc": null, "author_flair_background_color": "", "author_flair_css_class": null, "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": "dark", "author_fullname": null, "awarders": [], "body": "[removed]", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "comment_type": null, "controversiality": 0, "created_utc": 1608739568, "distinguished": null, "edited": true, "gilded": 0, "gildings": {}, "id": "ggt25wg", "is_submitter": false, "link_id": "t3_kim2u3", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/kim2u3/virustotal/ggt25wg/", "quarantined": false, "removal_reason": null, "score": 1, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1619639949, "updated_utc": 1668698221, "body_sha1": "fe993932d6dced4c0a879e9aa5d7a6e0fbb467f5", "edited_on": 1608742517, "nest_level": 1, "utc_datetime_str": "2020-12-23 16:06:08"}, {"all_awardings": [], "associated_award": null, "author": "Sam-Gunn", "author_created_utc": 1467030853, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_z227b", "author_patreon_flair": false, "author_premium": false, "awarders": [], "body": "As the others mentioned, Malware encompasses a lot. It's \"malicious software\", by definition. Any coding language you can write a program in, you can create malware in. It depends on what sort of malware you're writing, what you're targeting, and what you want to do with it.\n\nDon't think of malware as completely separate from \"normal\" programs. Likewise, don't think of coding malware as different from normal coding. Both ways, you're building a program. In many ways, the same functions that many programs we use in our day to day lives have, are also used by malware.\n\nYour targets (which better be PROOF OF CONCEPT targets), and the behavior of the malware should be your guidance to find the required languages necessary. As well as your own skill level. As your skills in programming grow, so will your understanding for finding which languages to learn and use, and when.\n\nPick a language and learn it. Be it writing useful little programs, or only aiming to write malware, you will learn what you need to know. I would suggest one of the C languages as those seem very popular, both with programmers in general, and malware authors.\n\nDon't forget to also learn Assembly. It's important for exploit code, and of course when you decompile malware to analyze it.\n\nFor more examples of malware coded in two or more languages, read up on Stuxnet. It was coded in multiple languages including C, C++ and several other object oriented languages. That was kind of unusual, as per my understanding, but there must've been some good reasons.\n\n**DISCLAIMER:** Finally, don't be a tool. Write malware an an exercise. As a POC. To show yourself and your security buddies you can write it just for fun. Don't try to use it to attack someone. To abuse anybody. To steal anything. The information given here in this sub is to teach you how malware works so you can learn about it, and use that knowledge to defend people. If you find the right job, you may be able to get paid to write malware legally and use it for good! Legal penetration testing is a huge field, and many companies that offer penetration testing as a service hire people to build and maintain their toolsets, as well as modify others. Otherwise, keep it in the test lab.", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "comment_type": null, "controversiality": 0, "created_utc": 1608735662, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "ggsv7en", "is_submitter": false, "link_id": "t3_kiohgu", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/kiohgu/what_language_is_malware_usually_coded_in/ggsv7en/", "quarantined": false, "removal_reason": null, "score": 2, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1619636683, "updated_utc": 1668698211, "body_sha1": "478dae268c2d126e995a11e4adabb8bd984bc65d", "nest_level": 1, "utc_datetime_str": "2020-12-23 15:01:02"}], "error": null, "metadata": {"es": {"took": 66, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 17, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1608710460000}}}, {"range": {"created_utc": {"lt": 1608796860000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1608710460000}}},{\"range\":{\"created_utc\":{\"lt\":1608796860000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1673017478.2578893, "api_request_start": 1674110609.23231, "api_request_end": 1674110609.3411407, "api_total_time": 0.10883069038391113}}