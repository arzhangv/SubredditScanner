{"data": [{"all_awardings": [], "associated_award": null, "author": "AutoModerator", "author_created_utc": 1325741068, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_6l4z3", "author_patreon_flair": false, "author_premium": true, "awarders": [], "body": "It looks like you are posting a question, possibly looking for technical support. \n\nThis subreddit\u2019s purpose is to discuss malware internals and technical details. *This is NOT a place for help with malware removal or various other end-user questions. Please redirect questions related to malware removal to /r/Antivirus or /r/techsupport. Ransomware related questions can be directed to /r/ransomware*\n\nIf this was removed in error, please message the moderators - we love reading quality content just as much as you do!\n\n\n*I am a bot, and this action was performed automatically. Please [contact the moderators of this subreddit](/message/compose/?to=/r/Malware) if you have any questions or concerns.*", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "controversiality": 0, "created_utc": 1590034137, "distinguished": "moderator", "edited": false, "gilded": 0, "gildings": {}, "id": "frb6pfj", "is_submitter": false, "link_id": "t3_gnpxt4", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/gnpxt4/is_this_cracked_premier_pro_app_safe/frb6pfj/", "quarantined": false, "removal_reason": null, "score": 1, "send_replies": false, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1596144536, "updated_utc": 1668719839, "body_sha1": "240ff2447bb15e3553a1a89555ccd732d7f241bc", "nest_level": 1, "utc_datetime_str": "2020-05-21 04:08:57"}, {"all_awardings": [], "associated_award": null, "author": "mmd0xFF", "author_created_utc": 1401729884, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_gtgda", "author_patreon_flair": false, "author_premium": false, "awarders": [], "body": "Check this ELF unpacking [presentation and video](https://old.reddit.com/r/LinuxMalware/comments/9eqn6m/about_my_presentation_of_unpacking_the/) in 2018.\n\nIt covered all of information you need deal w/unpacking ELF. Check out also /r/LinuxMalware for more info on samples related to those. The link is in the right menu of this subreddit.\n\nHope it helps.", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "controversiality": 0, "created_utc": 1590032488, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "frb4ctv", "is_submitter": false, "link_id": "t3_gnfr1s", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/gnfr1s/how_to_unpack_modified_upx_elf_binary/frb4ctv/", "quarantined": false, "removal_reason": null, "score": 1, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1596143273, "updated_utc": 1668719831, "body_sha1": "bae44403f3dc14faeb01da8f552c343efe83d3b4", "nest_level": 1, "utc_datetime_str": "2020-05-21 03:41:28"}, {"all_awardings": [], "associated_award": null, "author": "bubundas17", "author_created_utc": 1513009431, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_nwvf0nl", "author_patreon_flair": false, "author_premium": false, "awarders": [], "body": "Check DM", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "controversiality": 0, "created_utc": 1590000815, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "fr9o0xw", "is_submitter": true, "link_id": "t3_gnfr1s", "locked": false, "no_follow": true, "parent_id": 34300523693, "permalink": "/r/Malware/comments/gnfr1s/how_to_unpack_modified_upx_elf_binary/fr9o0xw/", "quarantined": false, "removal_reason": null, "score": 1, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1596112499, "updated_utc": 1668719608, "body_sha1": "3c09659540c0336c21a870796d72a35991e9ec07", "utc_datetime_str": "2020-05-20 18:53:35"}, {"all_awardings": [], "associated_award": null, "author": "0xf005ba11", "author_created_utc": null, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_3ro05z0", "author_patreon_flair": false, "author_premium": true, "awarders": [], "body": "Sure thing, let me know how it goes :-)", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "controversiality": 0, "created_utc": 1590000452, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "fr9n9gt", "is_submitter": false, "link_id": "t3_gnfr1s", "locked": false, "no_follow": true, "parent_id": 34300486423, "permalink": "/r/Malware/comments/gnfr1s/how_to_unpack_modified_upx_elf_binary/fr9n9gt/", "quarantined": false, "removal_reason": null, "score": 1, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1596112131, "updated_utc": 1668719606, "body_sha1": "5e1d78a81788e5ad3d28a3eed04b531b76a3f352", "utc_datetime_str": "2020-05-20 18:47:32"}, {"all_awardings": [], "associated_award": null, "author": "bubundas17", "author_created_utc": 1513009431, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_nwvf0nl", "author_patreon_flair": false, "author_premium": false, "awarders": [], "body": "Thanks for the valuable information. I can't wait to try this. But unfortunately I am outside right now. Will try and let you know how it goes. And can I dm you with the follow-ups if you don't mind?", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "controversiality": 0, "created_utc": 1590000067, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "fr9mgpj", "is_submitter": true, "link_id": "t3_gnfr1s", "locked": false, "no_follow": true, "parent_id": 34300448378, "permalink": "/r/Malware/comments/gnfr1s/how_to_unpack_modified_upx_elf_binary/fr9mgpj/", "quarantined": false, "removal_reason": null, "score": 1, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1596111748, "updated_utc": 1668719602, "body_sha1": "a93f3ff2e61edf992050e39d77a2ed115b1ee803", "utc_datetime_str": "2020-05-20 18:41:07"}, {"all_awardings": [], "associated_award": null, "author": "0xf005ba11", "author_created_utc": null, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_3ro05z0", "author_patreon_flair": false, "author_premium": true, "awarders": [], "body": "You should be able to recover the unpacked ELF binary if some UPX variant has been used. To do so, first run the binary to some point after unpacking has finished, then extract and reconstruct the ELF file structure.\n\nFor the first step, I've found that for UPX-packed ELF binaries you can set a breakpoint at the binary base address + 0xe. This will break just after unpacking, but before executing unpacked code. If that doesn't work, you might consider stracing the binary and trying to figure out the first syscall after unpacking completes and breaking there.\n\nIf that first part works out, then you'll need to pull out the binary from memory. You can use a nice python library called *lief* for this. For example, this is an excerpt of code I had written for this same purpose that uses lief:\n\n        \tdef _dump_elf(self, address: int, out_file: str):\n        \t    \"\"\"\n        \t    Reads the ELF header in-memory and dumps the loadable sections\n        \t    to disk, reconstructing a valid (re-executable) ELF binary.\n        \n        \t    Arguments:\n        \t        address: virtual address of the ELF header.\n        \t        out_file: filename to dump the unpacked binary.\n        \t    \"\"\"\n        \t    self._log.info(f\"Dumping ELF @ 0x{address:x}\")\n        \n        \t    elf = lief.parse(self.z.memory.read(address, 0x1000))\n        \t    with open(out_file, \"wb\") as f:\n        \t        for segment in elf.segments:\n        \t            if segment.type != lief.ELF.SEGMENT_TYPES.LOAD:\n        \t                continue\n        \n        \t            self._log.info(\n        \t                f\"   Writing segment 0x{segment.virtual_address:08x} - \"\n        \t                f\"0x{segment.virtual_address+segment.physical_size:08x}\"\n        \t            )\n        \n        \t            f.seek(segment.file_offset)\n        \t            f.write(\n        \t                self.z.memory.read(\n        \t                    segment.virtual_address, segment.physical_size\n        \t                )\n        \t            )\n        \n        \t        self._log.info(f\"Success! Wrote {f.tell()} bytes to '{out_file}'\")\n\nThat script extracts memory from a binary emulator (zelos) instead of debugger, but the concept would be the same if using a GDB python script, for example. The unpacked binary overwrites the packed binary, so address is just wherever the binary's base address is at.\n\nIf you reconstruct the ELF like this, you should then be able to execute and/or disassemble that unpacked/reconstructed binary.\n\ndisclaimer: I am an author of the *zelos* emulator :-)", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "controversiality": 0, "created_utc": 1589999677, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "fr9lncq", "is_submitter": false, "link_id": "t3_gnfr1s", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/gnfr1s/how_to_unpack_modified_upx_elf_binary/fr9lncq/", "quarantined": false, "removal_reason": null, "score": 4, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1596111354, "updated_utc": 1668719600, "body_sha1": "7d24545e80896d6a3d84ebdbd98359237347d799", "nest_level": 1, "utc_datetime_str": "2020-05-20 18:34:37"}, {"all_awardings": [], "associated_award": null, "author": "bubundas17", "author_created_utc": 1513009431, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_nwvf0nl", "author_patreon_flair": false, "author_premium": false, "awarders": [], "body": "Yap. But I have some doubts, like how to find the memory sector where the unpacked data starts and ends. And after dumping how can I turn it into a working binary?", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "controversiality": 0, "created_utc": 1589998944, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "fr9k43o", "is_submitter": true, "link_id": "t3_gnfr1s", "locked": false, "no_follow": true, "parent_id": 34300358607, "permalink": "/r/Malware/comments/gnfr1s/how_to_unpack_modified_upx_elf_binary/fr9k43o/", "quarantined": false, "removal_reason": null, "score": 1, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1596110618, "updated_utc": 1668719593, "body_sha1": "69d5ad9e09ef440c943ed2d74b82bbfc0ece301d", "utc_datetime_str": "2020-05-20 18:22:24"}, {"all_awardings": [], "associated_award": null, "author": "learnie", "author_created_utc": 1504574099, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_4u0fdd", "author_patreon_flair": false, "author_premium": false, "awarders": [], "body": "What did you find when you googled? Did you googled how to dump data stored in address using gnu?\n\nAlso, when you say modified upx elf, are you talking about a binary packed with modified upx or a upx packed binary which is modified?", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "controversiality": 0, "created_utc": 1589998761, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "fr9jq33", "is_submitter": false, "link_id": "t3_gnfr1s", "locked": false, "no_follow": true, "parent_id": 34300350589, "permalink": "/r/Malware/comments/gnfr1s/how_to_unpack_modified_upx_elf_binary/fr9jq33/", "quarantined": false, "removal_reason": null, "score": 1, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1596110428, "updated_utc": 1668719592, "body_sha1": "1a6d6a8acdf70cb908ae7c5abcaea57e3248f20c", "utc_datetime_str": "2020-05-20 18:19:21"}, {"all_awardings": [], "associated_award": null, "author": "[deleted]", "author_created_utc": null, "author_flair_background_color": "", "author_flair_css_class": null, "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": "dark", "author_fullname": null, "awarders": [], "body": "[removed]", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "controversiality": 0, "created_utc": 1589998690, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "fr9jkng", "is_submitter": false, "link_id": "t3_gnfr1s", "locked": false, "no_follow": true, "parent_id": 34300220525, "permalink": "/r/Malware/comments/gnfr1s/how_to_unpack_modified_upx_elf_binary/fr9jkng/", "quarantined": false, "removal_reason": null, "score": 1, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1596110356, "updated_utc": 1668719592, "body_sha1": "fe993932d6dced4c0a879e9aa5d7a6e0fbb467f5", "utc_datetime_str": "2020-05-20 18:18:10"}, {"all_awardings": [], "associated_award": null, "author": "bubundas17", "author_created_utc": 1513009431, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_nwvf0nl", "author_patreon_flair": false, "author_premium": false, "awarders": [], "body": "Yap. But the problem is, I am pretty new and started receiving stuffs about a few days ago. And I was able to do it in windows but cannot do the same in Linux.", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "controversiality": 0, "created_utc": 1589998680, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "fr9jjwd", "is_submitter": true, "link_id": "t3_gnfr1s", "locked": false, "no_follow": true, "parent_id": 34300324895, "permalink": "/r/Malware/comments/gnfr1s/how_to_unpack_modified_upx_elf_binary/fr9jjwd/", "quarantined": false, "removal_reason": null, "score": 1, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1596110346, "updated_utc": 1668719592, "body_sha1": "633cfdfca3a82e6fa45e134cc73b0cfff19c7a42", "utc_datetime_str": "2020-05-20 18:18:00"}], "error": null, "metadata": {"es": {"took": 75, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 17, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1589958060000}}}, {"range": {"created_utc": {"lt": 1590044460000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1589958060000}}},{\"range\":{\"created_utc\":{\"lt\":1590044460000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1673945683.810305, "api_request_start": 1674110018.838507, "api_request_end": 1674110018.9497428, "api_total_time": 0.1112358570098877}}