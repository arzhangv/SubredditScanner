{"data": [{"archived": false, "author": "bediger4000", "author_flair_css_class": null, "author_flair_template_id": null, "author_flair_text": null, "body": "I don't know for sure, but I think it's to change checksums, like md5, or to mask \"signature\" text that the \"AV engines\" look for. I have no idea why you'd gzip-base64-encode/repeat 20 times. I've wondered if some of the \"PHP decoders\" on the web have a limit of 20 levels of eval-recursion, so they just encode 21 times.\n\nThe masking hypothesis doesn't entirely ring true: a lot of the \"encoded\" WSO instances have \"FilesMAn\" in cleartext, which is an obviouis signature for that entire family of web shells. Also, what about common, all-malware encodings, like FOPO? If anything it encoded by FOPO, it's malware, so just the FOPO presence is an indicator.\n\nAlso, a large percentage of the \"wrapping\" is `eval(base64_decode($c));` or something very close. Any time `eval()` and `base64_decode()` get composed should be an instant flag to an AV.\n\nAs far as AVs decrypting suspicious binaries, you might want to look at Tavis Ormandy's [Sophail](https://lock.cmpxchg8b.com/sophail.pdf) and [Sophail 2](https://lock.cmpxchg8b.com/sophailv2.pdf) documents. I haven't read them in a while, but I think they did do some kind of simulated execution of binaries, and unpacking/decompressing/decrypting pieces of a binary.", "can_gild": true, "can_mod_post": false, "controversiality": 0, "created_utc": 1525670747, "distinguished": null, "edited": true, "gilded": 0, "id": "dykmok2", "is_submitter": true, "link_id": "t3_8hiaz6", "no_follow": true, "parent_id": 30388636592, "permalink": "/r/Malware/comments/8hiaz6/encoded_malware_what_encoding/dykmok2/", "removal_reason": null, "score": 5, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "retrieved_utc": 1527169949, "updated_utc": 1668759645, "body_sha1": "5277cd857a7bd4b1f1b37b6308a8985d1f6a2a3f", "edited_on": 1526576855, "utc_datetime_str": "2018-05-07 05:25:47"}, {"archived": false, "author": "bediger4000", "author_flair_css_class": null, "author_flair_template_id": null, "author_flair_text": null, "body": "If I had the PHP (or any source) of the encoder, I could work from there. I don't have it: I've got a WordPress honeypot that includes a fake WSO web shell. The stuff in my pastes got downloaded. All I've got is in the pastes and what I wrote in my question.\n\nYou can certainly work out an xor-encoding (with enough ciphertext) based on key length and what you think the cleartext is (english, PHP, etc). You can work out a transposition cipher the same sort of way. I appears that you could work out the \"differential xor\" with just 127 tries (no bytes above 127), but differential xor produces Friedman test key lengths unlike those from my samples.", "can_gild": true, "can_mod_post": false, "controversiality": 0, "created_utc": 1525669771, "distinguished": null, "edited": false, "gilded": 0, "id": "dykm2kz", "is_submitter": true, "link_id": "t3_8hiaz6", "no_follow": true, "parent_id": 30388485601, "permalink": "/r/Malware/comments/8hiaz6/encoded_malware_what_encoding/dykm2kz/", "removal_reason": null, "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "retrieved_utc": 1527169594, "updated_utc": 1668759641, "body_sha1": "36268c113ecc7f2aa380461a2c846c135e6ae582", "utc_datetime_str": "2018-05-07 05:09:31"}, {"archived": false, "author": "Manifest122", "author_flair_css_class": null, "author_flair_template_id": null, "author_flair_text": null, "body": "Can someone tell me what the point is in wrapping your stub in layers of encryption? Why not just use something secure like AES, I mean AV\u2019s don\u2019t spend their time trying to decrypt suspicious binary data, do they? They\u2019ll catch you on method calls after usually, invoking the stub or whatever", "can_gild": true, "can_mod_post": false, "controversiality": 0, "created_utc": 1525669574, "distinguished": null, "edited": false, "gilded": 0, "id": "dykly28", "is_submitter": false, "link_id": "t3_8hiaz6", "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/8hiaz6/encoded_malware_what_encoding/dykly28/", "removal_reason": null, "score": 4, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "retrieved_utc": 1527169517, "updated_utc": 1668759641, "body_sha1": "3b509027745a86b15fa479a2fd6db6c2e07cd0c9", "nest_level": 1, "utc_datetime_str": "2018-05-07 05:06:14"}, {"archived": false, "author": "SpaceCockatoo", "author_flair_css_class": null, "author_flair_template_id": null, "author_flair_text": null, "body": "Yes, i still demand that software protect me, because that's it's job; it's *only* job, in fact.", "can_gild": true, "can_mod_post": false, "controversiality": 0, "created_utc": 1525666097, "distinguished": null, "edited": false, "gilded": 0, "id": "dykjm41", "is_submitter": false, "link_id": "t3_8fhscx", "no_follow": true, "parent_id": 30383030105, "permalink": "/r/Malware/comments/8fhscx/why_are_hacking_tools_always_recognized_as/dykjm41/", "removal_reason": null, "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "retrieved_utc": 1527168135, "updated_utc": 1668759639, "body_sha1": "6f3271795eaafb01e7763c22f0674d840a1afb3d", "utc_datetime_str": "2018-05-07 04:08:17"}, {"archived": false, "author": "catcradle5", "author_flair_css_class": null, "author_flair_template_id": null, "author_flair_text": null, "body": "It's refreshing to see a genuinely helpful, good, and accurate post on /r/malware. Good work.", "can_gild": true, "can_mod_post": false, "controversiality": 0, "created_utc": 1525665385, "distinguished": null, "edited": false, "gilded": 0, "id": "dykj40a", "is_submitter": false, "link_id": "t3_8glilj", "no_follow": true, "parent_id": 30377027482, "permalink": "/r/Malware/comments/8glilj/java_based_rat/dykj40a/", "removal_reason": null, "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "retrieved_utc": 1527167847, "updated_utc": 1668759638, "body_sha1": "d0875e96fe24a2fe9f7a4d9c8414dd8d48bb841a", "utc_datetime_str": "2018-05-07 03:56:25"}, {"archived": false, "author": "catcradle5", "author_flair_css_class": null, "author_flair_template_id": null, "author_flair_text": null, "body": "I would separate \"game hacks\" and software cracks/keygens from \"hacking tools\". Hacking tools are flagged for pretty obvious reasons; an attacker on a network may very well use a hacking tool that is typically used for testing or educational purposes. Those are pretty much always deserving of a malware definition.\n\nEverything else is a mix of FUD, legal issues, and a genuinely high incidence of pirated software that contains malware.", "can_gild": true, "can_mod_post": false, "controversiality": 0, "created_utc": 1525665330, "distinguished": null, "edited": false, "gilded": 0, "id": "dykj2ki", "is_submitter": false, "link_id": "t3_8fhscx", "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/8fhscx/why_are_hacking_tools_always_recognized_as/dykj2ki/", "removal_reason": null, "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "retrieved_utc": 1527167825, "updated_utc": 1668759638, "body_sha1": "3d7cd1c9d18c79daa87b2b592d29ccddfed8aa8d", "nest_level": 1, "utc_datetime_str": "2018-05-07 03:55:30"}, {"archived": false, "author": "catcradle5", "author_flair_css_class": null, "author_flair_template_id": null, "author_flair_text": null, "body": "You need to upload the PHP code that's actually doing the decoding. base64 is just a simple way of sending binary data. The actual binary data could be almost anything. No point spending ages trying to work out what encryption algorithm it's using when you can reverse engineer the code in a few minutes. You know it may have a block size of 4/8/16/32, but that still doesn't help you much when you know neither the algorithm nor the key.", "can_gild": true, "can_mod_post": false, "controversiality": 0, "created_utc": 1525664840, "distinguished": null, "edited": false, "gilded": 0, "id": "dykipk1", "is_submitter": false, "link_id": "t3_8hiaz6", "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/8hiaz6/encoded_malware_what_encoding/dykipk1/", "removal_reason": null, "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "retrieved_utc": 1527167615, "updated_utc": 1668759637, "body_sha1": "b758ad7e5507f271423847abbf85eee0a0034679", "nest_level": 1, "utc_datetime_str": "2018-05-07 03:47:20"}, {"archived": false, "author": "heroin_and_stimpy", "author_flair_css_class": null, "author_flair_template_id": null, "author_flair_text": null, "body": "\nGh\n", "can_gild": true, "can_mod_post": false, "controversiality": 0, "created_utc": 1525656349, "distinguished": null, "edited": false, "gilded": 0, "id": "dykbemr", "is_submitter": false, "link_id": "t3_8hiaz6", "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/8hiaz6/encoded_malware_what_encoding/dykbemr/", "removal_reason": null, "score": -1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "retrieved_utc": 1527163633, "updated_utc": 1668759628, "body_sha1": "e17d3559cd7b3c123ec561cd735b9f65144fc759", "nest_level": 1, "utc_datetime_str": "2018-05-07 01:25:49"}, {"archived": false, "author": "r30ng1n3rd", "author_flair_css_class": null, "author_flair_template_id": null, "author_flair_text": null, "body": "OALabs - A bunch of stuff, from IDA pro techniques. Hooking Techniques, Anti-VM &amp; Anti-Debug. \n\nMonnappa K A -( https://www.youtube.com/user/hackycracky22) - Lot of stuff on Malware using Hollow Process injection. \n\nColin Hardy (https://www.youtube.com/channel/UCND1KVdVt8A580SjdaS4cZg/) - Good stuff on Dynamic Malware analysis, Doc based malware etc. \n\nMalwareAnalysisForHedgehogs - A lot of nice explanation of basic to advanced techniques of malware. Recent, videos have been about Theory about PE files which is quiet good. \n\nGiveAcademy - (https://www.youtube.com/user/fjlj) - Dive into Reversing. Most videos are 1+ hour long and they do Live Streaming as well. \n", "can_gild": true, "can_mod_post": false, "controversiality": 0, "created_utc": 1525655994, "distinguished": null, "edited": false, "gilded": 0, "id": "dykb3ch", "is_submitter": false, "link_id": "t3_8hja7p", "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/8hja7p/advanced_malware_analysis_youtube_videos/dykb3ch/", "removal_reason": null, "score": 5, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "retrieved_utc": 1527163468, "updated_utc": 1668759628, "body_sha1": "022b7b979125c80f5de21f9126132a8869943fe3", "nest_level": 1, "utc_datetime_str": "2018-05-07 01:19:54"}, {"archived": false, "author": "Legendofmudkip", "author_flair_css_class": null, "author_flair_template_id": null, "author_flair_text": null, "body": "MalwareAnalysisForHedgehogs has some good stuff. ", "can_gild": true, "can_mod_post": false, "controversiality": 0, "created_utc": 1525652403, "distinguished": null, "edited": false, "gilded": 0, "id": "dyk7xww", "is_submitter": false, "link_id": "t3_8hja7p", "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/8hja7p/advanced_malware_analysis_youtube_videos/dyk7xww/", "removal_reason": null, "score": 6, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "retrieved_utc": 1527161830, "updated_utc": 1668759623, "body_sha1": "a107720db8fc64b487ac73d0b463a149a9b4621e", "nest_level": 1, "utc_datetime_str": "2018-05-07 00:20:03"}], "error": null, "metadata": {"es": {"took": 79, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 32, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1525590060000}}}, {"range": {"created_utc": {"lt": 1525676460000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1525590060000}}},{\"range\":{\"created_utc\":{\"lt\":1525676460000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1674057444.3751245, "api_request_start": 1674107646.4456656, "api_request_end": 1674107646.5698416, "api_total_time": 0.124176025390625}}