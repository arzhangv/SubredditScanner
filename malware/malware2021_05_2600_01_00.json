{"data": [{"all_awardings": [], "archived": false, "associated_award": null, "author": "driverobject", "author_created_utc": 1510084911, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_evyveqa", "author_is_blocked": false, "author_patreon_flair": false, "author_premium": false, "body": "While I do not believe it would by itself be enough, you can have a look at Controlled Folder Access in Windows 10: [https://support.microsoft.com/en-us/topic/ransomware-protection-in-windows-security-445039d6-537a-488a-ad53-48906f346363](https://support.microsoft.com/en-us/topic/ransomware-protection-in-windows-security-445039d6-537a-488a-ad53-48906f346363) \n\nIf you are unable to deploy sysmon, then you will need to depend on Windows auditing events on the file system. For the systems involved, you can create a Group Policy that targets all those systems that are targets for detection. \n\n1. Create a GPO in AD, assign to an OU or similar targeting mechanism to cover all systems involved. \n2. Go to Auditing settings and create a policy that enables Object Access. This is under security settings, computer settings, local policies..\n3. Then you have to navigate to FileSystem and add the folders of interest and probably everyone's write access in the advanced as you add the folders. \n\nThis is going to generate a huge amount of events on the endpoints. You have to also look at Event log management policies at the endpoints. If the logs are too small, during a ransomware event there will be a huge amount of events that'll be overwritten - which may make it difficult to detect anomalies if you are doing a simple compare against past events on that specific system. \n\nYou then need to look at forwarding those events to a collector server using Windows Event Forwarding or if you have a siem in place that gives you agent based collection from those endpoints you can also make use of that. Once the events are at a central location, like a SIEM then you need to create use cases for the events that are coming in, there will be millions :) \n\nI have also created more granular data collection agents before using c# and ETW events on the endpoints. To do that, you can look at creating a service in .net that makes use of the TraceEventLibrary at [https://github.com/microsoft/perfview/blob/main/documentation/TraceEvent/TraceEventLibrary.md](https://github.com/microsoft/perfview/blob/main/documentation/TraceEvent/TraceEventLibrary.md). \n\nThere is probably other methods that are better but the above are some options.", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1622097924, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "gzlyl63", "is_submitter": false, "link_id": "t3_nlzx1y", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/nlzx1y/detect_multiple_files_being_encrypted/gzlyl63/", "retrieved_utc": 1627832461, "score": 7, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "updated_utc": 1668686097, "body_sha1": "217c5035c65181862e61a8755e118f28455d487a", "nest_level": 1, "utc_datetime_str": "2021-05-27 06:45:24"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "bughunter47", "author_created_utc": 1581296714, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_5narcugb", "author_is_blocked": false, "author_patreon_flair": false, "author_premium": false, "body": "File permission control is a key factor when dealing with russian coded ransomware.\n\nIronically enough sometimes if the system they are hacking is clunky enough, they may actually optimize your system before running their encryption tool. This is to shorten the window of time to manually engage counter measures (say cutting the power, yanking the drive...)", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1622094637, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "gzluge5", "is_submitter": false, "link_id": "t3_nlzx1y", "locked": false, "no_follow": false, "parent_id": null, "permalink": "/r/Malware/comments/nlzx1y/detect_multiple_files_being_encrypted/gzluge5/", "retrieved_utc": 1627832642, "score": 6, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "updated_utc": 1668686091, "body_sha1": "ff433416fe88ec40cdf659b8cf6bc0a9a247402c", "nest_level": 1, "utc_datetime_str": "2021-05-27 05:50:37"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "bughunter47", "author_created_utc": 1581296714, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_5narcugb", "author_is_blocked": false, "author_patreon_flair": false, "author_premium": false, "body": "And multiple (normally countless) extra ransom notes (one per folder, sometimes one per file in plain text form)", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1622094250, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "gzlty0h", "is_submitter": false, "link_id": "t3_nlzx1y", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/nlzx1y/detect_multiple_files_being_encrypted/gzlty0h/", "retrieved_utc": 1627832666, "score": -1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "updated_utc": 1668686090, "body_sha1": "94e2f8a0523499e6ead724f962a17be5c3fb9df6", "nest_level": 1, "utc_datetime_str": "2021-05-27 05:44:10"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "bughunter47", "author_created_utc": 1581296714, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_5narcugb", "author_is_blocked": false, "author_patreon_flair": false, "author_premium": false, "body": "mass file change, by registry changes", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1622094129, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "gzlts6m", "is_submitter": false, "link_id": "t3_nlzx1y", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/nlzx1y/detect_multiple_files_being_encrypted/gzlts6m/", "retrieved_utc": 1627832673, "score": -1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "updated_utc": 1668686089, "body_sha1": "ba588cc681af7cab105d3c273737a5bf1aa4cf21", "nest_level": 1, "utc_datetime_str": "2021-05-27 05:42:09"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "[deleted]", "author_created_utc": null, "author_flair_background_color": "", "author_flair_css_class": null, "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": "dark", "author_is_blocked": false, "body": "[deleted]", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1622092424, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "gzlrha2", "is_submitter": false, "link_id": "t3_nlzx1y", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/nlzx1y/detect_multiple_files_being_encrypted/gzlrha2/", "retrieved_utc": 1627832770, "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "updated_utc": 1668686084, "body_sha1": "228f7d207920fb84335fac5b2b06ed7b472ece9e", "nest_level": 1, "utc_datetime_str": "2021-05-27 05:13:44"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "ogtfo", "author_created_utc": 1275056814, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_433n3", "author_is_blocked": false, "author_patreon_flair": false, "author_premium": false, "body": "No matter, defang that shit please, I don't want to be clicking that kind of stuff on my personal machine.", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 1, "created_utc": 1622088975, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "gzlmda7", "is_submitter": false, "link_id": "t3_nljdxv", "locked": false, "no_follow": true, "parent_id": 36976980203, "permalink": "/r/Malware/comments/nljdxv/new_conti_url/gzlmda7/", "retrieved_utc": 1627833037, "score": -3, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "updated_utc": 1668686073, "body_sha1": "c9ba55403e6fea609c04c32175b7cf0c3e1eddc0", "utc_datetime_str": "2021-05-27 04:16:15"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "AGDCservices", "author_created_utc": 1599048527, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_5sen5s62", "author_is_blocked": false, "author_patreon_flair": false, "author_premium": true, "body": "packers usually come in two types, commercial and custom. commercial packers (upx, aspack, etc.) are available publicly and often have signatures and can be identified, but don't seem to be used as much as custom packers now from what i've seen. custom packers are coded by the actor and simply decrypt and then manually parse the PE header to map the file directly into memory. the code for most custom type packers looks similar because they perform the same steps, but there aren't identifiable signatures because they aren't available commercially. custom packers are used in a lot of the current malware files like emotet, qbot, etc. might not matter for your thesis, but it's good to be aware of the differences.", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1622077527, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "gzl2eno", "is_submitter": false, "link_id": "t3_nk469o", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/nk469o/identifying_packers_crypters_or_protectors/gzl2eno/", "retrieved_utc": 1627833936, "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "updated_utc": 1668686041, "body_sha1": "6ce4a1d29c4725dd010bdc0e1d9620e7b6222ac6", "nest_level": 1, "utc_datetime_str": "2021-05-27 01:05:27"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "austinsonger", "author_created_utc": 1510216500, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_kbewroe", "author_is_blocked": false, "author_patreon_flair": false, "author_premium": false, "body": "er444", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1622074417, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "gzkw4yr", "is_submitter": false, "link_id": "t3_ng75i4", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/ng75i4/threat_hunting_cheatsheet/gzkw4yr/", "retrieved_utc": 1627834250, "score": 0, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "updated_utc": 1668686029, "body_sha1": "6c9e5026b172fb9c5dfc7f5bfff773e9e8dad669", "nest_level": 1, "utc_datetime_str": "2021-05-27 00:13:37"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "austinsonger", "author_created_utc": 1510216500, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_kbewroe", "author_is_blocked": false, "author_patreon_flair": false, "author_premium": false, "body": "er444", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1622074417, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "gzkw4yo", "is_submitter": false, "link_id": "t3_ng75i4", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/ng75i4/threat_hunting_cheatsheet/gzkw4yo/", "retrieved_utc": 1627834250, "score": 0, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "updated_utc": 1668686029, "body_sha1": "6c9e5026b172fb9c5dfc7f5bfff773e9e8dad669", "nest_level": 1, "utc_datetime_str": "2021-05-27 00:13:37"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "austinsonger", "author_created_utc": 1510216500, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_kbewroe", "author_is_blocked": false, "author_patreon_flair": false, "author_premium": false, "body": "er444", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1622074417, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "gzkw4yh", "is_submitter": false, "link_id": "t3_ng75i4", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/ng75i4/threat_hunting_cheatsheet/gzkw4yh/", "retrieved_utc": 1627834250, "score": 0, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "updated_utc": 1668686029, "body_sha1": "6c9e5026b172fb9c5dfc7f5bfff773e9e8dad669", "nest_level": 1, "utc_datetime_str": "2021-05-27 00:13:37"}], "error": null, "metadata": {"es": {"took": 329, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 21, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1622012460000}}}, {"range": {"created_utc": {"lt": 1622098860000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1622012460000}}},{\"range\":{\"created_utc\":{\"lt\":1622098860000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1673017478.2578893, "api_request_start": 1673925358.740357, "api_request_end": 1673925359.4063725, "api_total_time": 0.666015625}}