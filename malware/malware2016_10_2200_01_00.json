{"data": [{"author": "qx7xbku", "id": "d93ygpy", "distinguished": null, "edited": false, "gilded": 0, "author_flair_css_class": null, "parent_id": 28848185107, "body": "Graph view like in ida when.", "subreddit_id": "t5_2qrkp", "subreddit": "Malware", "link_id": "t3_58tw9e", "stickied": false, "created_utc": 1477201526, "author_flair_text": null, "controversiality": 0, "score": 1, "retrieved_utc": 1478813408, "updated_utc": 1668777103, "body_sha1": "6f182ccb4264a1ed4718be7e6d7203580f91fb3f", "utc_datetime_str": "2016-10-23 05:45:26"}, {"score": 1, "author_flair_text": null, "controversiality": 0, "link_id": "t3_58tw9e", "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "stickied": false, "created_utc": 1477182968, "parent_id": 28848217190, "body": "Does wine have all the DLLs (or an equivalent) for the malware's import table?  I've never tried to use wine before so I'm not sure exactly how the environment would look to the malware. \n\nI know that some ransomware encrypts only ms office files found in the folders that a user is most likely to use regularly. Did you put any fake ones in the wine environment for locky to try and scoop up? I wonder if it goes for OpenOffice files?", "id": "d93o1fh", "distinguished": null, "edited": false, "author": "Rokhmal112358", "author_flair_css_class": null, "gilded": 0, "retrieved_utc": 1478808369, "updated_utc": 1668777092, "body_sha1": "f146409ba8d29b82c9a38240f5ab3f469d92ec81", "utc_datetime_str": "2016-10-23 00:36:08"}, {"created_utc": 1477172247, "stickied": false, "link_id": "t3_58tw9e", "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "author_flair_text": null, "score": 1, "controversiality": 0, "author_flair_css_class": null, "gilded": 0, "edited": false, "distinguished": null, "id": "d93heue", "author": "cym13", "parent_id": 28847836520, "body": "Thanks for the detailed answer.\n\nSome feedback now that I'm finished experimenting:\n\nI first did as you advised in a windows VM and quickly got the exe (well, there was yet another layer of obfuscation but the principle is here). Locky, yeah. So that works, is quite quick.\n\nI still wanted to try and find some way to perform the same analysis on linux because why not. It was easier because I knew what I\u00a0was looking for, but still undoable in the end.\n\nRoughly modifying the DLL\u00a0into an EXE somehow worked (the code executed well until some point through wine) but some point of the API must be mis-implemented because it somehow didn't manage to produce a memory space in which to load and decrypt locky.\n\nUsing rundll32.exe through wine to load the DLL was also a failure, for some reason it couldn't find the default entry point although it was working well on Win7. Maybe I should have tried copying the Win7 rundll32.exe to my linux to use it with wine instead of using the default one... That'll be for another day.\n\nSo in the end I was unable to perform that  analysis solely  on linux. That may not be a surprise but it's still disappointing in a way. Still had fun trying though.", "retrieved_utc": 1478804886, "updated_utc": 1668777087, "body_sha1": "441a39d37e53728e1d2973f8607e1864a0c23449", "utc_datetime_str": "2016-10-22 21:37:27"}, {"score": 2, "author_flair_text": null, "controversiality": 0, "created_utc": 1477171120, "stickied": false, "link_id": "t3_58tw9e", "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "body": "Adding to this, maybe take a look at x64dbg. I think it just automates the creation of the simple exe file.", "parent_id": 28847941902, "gilded": 0, "author_flair_css_class": null, "distinguished": null, "edited": false, "id": "d93gq37", "author": "akspa420", "retrieved_utc": 1478804555, "updated_utc": 1668777087, "body_sha1": "cc65af66d1cd5b33b7bf0471a8c5fc32c971e87e", "utc_datetime_str": "2016-10-22 21:18:40"}, {"subreddit": "Malware", "link_id": "t3_58v2s0", "subreddit_id": "t5_2qrkp", "stickied": false, "created_utc": 1477168528, "author_flair_text": null, "score": 1, "controversiality": 0, "id": "d93f288", "edited": false, "distinguished": null, "author": "[deleted]", "author_flair_css_class": null, "gilded": 0, "parent_id": null, "body": "[removed]", "retrieved_utc": 1478803755, "updated_utc": 1668777085, "body_sha1": "fe993932d6dced4c0a879e9aa5d7a6e0fbb467f5", "nest_level": 1, "utc_datetime_str": "2016-10-22 20:35:28"}, {"controversiality": 0, "author_flair_text": null, "score": 1, "created_utc": 1477166600, "stickied": false, "subreddit": "Malware", "link_id": "t3_58pw3z", "subreddit_id": "t5_2qrkp", "parent_id": 28848027799, "body": "No problem, looking forward to hearing from him! ", "author_flair_css_class": null, "gilded": 0, "distinguished": null, "edited": false, "id": "d93dttz", "author": "gnzla", "retrieved_utc": 1478803120, "updated_utc": 1668777085, "body_sha1": "8b9e75d7573a2492852728fe7840b3dcdda9a591", "utc_datetime_str": "2016-10-22 20:03:20"}, {"controversiality": 0, "author_flair_text": null, "score": 3, "subreddit_id": "t5_2qrkp", "subreddit": "Malware", "link_id": "t3_58tw9e", "created_utc": 1477165865, "stickied": false, "parent_id": null, "body": "The rundll32 route above is the most direct way. But, if you're just debugging, use the built-in tools in OllyDbg. It has a loaddll.exe just for that purpose. Load the DLL in Olly, run until it initializes, set a BP within the export routine, and then use Olly's \"Call Export\" feature to run it.\n\nhttp://ollydbg.de/Loaddll.htm", "author": "LightningRurik", "distinguished": null, "edited": false, "id": "d93dded", "gilded": 0, "author_flair_css_class": null, "retrieved_utc": 1478802901, "updated_utc": 1668777084, "body_sha1": "5aa99451127dcac0a4a45a8eac54222b5b33a45e", "nest_level": 1, "utc_datetime_str": "2016-10-22 19:51:05"}, {"parent_id": 28847987549, "body": "Wow thank you so much! Its always great to know there are people out there willing to help out! \n\nI showed my brother this post and he's going to PM you back, since he knows more of the people who did this than I do. Thank you so much!!", "gilded": 0, "author_flair_css_class": null, "edited": false, "distinguished": null, "id": "d93dcpj", "author": "annie093", "author_flair_text": null, "score": 1, "controversiality": 0, "created_utc": 1477165836, "stickied": false, "subreddit": "Malware", "link_id": "t3_58pw3z", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1478802892, "updated_utc": 1668777084, "body_sha1": "a981ded11a694dd516bc94b26b27707f0fa63ce1", "utc_datetime_str": "2016-10-22 19:50:36"}, {"created_utc": 1477164460, "stickied": false, "subreddit_id": "t5_2qrkp", "link_id": "t3_58pw3z", "subreddit": "Malware", "score": 1, "author_flair_text": null, "controversiality": 0, "gilded": 0, "author_flair_css_class": null, "author": "gnzla", "distinguished": null, "edited": false, "id": "d93chnh", "body": "Well, you just made things a lot more interesting! Forensics and incident response are my current specialization. I find the work fascinating, and I take extreme satisfaction in picking apart a criminal's well-laid plans, so I'm effectively hooked at this point. I'm sorry to hear about your family member's depression. Hopefully uncovering evidence of the attack will help pull him out of it! \n\nIf you don't mind sharing what you have, it would help to have more information on the attack. In particular:\n\n1.) The scope of the attack. What was compromised, and how did the attacker use that information? \n\n2.) How were you first made aware of the attack? \n\n3.) Information on the attacker. Background, skill level, and relationship to the victim. \n\n4.) Motivation. What would have made the attacker target your family member? \n\nI understand that some of this information may touch on a sensitive subject, so feel free to skip any information that you don't want to share at this point in time. It helps to be able to see things through the eyes of the attacker when attempting to retrace his steps. ", "parent_id": 28847887876, "retrieved_utc": 1478802479, "updated_utc": 1668777084, "body_sha1": "19570003706f25a698db6816e10f1ebc11fb269d", "utc_datetime_str": "2016-10-22 19:27:40"}, {"distinguished": null, "edited": false, "id": "d93brre", "author": "gnzla", "author_flair_css_class": null, "gilded": 0, "body": "Here, [I made this for you] (https://gist.github.com/anonymous/eb079ee841cf0ca6f08ab261fc4c70b1). \n\nIt's just a little utility to generate SHA-1 hashes recursively for a given file or folder. \n\nI'm not sure what your skill level or background is, so I also went ahead and found you [a beginner-friendly primer on cryptographic hash functions](http://www.metamorphosite.com/one-way-hash-encryption-sha1-data-software). \n\nThat primer should help you wrap you understand what a hash is, why we use it for this particular application, and other applications for cryptographic hash functions. \n\nAnd, as always, let me know if you'd like any more information. \n\n**Ninja edit:** I tried to write this in a way that will work on Windows XP, but I don't have access to an XP machine to test it. If you get any errors, PM me the error message and I'll patch the script for you! ", "parent_id": 28847041303, "subreddit": "Malware", "link_id": "t3_58pw3z", "subreddit_id": "t5_2qrkp", "created_utc": 1477163296, "stickied": false, "score": 1, "author_flair_text": null, "controversiality": 0, "retrieved_utc": 1478802133, "updated_utc": 1668777083, "body_sha1": "b1a0f9a42023fdae2878b479fe779cc0990d1286", "utc_datetime_str": "2016-10-22 19:08:16"}], "error": null, "metadata": {"es": {"took": 129, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 18, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1477119660000}}}, {"range": {"created_utc": {"lt": 1477206060000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1477119660000}}},{\"range\":{\"created_utc\":{\"lt\":1477206060000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1673017478.2578893, "api_request_start": 1674105070.0482554, "api_request_end": 1674105070.220373, "api_total_time": 0.1721174716949463}}