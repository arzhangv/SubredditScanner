{"data": [{"author_flair_css_class": null, "gilded": 0, "id": "daz3p1k", "controversiality": 0, "author": "BrueEyes", "score": 1, "author_flair_text": null, "distinguished": null, "subreddit_id": "t5_2qrkp", "parent_id": 28961052080, "stickied": false, "body": "Thanks", "subreddit": "Malware", "created_utc": 1481264546, "edited": false, "link_id": "t3_5h7i44", "retrieved_utc": 1483592877, "updated_utc": 1668779243, "body_sha1": "97cba4858411c435e526dd651157aac20178222c", "utc_datetime_str": "2016-12-09 06:22:26"}, {"body": "You are right about CS being \"way more obfuscated\" as this piece provided by the op is only a small portion of the overall exploit, and requires a few levels of base64 decoding to get to it. But I guarantee this is CS Beacon as I just examined a Beacon payload at my $dayjob when our red team used it. CS is based on metasploit so I understand why you feel this way. This pastebin post I found is exactly the same as the final stage beacon payload I examined (see line 24 to understand what op is referencing): http://pastebin.com/01Zu5Fu2", "stickied": false, "created_utc": 1481260569, "subreddit": "Malware", "edited": false, "link_id": "t3_5hasss", "gilded": 0, "author_flair_css_class": null, "score": 2, "controversiality": 0, "author": "haxyman", "id": "daz1mde", "subreddit_id": "t5_2qrkp", "parent_id": 28961674146, "distinguished": null, "author_flair_text": null, "retrieved_utc": 1483591885, "updated_utc": 1668779240, "body_sha1": "114a082c9bb0cfa9f0cde48ad9d1936fb95eb778", "utc_datetime_str": "2016-12-09 05:16:09"}, {"link_id": "t3_5hasss", "edited": false, "created_utc": 1481259849, "subreddit": "Malware", "stickied": false, "body": "cobalt strike way more obfuscated and high end. this is metasploit or sometrhing based on it, i've reversed the kernel32 resolver more than once and wrote it up. ror edi, 0d is a dead give away in that chain.. plus cld call sub 8f at the start", "distinguished": null, "author_flair_text": null, "parent_id": 28961666959, "subreddit_id": "t5_2qrkp", "author": "boredatwork_amirite", "controversiality": 0, "id": "daz16si", "score": 4, "author_flair_css_class": null, "gilded": 0, "retrieved_utc": 1483591678, "updated_utc": 1668779240, "body_sha1": "a612143c780a64187ce961ea326298820004579e", "utc_datetime_str": "2016-12-09 05:04:09"}, {"author_flair_css_class": null, "gilded": 0, "distinguished": null, "author_flair_text": null, "parent_id": 28961515774, "subreddit_id": "t5_2qrkp", "controversiality": 0, "author": "boredatwork_amirite", "id": "daz11nt", "score": 3, "created_utc": 1481259619, "subreddit": "Malware", "stickied": false, "body": "it could touch disk, but it's encoded such that your endpoint agent didn't detect it.  the payload downloaded by the loader would be executed in memory and never touch disk. it's also probably encrypted, so av won't pick up on it. ", "link_id": "t3_5hasss", "edited": false, "retrieved_utc": 1483591609, "updated_utc": 1668779240, "body_sha1": "2af5bf31374335b940b1b5d6b41e82db1b3398e6", "utc_datetime_str": "2016-12-09 05:00:19"}, {"link_id": "t3_5hasss", "edited": false, "created_utc": 1481259600, "subreddit": "Malware", "stickied": false, "body": "This looks like Cobalt Strike Beacon, and it usually just injects right into the running powershell.exe process. Most A/V software just shrugs at process injection. As the previous poster said, if this isn't a pen test it's time to sound the alarms. https://www.cobaltstrike.com/help-smb-beacon", "author_flair_text": null, "distinguished": null, "subreddit_id": "t5_2qrkp", "parent_id": 28961515774, "id": "daz118v", "controversiality": 0, "author": "haxyman", "score": 6, "author_flair_css_class": null, "gilded": 0, "retrieved_utc": 1483591604, "updated_utc": 1668779240, "body_sha1": "97c577f11c99d124b936e130ace2c53244a6bcee", "utc_datetime_str": "2016-12-09 05:00:00"}, {"parent_id": 28961490497, "subreddit_id": "t5_2qrkp", "distinguished": null, "author_flair_text": null, "score": 1, "controversiality": 0, "author": "boredatwork_amirite", "id": "daz107q", "gilded": 0, "author_flair_css_class": null, "link_id": "t3_5hasss", "edited": false, "subreddit": "Malware", "created_utc": 1481259553, "body": "cobaltstrike is way more obfuscated. ", "stickied": false, "retrieved_utc": 1483591589, "updated_utc": 1668779240, "body_sha1": "54e0928a87524d295ff1ee69bfc86f965f263abf", "utc_datetime_str": "2016-12-09 04:59:13"}, {"edited": false, "link_id": "t3_5hasss", "body": "Yep, here is an analysis of it: http://forensicscontest.com/contest06/Finalists/Iulian_Anton/narrative.txt", "stickied": false, "created_utc": 1481259399, "subreddit": "Malware", "score": 0, "controversiality": 0, "author": "xenoperspicacian", "id": "daz0wnk", "subreddit_id": "t5_2qrkp", "parent_id": 28961235102, "distinguished": null, "author_flair_text": null, "gilded": 0, "author_flair_css_class": null, "retrieved_utc": 1483591542, "updated_utc": 1668779240, "body_sha1": "5683d0c95fb226fb07e69ffe02f6def0779cdad3", "utc_datetime_str": "2016-12-09 04:56:39"}, {"stickied": false, "body": "Thank you so much for the explanation, does this kind of shellcode. touch partly on the disk. or is  this loaded directly on memory? Confused also why the endpoint protection didn't detect on this context.", "created_utc": 1481254741, "subreddit": "Malware", "edited": false, "link_id": "t3_5hasss", "author_flair_css_class": null, "gilded": 0, "id": "dayxsla", "author": "kirloxchamploo", "controversiality": 0, "score": 3, "author_flair_text": null, "distinguished": null, "subreddit_id": "t5_2qrkp", "parent_id": 28961257912, "retrieved_utc": 1483590051, "updated_utc": 1668779238, "body_sha1": "d506f0c8b0310f0669087951569a63f15a131764", "utc_datetime_str": "2016-12-09 03:39:01"}, {"score": 1, "author": "bryan_n", "controversiality": 0, "id": "dayx935", "subreddit_id": "t5_2qrkp", "parent_id": null, "distinguished": null, "author_flair_text": null, "gilded": 0, "author_flair_css_class": null, "edited": false, "link_id": "t3_5hasss", "body": "most likely - CobaltStrike Named Pipe stager.\nhttp://blog.cobaltstrike.com/2013/06/28/staged-payloads-what-pen-testers-should-know/", "stickied": false, "created_utc": 1481253993, "subreddit": "Malware", "retrieved_utc": 1483589787, "updated_utc": 1668779237, "body_sha1": "7ba2fc83219db2e2c0b00cce7c9fed451d83a5ff", "nest_level": 1, "utc_datetime_str": "2016-12-09 03:26:33"}, {"link_id": "t3_5h7i44", "edited": false, "created_utc": 1481253075, "subreddit": "Malware", "stickied": false, "body": "I should not have jumped from my own programs written for linux straight into professional grade ransomware PEs. I don't understand anything right now. I'm just reading a blog post and a bit about the windows API functions I see.\n\nFrom what I'm reading it uses EBC. That should make it possible to retrieve some images. Also, if there are files that are both encrypted with that key and we know the value to, we can get those blocks (I.E. foo is encrypted into bar, so whenever we see bar in an encrypted file we know that foo was there, where foo and bar are 128 bit blocks). If we can get enough such blocks, we could have a partial data recovery.\n\nSauce: read a book about cryptography a week ago, so take what I say here with a grain of salt. Also if I'm wrong on anything, please correct me.", "author_flair_text": null, "distinguished": null, "subreddit_id": "t5_2qrkp", "parent_id": 28961143496, "id": "daywlhx", "author": "Yapoz", "controversiality": 0, "score": 1, "author_flair_css_class": null, "gilded": 0, "retrieved_utc": 1483589472, "updated_utc": 1668779237, "body_sha1": "9ab2efafe01d0df8b4eb9aca9d452d3718bed4fa", "utc_datetime_str": "2016-12-09 03:11:15"}], "error": null, "metadata": {"es": {"took": 84, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 38, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1481184060000}}}, {"range": {"created_utc": {"lt": 1481270460000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1481184060000}}},{\"range\":{\"created_utc\":{\"lt\":1481270460000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1674057444.3751245, "api_request_start": 1674105193.5696175, "api_request_end": 1674105193.693561, "api_total_time": 0.12394356727600098}}