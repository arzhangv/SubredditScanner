{"data": [{"ups": 3, "author": "GuidoZ", "created_utc": 1457769179, "id": "d0wzf01", "author_flair_text": null, "gilded": 0, "link_id": "t3_4a00m1", "distinguished": null, "parent_id": 28352797550, "score": 3, "controversiality": 0, "edited": false, "stickied": false, "subreddit": "Malware", "body": "[TeslaDecoder](https://www.google.com/search?q=TeslaDecoder) works for some variants (but not the .MP3 one.)", "subreddit_id": "t5_2qrkp", "author_flair_css_class": null, "retrieved_utc": 1460595629, "updated_utc": 1668781115, "body_sha1": "b473f234913fb5045396910527816192a0ae7bd3", "utc_datetime_str": "2016-03-12 07:52:59"}, {"author_flair_css_class": null, "subreddit_id": "t5_2qrkp", "body": "If you do pay, do not use the \"decrypt.exe\" provided by the criminals. What you have is an infection of TeslaCrypt 3. Use [TeslaDecoder](https://www.google.com/search?q=TeslaDecoder) instead. The criminals will also provide you with teh private encryption key you need to decrypt the files. Follow the instructions from BleepingComputer and all will be well.", "subreddit": "Malware", "edited": false, "stickied": false, "controversiality": 0, "score": 2, "parent_id": 28352446580, "distinguished": null, "link_id": "t3_4a00m1", "gilded": 0, "author_flair_text": null, "id": "d0wzej1", "author": "GuidoZ", "created_utc": 1457769136, "ups": 2, "retrieved_utc": 1460595623, "updated_utc": 1668781115, "body_sha1": "9c42fcb888954c969d5a038f5bf21938d59e2d7e", "utc_datetime_str": "2016-03-12 07:52:16"}, {"link_id": "t3_49yfrj", "distinguished": null, "parent_id": 28352554972, "score": 3, "stickied": false, "controversiality": 0, "edited": true, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "body": "I mis-copy-pasted a line in the first phase of the code,  it should be\n\n&gt;     wmhswzv($ogzoesec,$gavwyw,$aotfjhkql);\nshould be\n\n&gt;     $jzutykh = $gzerdzjsyl(\"\", wmhswzv($ogzoesec, $gavwyw, $aotfjhkql));\n\nThen it's pretty easy. After you substitute the values of variables you get:\n\n&gt;     $jzutykh = create_function(\"\", wmhswzv($ogzoesec, $gavwyw, str_replace))\n\n(in PHP, calling a string variable will automatically call the function with the name that is contained in that string. it really helps with obfuscating code). \nwmhswzv is just a decoding function, it decrypts the code for the next stage of  execution and returns it in a string. When you pass that string as a parameter to create\\_function, it will, well, create a function that runs the code in the string. Then the function gets called and the code is executed.\n\nAs other commenters suggested, you can put an echo there and find out what code is about to be run. Rinse and repeat. \n\nThere are not too many other tricks in this particular sample. They use eval instead of create\\_function in  a couple of places, and they use a trick where you pass a string to create}_function that looks like this: \n      \n _\"}; some_code//\"_\n\nfor somewhat obscure reasons\\* , it executes the code immediately.\n\n\\* create\\_function($args, $code) is effectively a macro which expands to \n\n     eval(\"function (\".$args.\") {\".$code.\"}\");\n\nThis of can be manipulated into executing code very similarly to an SQL injection. PHP is amazing like that.\n", "author_flair_css_class": null, "ups": 3, "created_utc": 1457767693, "author": "choleropteryx", "id": "d0wyyrj", "author_flair_text": null, "gilded": 0, "retrieved_utc": 1460595417, "updated_utc": 1668781114, "body_sha1": "0b599a8499c2ff70b14e128f963b1d348e52e3fc", "edited_on": 1457768049, "utc_datetime_str": "2016-03-12 07:28:13"}, {"link_id": "t3_49zllw", "parent_id": 28352732870, "distinguished": null, "score": 1, "edited": false, "controversiality": 0, "stickied": false, "subreddit": "Malware", "body": "Those with non updated software and potentially any running ads", "subreddit_id": "t5_2qrkp", "author_flair_css_class": null, "ups": 1, "id": "d0wv0bn", "author": "sysopfb", "created_utc": 1457757706, "gilded": 0, "author_flair_text": null, "retrieved_utc": 1460593482, "updated_utc": 1668781111, "body_sha1": "9d54f6ca05547aba850e2d18d4352b47c26acf7b", "utc_datetime_str": "2016-03-12 04:41:46"}, {"ups": 2, "id": "d0wsfzl", "author": "RK65535", "created_utc": 1457752741, "gilded": 0, "author_flair_text": null, "parent_id": null, "distinguished": null, "score": 2, "link_id": "t3_4a00m1", "subreddit_id": "t5_2qrkp", "body": "You have a great opportunity to educate someone who doesn't know better. NUKE THE DRIVE!", "author_flair_css_class": null, "stickied": false, "controversiality": 0, "edited": false, "subreddit": "Malware", "retrieved_utc": 1460592273, "updated_utc": 1668781109, "body_sha1": "dcc1a64d3728f373d5808470dbf7c778ae15bdd8", "nest_level": 1, "utc_datetime_str": "2016-03-12 03:19:01"}, {"id": "d0wqze2", "created_utc": 1457750098, "author": "Ragingsysadmin", "gilded": 0, "author_flair_text": null, "ups": 1, "subreddit_id": "t5_2qrkp", "body": "Uh, domains do get this update?", "author_flair_css_class": null, "stickied": false, "edited": false, "controversiality": 0, "subreddit": "Malware", "parent_id": null, "distinguished": null, "score": 1, "link_id": "t3_49x4r4", "retrieved_utc": 1460591585, "updated_utc": 1668781108, "body_sha1": "6f9a5deb179058ac9eaada4e921b6119c6f82019", "nest_level": 1, "utc_datetime_str": "2016-03-12 02:34:58"}, {"id": "d0wiulq", "created_utc": 1457735699, "author": "kados14", "gilded": 0, "author_flair_text": null, "ups": 3, "body": "I deal with this almost weekly (small town, mom-n-pop repair shop).  By paying these criminals all you are doing is keeping them in business.  \n  \nWipe ... Reload ... only cure.  period.  There is no way to recover the files since this is TeslaCrypt3, it also deletes the shadow copies. They will have to just take it as a loss.\n  \nIt's a lesson many people have had to learn in the last few months....BACKUP YOUR STUFF", "subreddit_id": "t5_2qrkp", "author_flair_css_class": null, "stickied": false, "controversiality": 0, "edited": false, "subreddit": "Malware", "parent_id": null, "distinguished": null, "score": 3, "link_id": "t3_4a00m1", "retrieved_utc": 1460587682, "updated_utc": 1668781102, "body_sha1": "253bf4de15373a7564e9b2cf9e1df4db1f642b28", "nest_level": 1, "utc_datetime_str": "2016-03-11 22:34:59"}, {"author_flair_text": null, "gilded": 0, "created_utc": 1457735410, "author": "Rakanisheu", "id": "d0wioat", "ups": 1, "author_flair_css_class": null, "subreddit_id": "t5_2qrkp", "body": "I have seen plenty of cases where people paid the fee and didn't get there files unlocked. And by paying it you prove to them it was a good idea in the first place. If nobody paid them this stuff would vanish overnight. I am ex-AV threat researcher so I saw so much of this stuff. ", "subreddit": "Malware", "edited": false, "stickied": false, "controversiality": 0, "score": 1, "distinguished": null, "parent_id": 28352446580, "link_id": "t3_4a00m1", "retrieved_utc": 1460587599, "updated_utc": 1668781102, "body_sha1": "e23e6c5f62764ddcb885989e1ad233ff7b84e86b", "utc_datetime_str": "2016-03-11 22:30:10"}, {"ups": 2, "id": "d0whs09", "created_utc": 1457734014, "author": "landfallco", "gilded": 0, "author_flair_text": null, "parent_id": 28352602887, "distinguished": null, "score": 2, "link_id": "t3_49v2gl", "subreddit_id": "t5_2qrkp", "body": "I think I'll dig out my Atari 800 and floppy drives.  I had just as much fun and didn't fight all of this malware.\n\nSeveral years ago I saw this device for $25 that you plug your ethernet cable into (then on to your router).  The ad said that it protects your computer from internet attacks when you're away from your computer.  I thought it was a mini packet scanner which seemed like a bargain.  Although I didn't buy one, I found out that it was a simple disconnect switch.  You flip the switch to \"off\" and it disconnected your ethernet line.  Of course no more attacks while you're away from your computer.  No data flow either.  For $25, I think it was an \"intellect-ware\" attack.", "author_flair_css_class": null, "edited": false, "stickied": false, "controversiality": 0, "subreddit": "Malware", "retrieved_utc": 1460587177, "updated_utc": 1668781101, "body_sha1": "28d47a56879b4ef6824c14c14e2098495cff1943", "utc_datetime_str": "2016-03-11 22:06:54"}, {"subreddit": "Malware", "controversiality": 0, "edited": false, "stickied": false, "author_flair_css_class": null, "body": "Makes sense.  Thanks for the clarity.", "subreddit_id": "t5_2qrkp", "link_id": "t3_49v2gl", "score": 1, "distinguished": null, "parent_id": 28352428257, "author_flair_text": null, "gilded": 0, "created_utc": 1457733555, "author": "landfallco", "id": "d0whhbf", "ups": 1, "retrieved_utc": 1460587037, "updated_utc": 1668781101, "body_sha1": "0f78c2f587a64e11fb844ebb53e0d5796d6ef8f6", "utc_datetime_str": "2016-03-11 21:59:15"}], "error": null, "metadata": {"es": {"took": 205, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 71, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1457683260000}}}, {"range": {"created_utc": {"lt": 1457769660000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1457683260000}}},{\"range\":{\"created_utc\":{\"lt\":1457769660000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1674057444.3751245, "api_request_start": 1674104476.269366, "api_request_end": 1674104476.516205, "api_total_time": 0.24683904647827148}}