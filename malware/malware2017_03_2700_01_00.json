{"data": [{"author_flair_text": null, "score": 1, "parent_id": 29233422402, "gilded": 0, "author": "thingsget", "created_utc": 1490632431, "edited": false, "subreddit": "Malware", "controversiality": 0, "distinguished": null, "stickied": false, "body": "  Well, it doesn't look like its the botnet I thought it was but it sure looks like an extension malware. Not loading assets is perfectly normal, stuff rarely pre loads without having it rendered on the victim's browser. (I.e your site's HTML isn't part of the victim's DOM)\n\nThink of it as a simple $.ajax({URL: yoursite.com}) ( but with cross request enabled. ) on the victim's browser.\n\nOn the Referer header you should be getting stuff from all over, perhaps your logs don't show the header by default?\n\nIf no Referer is present that's an easy way to block off attacks. Nginx can pull that off right from the server config block.", "subreddit_id": "t5_2qrkp", "link_id": "t3_61ornd", "author_flair_css_class": null, "id": "dfh1u2o", "retrieved_utc": 1491827006, "updated_utc": 1668777382, "body_sha1": "7d5e64c7cf3aa7607274d18c18c080dc9f2077a3", "utc_datetime_str": "2017-03-27 16:33:51"}, {"link_id": "t3_61ornd", "author_flair_css_class": null, "id": "dfguqn7", "distinguished": null, "stickied": false, "body": "The only ever hit the main page (GET /) and don't load anything else (assets or anything) nor do they send a referrer. I doubt that our site is compromised and they would need to alter the application in order to server something on / which in turn would be noticed at the latest when we deploy again.\n\nAnd as I said the malicious requests don't send any referrers and we regularly screen our \"normal\" referrers for interesting things :) It's always funny if people send the referrer of a carding board or something.", "subreddit_id": "t5_2qrkp", "author": "2called_chaos", "gilded": 0, "created_utc": 1490624083, "edited": false, "subreddit": "Malware", "controversiality": 0, "author_flair_text": null, "score": 1, "parent_id": 29232390742, "retrieved_utc": 1491823582, "updated_utc": 1668777374, "body_sha1": "bbf7d606580329109f986402aed810ea6e2566f7", "utc_datetime_str": "2017-03-27 14:14:43"}, {"controversiality": 0, "subreddit": "Malware", "created_utc": 1490623283, "edited": true, "gilded": 0, "author": "2called_chaos", "parent_id": 29233099106, "score": 2, "author_flair_text": null, "id": "dfgu58b", "author_flair_css_class": null, "link_id": "t3_61ornd", "subreddit_id": "t5_2qrkp", "body": "I know about Cloudflare but where is the fun in that ;) But seriously, we aim at having control over most of our infrastructure. We used S3 and then it failed a while back and there is nothing you can do, if our stuff fails we can fix it. Not even talking about things like cloudbleed (not saying that we are safe from vulnerabilities but the SPOF increases drastically by using these huge services).\n\nAlso we implemented a lot of stuff ourselves when there was a perfectly usable and payable solution because we use the data for other protections and you can't access this data from the services. We use findings from requests that CloudFlare would block and use them in fraud prevention for example.", "stickied": false, "distinguished": null, "retrieved_utc": 1491823294, "updated_utc": 1668777373, "body_sha1": "09cab739f5afa9b9e856ce26835f30938e76dd24", "edited_on": 1490624036, "utc_datetime_str": "2017-03-27 14:01:23"}, {"controversiality": 0, "subreddit": "Malware", "created_utc": 1490622667, "edited": false, "gilded": 0, "author": "2called_chaos", "score": 2, "parent_id": 29233096746, "author_flair_text": null, "id": "dfgtp36", "author_flair_css_class": null, "link_id": "t3_61ornd", "subreddit_id": "t5_2qrkp", "body": "I thought about extensions as well but wouldn't they \"disguise\" with the same UA as the browser is actually running on? Also I don't quite understand what you mean with reference tag. I don't have records (yet) about headers they send, I'm mainly looking at the access log and there is no referer nor do any of them load any assets (they really just do the GET request on the index page).\n\nSince they load no assets I doubt that they will interpret inline JS but I could give it a try. We do have some IPs from central america but this is our top10 of recent history but I recall a lot more activity from Brazil, Mexico and Peru but it was a while back when they actually tried logins:\n\n    \"VN-Vietnam\"=&gt;2008,\n    \"US-United States\"=&gt;1742,\n    \"CN-China\"=&gt;1436,\n    \"IN-India\"=&gt;1107,\n    \"BR-Brazil\"=&gt;809,\n    \"RU-Russian Federation\"=&gt;766,\n    \"TH-Thailand\"=&gt;575,\n    \"KR-Korea, Republic of\"=&gt;400,\n    \"JP-Japan\"=&gt;382,\n    \"CA-Canada\"=&gt;264,\n\n", "stickied": false, "distinguished": null, "retrieved_utc": 1491823078, "updated_utc": 1668777373, "body_sha1": "bbc9ac9c7a6dfc4a2756bbdd87c4a8fd9aaa42e9", "utc_datetime_str": "2017-03-27 13:51:07"}, {"parent_id": 29233096746, "score": 2, "author_flair_text": null, "controversiality": 0, "created_utc": 1490607925, "edited": false, "subreddit": "Malware", "gilded": 0, "author": "thingsget", "body": "PS: CloudFlare will stop this type of attack. Its also free!", "subreddit_id": "t5_2qrkp", "stickied": false, "distinguished": null, "author_flair_css_class": null, "id": "dfgmrmq", "link_id": "t3_61ornd", "retrieved_utc": 1491819719, "updated_utc": 1668777363, "body_sha1": "9bff9050a9e1ebc4bd700a86fe412d66e36e222b", "utc_datetime_str": "2017-03-27 09:45:25"}, {"gilded": 0, "author": "thingsget", "controversiality": 0, "created_utc": 1490607761, "edited": false, "subreddit": "Malware", "score": 4, "parent_id": null, "author_flair_text": null, "author_flair_css_class": null, "id": "dfgmpt6", "link_id": "t3_61ornd", "stickied": false, "distinguished": null, "body": "I had a threat like this some time ago, Its a chrome extension malware. It hooks to load page event and injects some code to the page to do a GET request. \n\nIf this is the case you should be getting Reference tag from every random site.\n\nDepending on the sofistication of the malware you should be able to run some JS on the victim's browser or do an HTTP redirect and the victim will follow it.\n\nIf the IPS are coming from central America (Venezuela, Peru, Colombia, etc.) PM me and I can tell you who the botnet owner is.\n", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1491819695, "updated_utc": 1668777363, "body_sha1": "7fb4ebe88babf153924ef2ece55b0ce0a0128718", "nest_level": 1, "utc_datetime_str": "2017-03-27 09:42:41"}], "error": null, "metadata": {"es": {"took": 87, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 6, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1490598060000}}}, {"range": {"created_utc": {"lt": 1490684460000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1490598060000}}},{\"range\":{\"created_utc\":{\"lt\":1490684460000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1673017478.2273905, "api_request_start": 1674105485.3510356, "api_request_end": 1674105485.479902, "api_total_time": 0.12886643409729004}}