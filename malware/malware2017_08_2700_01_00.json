{"data": [{"author": "Jigoku1337", "author_flair_css_class": null, "author_flair_text": null, "body": "Thanks that's really interesting.  As far as reversing I've only ever reversed some USB devices where Linux drivers are not present,  but I'll take a look at that, sounds fun to fiddle about with.", "can_gild": true, "collapsed": false, "collapsed_reason": null, "controversiality": 0, "created_utc": 1503896179, "distinguished": null, "edited": false, "gilded": 0, "id": "dm817mp", "is_submitter": true, "link_id": "t3_6vrwav", "parent_id": 29641647161, "score": 1, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1504442623, "updated_utc": 1668771060, "body_sha1": "15d23a980c0eea50c5eb919a1ff83a84efe5f8c9", "utc_datetime_str": "2017-08-28 04:56:19"}, {"author": "4e4f5045", "author_flair_css_class": null, "author_flair_text": null, "body": "I posted my code for doing the callin on a previous post. Forgot about it until now.\n\nhttps://www.reddit.com/r/Malware/comments/6qtccr/reversing_enough_of_rat_network_protocol_to_make/dl0sv70/\n\nThe njrat protocol is very simple, i think its probably one of the best rats to get started with reversing. Its protocol is nearly all human readable, you can download the builder off of rekings.com. The 3 main versions are 0.6.4, 0.7d and 0.7d golden edition. There isn't a whole lot different between the 0.7d and 0.7d golden edition. I think they added a few new fields to the call in message and changed the delimiter to a different value. 0.6.4 and 0.7d they changed some of the command codes and changed how messages are encoded. In 0.6.4 the length of the message was not prepended and instead it just ended each message with [endof], 0.7d the length was prepended as a null terminated string to the message. \n\nFor njrat if you want to make your own fake client it isn't too hard. The server doesn't remove clients that don't respond to commands and the server does not give the operator the ability to remove clients. If you just connect, send the call in message, and then properly respond to the heartbeat/keep alive messages then they can't get rid of you. You can implement any commands at your leisure. \n\nFor reversing njrat I suggest you download the builder from rekings. Build a payload, then open the payload in dnspy. The builder is obfucated, its far less difficult to reverse the payload. I suggest using dnspy to patch out the CAP command, it generates much less traffic that way making it a little easier to analyze the packet capture in wireshark. \n\nThese are the fwo files for the chat client.\n\n[asynchat.py](https://gist.github.com/anonymous/e65bb91fd3e371c3eecaf5892f42233c)\n\nand \n\n[commander.py](https://gist.github.com/anonymous/24690ca977eb8a343405f722593fd718)\n\n\n\n", "can_gild": true, "collapsed": false, "collapsed_reason": null, "controversiality": 0, "created_utc": 1503888207, "distinguished": null, "edited": false, "gilded": 0, "id": "dm7vdbt", "is_submitter": false, "link_id": "t3_6vrwav", "parent_id": 29641320559, "score": 2, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1504439643, "updated_utc": 1668771053, "body_sha1": "1eb6c0cc8715ae453fe4ef1531fcc780fbd87a1f", "utc_datetime_str": "2017-08-28 02:43:27"}, {"author": "4e4f5045", "author_flair_css_class": null, "author_flair_text": null, "body": "There is one on GitHub that sends prebuild call in strings. I had one that built it but I deleted it. I can upload my chat client for it when I get home if you are interested.", "can_gild": true, "collapsed": false, "collapsed_reason": null, "controversiality": 0, "created_utc": 1503879570, "distinguished": null, "edited": false, "gilded": 0, "id": "dm7ou0n", "is_submitter": false, "link_id": "t3_6vrwav", "parent_id": 29641320559, "score": 1, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1504436281, "updated_utc": 1668771044, "body_sha1": "130de4521c87cb630017a65034a34982bb0764ca", "utc_datetime_str": "2017-08-28 00:19:30"}, {"author": "Jigoku1337", "author_flair_css_class": null, "author_flair_text": null, "body": "Fair enough, i am tempted to find the njRAT sources and try to reverse the protocol to play around with that. Do you know if anyone has published any code that spoofs a fake njRAT client? As i'd rather not reinvent the wheel... ", "can_gild": true, "collapsed": false, "collapsed_reason": null, "controversiality": 0, "created_utc": 1503878956, "distinguished": null, "edited": false, "gilded": 0, "id": "dm7odbj", "is_submitter": true, "link_id": "t3_6vrwav", "parent_id": 29641202920, "score": 1, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1504436037, "updated_utc": 1668771043, "body_sha1": "9bca0a289021b6c2393146d33026db91586b725f", "utc_datetime_str": "2017-08-28 00:09:16"}, {"author": "4e4f5045", "author_flair_css_class": null, "author_flair_text": null, "body": "It's not really an exploit, it's just the server does not verify if it sent a chat request. It doesn't verify for the rdp, mic spy, or webcam spy either. With a single connection you can cause 4 windows to be opened on the C2 side.", "can_gild": true, "collapsed": false, "collapsed_reason": null, "controversiality": 0, "created_utc": 1503875448, "distinguished": null, "edited": false, "gilded": 0, "id": "dm7lujs", "is_submitter": false, "link_id": "t3_6vrwav", "parent_id": 29641172858, "score": 2, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1504434708, "updated_utc": 1668771037, "body_sha1": "125cc8ce71f2a8fcb1420140bd6291d747cc5a67", "utc_datetime_str": "2017-08-27 23:10:48"}, {"author": "Jigoku1337", "author_flair_css_class": null, "author_flair_text": null, "body": "I do daily. But never get anything besides plaintext on the several email services i use. The built in spam protection seems to be working. \n\nWhat are some email providers that lack spam filtering? (outside of setting up my own mail server)", "can_gild": true, "collapsed": false, "collapsed_reason": null, "controversiality": 0, "created_utc": 1503874714, "distinguished": null, "edited": false, "gilded": 0, "id": "dm7lb14", "is_submitter": true, "link_id": "t3_6vrwav", "parent_id": 29632680460, "score": 1, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1504434443, "updated_utc": 1668771036, "body_sha1": "33551cfc2ee1d1fa454bd5403cfb122288134c77", "utc_datetime_str": "2017-08-27 22:58:34"}, {"author": "Jigoku1337", "author_flair_css_class": null, "author_flair_text": null, "body": "Is that opening the chat on the C&amp;C server? I'm aware things like DarkComet have an exploit for file uploading (potentially allowing anyone to take over the C&amp;C), but didn't known njRAT could be exploitable.\n\nHowever, that's crazy if irc bots like that are still around today. I used to find alot of irc bot binaries about a decade ago which were highly insecure, usually having the nickname alone set as the auth.", "can_gild": true, "collapsed": false, "collapsed_reason": null, "controversiality": 0, "created_utc": 1503874570, "distinguished": null, "edited": false, "gilded": 0, "id": "dm7l7cq", "is_submitter": true, "link_id": "t3_6vrwav", "parent_id": 29636261575, "score": 1, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1504434393, "updated_utc": 1668771036, "body_sha1": "1a37190f881dad6cdaeac6e7d766a83e30ff7adf", "utc_datetime_str": "2017-08-27 22:56:10"}, {"author": "goretsky", "author_flair_css_class": null, "author_flair_text": null, "body": "Hello, \n\nPotentially Unwanted Applications are one of my areas of [research](https://www.welivesecurity.com/2012/01/09/potentially-unwanted-applications-white-paper-updated/) and I do not recall hearing this term before.  I suspect it is either jargon invented by the sysadmin, or a marketing term not widely-used, as [4745454B](/u/4745454B) suggested. \n\nRegards, \n\nAryeh Goretsky ", "can_gild": true, "collapsed": false, "collapsed_reason": null, "controversiality": 0, "created_utc": 1503865545, "distinguished": null, "edited": false, "gilded": 0, "id": "dm7eeih", "is_submitter": false, "link_id": "t3_6w5kn8", "parent_id": null, "score": 2, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1504430732, "updated_utc": 1668771024, "body_sha1": "2d29d5116c40cdcee1b34bd3cbaca893e19a3ad8", "nest_level": 1, "utc_datetime_str": "2017-08-27 20:25:45"}, {"author": "majorllama", "author_flair_css_class": null, "author_flair_text": null, "body": "Absolutely.", "can_gild": true, "collapsed": false, "collapsed_reason": null, "controversiality": 0, "created_utc": 1503850559, "distinguished": null, "edited": false, "gilded": 0, "id": "dm72nln", "is_submitter": true, "link_id": "t3_6wcnbv", "parent_id": 29640271829, "score": 1, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1504424872, "updated_utc": 1668771004, "body_sha1": "0a9143d47fb8f5c8ce72c187dbb4f2c8bedf3de9", "utc_datetime_str": "2017-08-27 16:15:59"}, {"author": "010kindsofpeople", "author_flair_css_class": null, "author_flair_text": null, "body": "That pdf icon will wreck non-savy users without file extensions displayed. ", "can_gild": true, "collapsed": false, "collapsed_reason": null, "controversiality": 0, "created_utc": 1503849583, "distinguished": null, "edited": false, "gilded": 0, "id": "dm71w45", "is_submitter": false, "link_id": "t3_6wcnbv", "parent_id": 29640250175, "score": 2, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1504424502, "updated_utc": 1668771003, "body_sha1": "21ac27eb71cb2495aec465b9f2c0da2686cf3e4d", "utc_datetime_str": "2017-08-27 15:59:43"}], "error": null, "metadata": {"es": {"took": 238, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 16, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1503817260000}}}, {"range": {"created_utc": {"lt": 1503903660000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1503817260000}}},{\"range\":{\"created_utc\":{\"lt\":1503903660000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1673945683.810305, "api_request_start": 1674106977.5895388, "api_request_end": 1674106977.8691797, "api_total_time": 0.27964091300964355}}