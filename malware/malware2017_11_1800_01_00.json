{"data": [{"author": "espenfjo", "author_flair_css_class": null, "author_flair_text": null, "body": "Here you have one example of such malware. Not a threat for the everyday user, but it exists.\nIt uses a VirtualBox driver that is susceptible for hijacking, so no need for modifying it and destroying the legit signature.\n\nhttp://blog.talosintelligence.com/2014/04/snake-campaign-few-words-about-uroburos.html", "can_gild": true, "controversiality": 0, "created_utc": 1511075545, "distinguished": null, "edited": false, "gilded": 0, "id": "dq1cpl8", "is_submitter": false, "link_id": "t3_7dx7t9", "parent_id": null, "permalink": "/r/Malware/comments/7dx7t9/can_malware_install_drivers_to_your_computer/dq1cpl8/", "score": 2, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "retrieved_utc": 1512796708, "updated_utc": 1668768549, "body_sha1": "287240df1b2ce387cfa0b4070ea379d3cffd71a0", "nest_level": 1, "utc_datetime_str": "2017-11-19 07:12:25"}, {"author": "Kamwind", "author_flair_css_class": null, "author_flair_text": null, "body": "I guess it could but I am not sure why you would.  if you write that the malicious device driver and then get it installed on the computer you could have it do whatever you want.\n\n", "can_gild": true, "controversiality": 0, "created_utc": 1511070479, "distinguished": null, "edited": false, "gilded": 0, "id": "dq1a6bq", "is_submitter": false, "link_id": "t3_7dx7t9", "parent_id": 29872428233, "permalink": "/r/Malware/comments/7dx7t9/can_malware_install_drivers_to_your_computer/dq1a6bq/", "score": 1, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "retrieved_utc": 1512795382, "updated_utc": 1668768545, "body_sha1": "79811de55414754f53485f64adc732be17de9b08", "utc_datetime_str": "2017-11-19 05:47:59"}, {"author": "fredfredburger88", "author_flair_css_class": null, "author_flair_text": null, "body": "&gt; Lets say they wanted to add a driver that would allow for packet monitoring on a wireless card (NPcap) They could just hide it with a rootkit and I'd never know? Or would there be some hint, even with said rootkit?\n\nLets say they wanted to add malicious code that would allow for consistent, day-to-day packet monitoring on a wireless card (like NPcap or something similar) Would it be the executable on the drive in this case?", "can_gild": true, "controversiality": 0, "created_utc": 1511069819, "distinguished": null, "edited": false, "gilded": 0, "id": "dq19t55", "is_submitter": true, "link_id": "t3_7dx7t9", "parent_id": 29872415340, "permalink": "/r/Malware/comments/7dx7t9/can_malware_install_drivers_to_your_computer/dq19t55/", "score": 1, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "retrieved_utc": 1512795201, "updated_utc": 1668768544, "body_sha1": "70070f1bc73a5e5f7f26ff040dc78c7f2f44db96", "utc_datetime_str": "2017-11-19 05:36:59"}, {"author": "Kamwind", "author_flair_css_class": null, "author_flair_text": null, "body": "if they infected the executable on the drive then yes.  if instead the malicious software only modified the executing code then you have this:  http://blog.opensecurityresearch.com/2013/01/windows-dll-injection-basics.html\n", "can_gild": true, "controversiality": 0, "created_utc": 1511069320, "distinguished": null, "edited": false, "gilded": 0, "id": "dq19j70", "is_submitter": false, "link_id": "t3_7dx7t9", "parent_id": 29872405750, "permalink": "/r/Malware/comments/7dx7t9/can_malware_install_drivers_to_your_computer/dq19j70/", "score": 1, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "retrieved_utc": 1512795051, "updated_utc": 1668768544, "body_sha1": "23d5d719ac95377ab42ea87aca2ddf3c9ba77b3b", "utc_datetime_str": "2017-11-19 05:28:40"}, {"author": "fredfredburger88", "author_flair_css_class": null, "author_flair_text": null, "body": "Could checking the hashes of all the drivers be enough to find out what they are? Would injecting malicious code into a driver change the hash?\n\nHow could I quickly see all the drivers on my system? Even ones that aren't in the normal drivers file? Is there an extension or something that they all share that i can search by? \n\n\n\nLets say they wanted to add a driver that would allow for packet monitoring on a wireless card (NPcap) They could just hide it with a rootkit and I'd never know? Or would there be some hint, even with said rootkit?\n\n\n", "can_gild": true, "controversiality": 0, "created_utc": 1511069167, "distinguished": null, "edited": true, "gilded": 0, "id": "dq19g3c", "is_submitter": true, "link_id": "t3_7dx7t9", "parent_id": 29871992897, "permalink": "/r/Malware/comments/7dx7t9/can_malware_install_drivers_to_your_computer/dq19g3c/", "score": 3, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "retrieved_utc": 1512795010, "updated_utc": 1668768544, "body_sha1": "0c5de253d9273f0307c89a2e6e3f00fa5bf944fd", "edited_on": 1511069348, "utc_datetime_str": "2017-11-19 05:26:07"}, {"author": "fredfredburger88", "author_flair_css_class": null, "author_flair_text": null, "body": "So if the hash of a driver file was AAAB and then it became injected with new code, would the hash remain AAAB or change to AAAC,  for example?\n\n\n", "can_gild": true, "controversiality": 0, "created_utc": 1511068957, "distinguished": null, "edited": false, "gilded": 0, "id": "dq19bsm", "is_submitter": true, "link_id": "t3_7dx7t9", "parent_id": 29872360820, "permalink": "/r/Malware/comments/7dx7t9/can_malware_install_drivers_to_your_computer/dq19bsm/", "score": 1, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "retrieved_utc": 1512794952, "updated_utc": 1668768544, "body_sha1": "fd0709049be453dac13f3fcd29d74cf5f229db13", "utc_datetime_str": "2017-11-19 05:22:37"}, {"author": "Kamwind", "author_flair_css_class": null, "author_flair_text": null, "body": "The power of a root kit is that it could modify the O/S kernel so at that point all rules are out.\n\nDriver signature is checked at installation to make sure the package is good.  So once it is pass that point drivers are still vulnerable to all malicious attacks that any other software is; what usually protects it is that it runs outside the normal user space so gets protected from malware that would be running at the user level.\nAlso code injection that happens while the program is running would not matter for signatures of the files.\n\nA lot of vendors do provide the md5 hash of the install package, but with this you are duplicating what signatures are doing.  You could get the hash of the file and submit it to https://www.virustotal.com/ and see if anything comes up.  I would not think that they have all device driver files.\n", "can_gild": true, "controversiality": 0, "created_utc": 1511067329, "distinguished": null, "edited": false, "gilded": 0, "id": "dq18d4k", "is_submitter": false, "link_id": "t3_7dx7t9", "parent_id": 29872204486, "permalink": "/r/Malware/comments/7dx7t9/can_malware_install_drivers_to_your_computer/dq18d4k/", "score": 1, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "retrieved_utc": 1512794457, "updated_utc": 1668768542, "body_sha1": "be9d82637f89e06be1202376e7ac4947122731fc", "utc_datetime_str": "2017-11-19 04:55:29"}, {"author": "fredfredburger88", "author_flair_css_class": null, "author_flair_text": null, "body": "Okay, so the drivers would have to be in the location no matter what? Could a rootkit hide them like the above user said?\n\nAlso, if code was injected into a driver already there, would that change the signature and allow me to see if it was malicious?\n\n\nNoobish question, but can I get hashes of the drivers somehow and then google them to get a description of their purpose? ", "can_gild": true, "controversiality": 0, "created_utc": 1511062181, "distinguished": null, "edited": false, "gilded": 0, "id": "dq150hy", "is_submitter": true, "link_id": "t3_7dx7t9", "parent_id": 29872180438, "permalink": "/r/Malware/comments/7dx7t9/can_malware_install_drivers_to_your_computer/dq150hy/", "score": 1, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "retrieved_utc": 1512792687, "updated_utc": 1668768537, "body_sha1": "792df79f543e8d8524d854f7b55c61dce46b31e7", "utc_datetime_str": "2017-11-19 03:29:41"}, {"author": "Kamwind", "author_flair_css_class": null, "author_flair_text": null, "body": "depends on the version of windows but from vista onward it has to be in C:Windows\\System32\\driverStore and the path defined in the DevicePath registry hklm/software/microsoft/windows/currentversion.\n\nyou still have the risk of code injection so malware running could modify the running driver code if the malware has high enough permissions.\n\nmain defense is keep your anti-virus up to date and as mentioned previously check the signatures and only use signed drivers.\n\nhttps://www.howtogeek.com/167723/how-to-disable-driver-signature-verification-on-64-bit-windows-8.1-so-that-you-can-install-unsigned-drivers/\n", "can_gild": true, "controversiality": 0, "created_utc": 1511061471, "distinguished": null, "edited": false, "gilded": 0, "id": "dq14hxy", "is_submitter": false, "link_id": "t3_7dx7t9", "parent_id": null, "permalink": "/r/Malware/comments/7dx7t9/can_malware_install_drivers_to_your_computer/dq14hxy/", "score": 1, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "retrieved_utc": 1512792399, "updated_utc": 1668768536, "body_sha1": "04886476d87163bdf8420a124d109afbf6747a20", "nest_level": 1, "utc_datetime_str": "2017-11-19 03:17:51"}, {"author": "Urd", "author_flair_css_class": null, "author_flair_text": null, "body": "Technically yes, and if you have a malicious driver on your computer it is probably performing rootkit functionality which would prevent normal programs from being able to see it.", "can_gild": true, "controversiality": 0, "created_utc": 1511056180, "distinguished": null, "edited": false, "gilded": 0, "id": "dq10h8h", "is_submitter": false, "link_id": "t3_7dx7t9", "parent_id": null, "permalink": "/r/Malware/comments/7dx7t9/can_malware_install_drivers_to_your_computer/dq10h8h/", "score": 14, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "retrieved_utc": 1512790196, "updated_utc": 1668768530, "body_sha1": "9843f407cef0495e25fb1257401bb4aa35441732", "nest_level": 1, "utc_datetime_str": "2017-11-19 01:49:40"}], "error": null, "metadata": {"es": {"took": 89, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 18, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1510992060000}}}, {"range": {"created_utc": {"lt": 1511078460000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1510992060000}}},{\"range\":{\"created_utc\":{\"lt\":1511078460000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1673945683.810305, "api_request_start": 1674107200.873649, "api_request_end": 1674107200.9919112, "api_total_time": 0.11826229095458984}}