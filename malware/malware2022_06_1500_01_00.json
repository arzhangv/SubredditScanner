{"data": [{"all_awardings": [], "archived": false, "associated_award": null, "author": "AutoModerator", "author_created_utc": 1325741068, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_6l4z3", "author_patreon_flair": false, "author_premium": true, "body": "It looks like you are posting a question, possibly looking for technical support. \n\nThis subreddit\u2019s purpose is to discuss malware internals and technical details. *This is NOT a place for help with malware removal or various other end-user questions. Please redirect questions related to malware removal to /r/Antivirus or /r/techsupport. Ransomware related questions can be directed to /r/ransomware*\n\nIf this was removed in error, please message the moderators **and be sure to include the link to the post** - we love reading quality content just as much as you do!\n\n\n*I am a bot, and this action was performed automatically. Please [contact the moderators of this subreddit](/message/compose/?to=/r/Malware) if you have any questions or concerns.*", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1655355508, "distinguished": "moderator", "edited": false, "gilded": 0, "gildings": {}, "id": "icjq5hj", "is_submitter": false, "link_id": "t3_vde02f", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/vde02f/how_would_i_go_about_opening_and_examining_a/icjq5hj/", "score": 1, "score_hidden": false, "send_replies": false, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1656902639, "updated_utc": 1667915385, "body_sha1": "8f3bc8591114934970af180642927ea5aec9802e", "nest_level": 1, "utc_datetime_str": "2022-06-16 04:58:28"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "AutoModerator", "author_created_utc": 1325741068, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_6l4z3", "author_patreon_flair": false, "author_premium": true, "body": "It looks like you are posting a question, possibly looking for technical support. \n\nThis subreddit\u2019s purpose is to discuss malware internals and technical details. *This is NOT a place for help with malware removal or various other end-user questions. Please redirect questions related to malware removal to /r/Antivirus or /r/techsupport. Ransomware related questions can be directed to /r/ransomware*\n\nIf this was removed in error, please message the moderators **and be sure to include the link to the post** - we love reading quality content just as much as you do!\n\n\n*I am a bot, and this action was performed automatically. Please [contact the moderators of this subreddit](/message/compose/?to=/r/Malware) if you have any questions or concerns.*", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1655355361, "distinguished": "moderator", "edited": false, "gilded": 0, "gildings": {}, "id": "icjpxkj", "is_submitter": false, "link_id": "t3_vddynj", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/vddynj/i_want_to_examine_a_file_that_hacked_me_because/icjpxkj/", "score": 1, "score_hidden": false, "send_replies": false, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1656902645, "updated_utc": 1667915384, "body_sha1": "8f3bc8591114934970af180642927ea5aec9802e", "nest_level": 1, "utc_datetime_str": "2022-06-16 04:56:01"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "WhoTookPlasticJesus", "author_created_utc": 1299739177, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_4xzdf", "author_patreon_flair": false, "author_premium": false, "body": "It's a base64-enconded trie, which is extremely normal for this use case. If you really want to see the binary structure it decodes to just use Python or Ruby or an online decoder.", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1655351285, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "icjjbzj", "is_submitter": false, "link_id": "t3_vd44r4", "locked": false, "no_follow": false, "parent_id": null, "permalink": "/r/Malware/comments/vd44r4/deobfuscating_suspicous_code/icjjbzj/", "score": 8, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1656902801, "updated_utc": 1667915375, "body_sha1": "440985c91986a6a357f0c3cda59bc9d3c4bbd748", "nest_level": 1, "utc_datetime_str": "2022-06-16 03:48:05"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "goestowar", "author_created_utc": 1413438898, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_ivqqi", "author_patreon_flair": false, "author_premium": false, "body": "It's a base64 encoded string that decodes to some kind of binary.\n\nCopy the string from the js file, find/use your preferred base64 encoder/decoder (there is one in your proxy of choice most times) and decode the string.\n\nYou will see that it decodes to weird characters and a bunch of binary non-printable characters which you can possibly decode further, it may be some kind of protocol that you can figure out.\n\nThat's kind of as far as I can go!", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1655334525, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "icil4zg", "is_submitter": false, "link_id": "t3_vd44r4", "locked": false, "no_follow": true, "parent_id": 39938339798, "permalink": "/r/Malware/comments/vd44r4/deobfuscating_suspicous_code/icil4zg/", "score": 3, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1656903616, "updated_utc": 1667915338, "body_sha1": "b8257fe366402206913e0e802d4810d1e6a06b1d", "utc_datetime_str": "2022-06-15 23:08:45"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "marvuozz", "author_created_utc": 1359467177, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_aekgd", "author_patreon_flair": false, "author_premium": false, "body": "It is in the official release as well:\n\nhttps://html2canvas.hertzen.com/dist/html2canvas.js\n\nIt's a data structure encoded as base64. In the comment you can find reference to https://github.com/niklasvh/base64-arraybuffer.\n\nJust because base64 is used to obfuscate malicious code, it does not mean that every base64 encoded string must be malicious.\n\n\nTo decode, use https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true,false). it's gibberish because it's a raw data structure.", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1655330159, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "icibgra", "is_submitter": false, "link_id": "t3_vd44r4", "locked": false, "no_follow": false, "parent_id": null, "permalink": "/r/Malware/comments/vd44r4/deobfuscating_suspicous_code/icibgra/", "score": 23, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1656903848, "updated_utc": 1667915327, "body_sha1": "7f64d8591a685fabb01f6f439513fd9d7762f09c", "nest_level": 1, "utc_datetime_str": "2022-06-15 21:55:59"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "edward_snowedin", "author_created_utc": 1391093201, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_f1qki", "author_patreon_flair": false, "author_premium": false, "body": "its a base64 encoded string dude", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1655329507, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "ici9z2q", "is_submitter": false, "link_id": "t3_vd44r4", "locked": false, "no_follow": false, "parent_id": 39938364060, "permalink": "/r/Malware/comments/vd44r4/deobfuscating_suspicous_code/ici9z2q/", "score": 5, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1656903884, "updated_utc": 1667915326, "body_sha1": "18a2eaca1904dafc1b623973ac0bdf4095c87eb1", "utc_datetime_str": "2022-06-15 21:45:07"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "boonstyle_", "author_created_utc": 1499627079, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_50do00z", "author_patreon_flair": false, "author_premium": false, "body": "VS throws an error when using that string", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1655329408, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "ici9qxo", "is_submitter": true, "link_id": "t3_vd44r4", "locked": false, "no_follow": true, "parent_id": 39938322412, "permalink": "/r/Malware/comments/vd44r4/deobfuscating_suspicous_code/ici9qxo/", "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1656903891, "updated_utc": 1667915325, "body_sha1": "c31e719fda206bf20c79b4dbfefde64c87150e32", "utc_datetime_str": "2022-06-15 21:43:28"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "boonstyle_", "author_created_utc": 1499627079, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_50do00z", "author_patreon_flair": false, "author_premium": false, "body": "its in the js file of the repo\n\n&amp;#x200B;\n\n[https://huggingface.co/spaces/dalle-mini/dalle-mini/raw/main/html2canvas.js](https://huggingface.co/spaces/dalle-mini/dalle-mini/raw/main/html2canvas.js)\n\n&amp;#x200B;\n\nits the string variable called \"base64\" and its so huge you cant miss it (its a string of 52 888 characters) on line 406 as well as 3784\n\n[https://i.imgur.com/1xHsvRl.png](https://i.imgur.com/1xHsvRl.png)\n\nright after comes some code that seems to decode obfuscated code from that string by rearranging and bitshifting\n\n&amp;#x200B;\n\nline 3796\n\n    var decode = function (base64) {\n        var bufferLength = base64.length * 0.75, len = base64.length, i, p = 0, encoded1, encoded2, encoded3, encoded4;\n        if (base64[base64.length - 1] === '=') {\n            bufferLength--;\n            if (base64[base64.length - 2] === '=') {\n                bufferLength--;\n            }\n        }\n        var buffer = typeof ArrayBuffer !== 'undefined' &amp;&amp;\n            typeof Uint8Array !== 'undefined' &amp;&amp;\n            typeof Uint8Array.prototype.slice !== 'undefined'\n            ? new ArrayBuffer(bufferLength)\n            : new Array(bufferLength);\n        var bytes = Array.isArray(buffer) ? buffer : new Uint8Array(buffer);\n        for (i = 0; i &lt; len; i += 4) {\n            encoded1 = lookup$1[base64.charCodeAt(i)];\n            encoded2 = lookup$1[base64.charCodeAt(i + 1)];\n            encoded3 = lookup$1[base64.charCodeAt(i + 2)];\n            encoded4 = lookup$1[base64.charCodeAt(i + 3)];\n            bytes[p++] = (encoded1 &lt;&lt; 2) | (encoded2 &gt;&gt; 4);\n            bytes[p++] = ((encoded2 &amp; 15) &lt;&lt; 4) | (encoded3 &gt;&gt; 2);\n            bytes[p++] = ((encoded3 &amp; 3) &lt;&lt; 6) | (encoded4 &amp; 63);\n        }\n        return buffer;\n    };\n\ni cant get it to run in node.js but again im not familar with JS but this looks extremely weird having such a string of 52888 characters in a variable called base64 and doing some pondering to create new stuff out of it, seen that in c++ before in some malware.", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1655329185, "distinguished": null, "edited": true, "gilded": 0, "gildings": {}, "id": "ici987q", "is_submitter": true, "link_id": "t3_vd44r4", "locked": false, "no_follow": true, "parent_id": 39938236586, "permalink": "/r/Malware/comments/vd44r4/deobfuscating_suspicous_code/ici987q/", "score": 3, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1656903902, "updated_utc": 1667915325, "body_sha1": "826d6eba07cc22d0639ea04066c946eb7882bc9f", "edited_on": 1655329618, "utc_datetime_str": "2022-06-15 21:39:45"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "edward_snowedin", "author_created_utc": 1391093201, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_f1qki", "author_patreon_flair": false, "author_premium": false, "body": "&gt; Cant figure out how i can deobfuscate this one in JS and the string is too long to do that in C++.\n\nhuh?", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1655329021, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "ici8uss", "is_submitter": false, "link_id": "t3_vd44r4", "locked": false, "no_follow": false, "parent_id": null, "permalink": "/r/Malware/comments/vd44r4/deobfuscating_suspicous_code/ici8uss/", "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1656903911, "updated_utc": 1667915324, "body_sha1": "99212484f089c7419a614648f69e1da03966bafe", "nest_level": 1, "utc_datetime_str": "2022-06-15 21:37:01"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "lacksfor", "author_created_utc": 1597583933, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_7cwwc87l", "author_patreon_flair": false, "author_premium": false, "body": "It could be minified as well\n\nhttps://lelinhtinh.github.io/de4js/", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1655328816, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "ici8dut", "is_submitter": false, "link_id": "t3_vd44r4", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/vd44r4/deobfuscating_suspicous_code/ici8dut/", "score": 2, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1656903922, "updated_utc": 1667915323, "body_sha1": "a6ca84ba145c38c59f0453b2579b3052ec4971f8", "nest_level": 1, "utc_datetime_str": "2022-06-15 21:33:36"}], "error": null, "metadata": {"es": {"took": 74, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 13, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1655276460000}}}, {"range": {"created_utc": {"lt": 1655362860000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1655276460000}}},{\"range\":{\"created_utc\":{\"lt\":1655362860000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1673017478.2578893, "api_request_start": 1674112068.4931571, "api_request_end": 1674112068.6228127, "api_total_time": 0.1296555995941162}}