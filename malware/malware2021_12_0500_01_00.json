{"data": [{"all_awardings": [], "archived": false, "associated_award": null, "author": "JoeBeOneKenobi", "author_created_utc": 1574026953, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_4dhtw20k", "author_patreon_flair": false, "author_premium": false, "body": "That\u2019s what I think was happening when I was attempting to analyse this sample last night!\n\nI was trying to break on VirtualAlloc but like you say it wouldn\u2019t break and I couldn\u2019t work out why.\n\nThanks I\u2019ll look into that today!", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1638775451, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "hnfms91", "is_submitter": true, "link_id": "t3_r9jhb5", "locked": false, "no_follow": false, "parent_id": 38421832168, "permalink": "/r/Malware/comments/r9jhb5/dll_to_exe/hnfms91/", "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1645789269, "updated_utc": 1668619838, "body_sha1": "02b889520d827a31ff8687d43063589b30e0ba94", "utc_datetime_str": "2021-12-06 07:24:11"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "twat_muncher", "author_created_utc": 1541099596, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_ze691in", "author_patreon_flair": false, "author_premium": false, "body": "x32/x64dbg does the same thing as olly, if you install shell extensions you can even right click a .dll and \"open in x64dbg\". You have to change options to break on each loaded dll because it just loads all the dependencies and then unloads and exits.", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1638768974, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "hnfd7fs", "is_submitter": false, "link_id": "t3_r9jhb5", "locked": false, "no_follow": true, "parent_id": 38416798524, "permalink": "/r/Malware/comments/r9jhb5/dll_to_exe/hnfd7fs/", "score": 2, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1645790153, "updated_utc": 1668619824, "body_sha1": "f4e4a9ead699c7831a78f455f99a8bf89affbe24", "utc_datetime_str": "2021-12-06 05:36:14"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "Sentor9199", "author_created_utc": 1602592926, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_6qdv7sp0", "author_patreon_flair": false, "author_premium": false, "body": "Yes rundll32 is useful to run dll and set breakpoints in it. Using a debugger like ida/ windbg with the combination of rundll32 as the application can allow for a cooler debugging experience.", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1638762978, "distinguished": null, "edited": true, "gilded": 0, "gildings": {}, "id": "hnf23ka", "is_submitter": false, "link_id": "t3_r9jhb5", "locked": false, "no_follow": false, "parent_id": 38417194672, "permalink": "/r/Malware/comments/r9jhb5/dll_to_exe/hnf23ka/", "score": 5, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1645791193, "updated_utc": 1668619810, "body_sha1": "5bd8b48fbdcd5dd8fafe18894f7f600a4abf6336", "edited_on": 1638767211, "utc_datetime_str": "2021-12-06 03:56:18"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "[deleted]", "author_created_utc": null, "author_flair_background_color": "", "author_flair_css_class": null, "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": "dark", "body": "[deleted]", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1638761974, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "hnezwfh", "is_submitter": false, "link_id": "t3_r9jhb5", "locked": false, "no_follow": true, "parent_id": 38417562938, "permalink": "/r/Malware/comments/r9jhb5/dll_to_exe/hnezwfh/", "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1645791398, "updated_utc": 1668619808, "body_sha1": "228f7d207920fb84335fac5b2b06ed7b472ece9e", "utc_datetime_str": "2021-12-06 03:39:34"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "JoeBeOneKenobi", "author_created_utc": 1574026953, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_4dhtw20k", "author_patreon_flair": false, "author_premium": false, "body": "How is the entry point derived? Is that specified in the initial doc that delivers the powershell?\n\nIf so, is there anyway we can ascertain the entry point when we just have the dll?\n\n(AV on my host machine is preventing me downloading the from the malicious domains and it\u2019s my one and only laptop so I\u2019m reluctant to turn av off)", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1638730533, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "hnctpa2", "is_submitter": true, "link_id": "t3_r9jhb5", "locked": false, "no_follow": true, "parent_id": 38417538591, "permalink": "/r/Malware/comments/r9jhb5/dll_to_exe/hnctpa2/", "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1645798844, "updated_utc": 1668619718, "body_sha1": "708f6bf6adc9af63f8d97481e35fa359c4cbb90a", "utc_datetime_str": "2021-12-05 18:55:33"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "JoeBeOneKenobi", "author_created_utc": 1574026953, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_4dhtw20k", "author_patreon_flair": false, "author_premium": false, "body": "That\u2019s awesome, I\u2019ll have a look\n\nThanks very much", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1638730395, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "hnctc17", "is_submitter": true, "link_id": "t3_r9jhb5", "locked": false, "no_follow": true, "parent_id": 38417538591, "permalink": "/r/Malware/comments/r9jhb5/dll_to_exe/hnctc17/", "score": 3, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1645798880, "updated_utc": 1668619717, "body_sha1": "2b679d2250afa03bdd37ffdebab26b17fe865f67", "utc_datetime_str": "2021-12-05 18:53:15"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "micropeenandproud", "author_created_utc": 1616868428, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_9514n60w", "author_patreon_flair": false, "author_premium": false, "body": "yeah so with new emotet, the stage 2 payload is a dll with a certain entry point to start at.\n\nI imagine this sample might have been automatically unpacked by a sandbox and just hashed and uploaded without verifying. Might've just been borked during unpacking.\n\nTry this eeb13cd51faa7c23d9a40241d03beb239626fbf3efe1dbbfa3994fc10dea0827. I know it to be a good unpacked sample for the main payload of new emotet. Can download it from malshare, and probably other places if that's a pain.", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1638730337, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "hnct6hr", "is_submitter": false, "link_id": "t3_r9jhb5", "locked": false, "no_follow": true, "parent_id": 38417479521, "permalink": "/r/Malware/comments/r9jhb5/dll_to_exe/hnct6hr/", "score": 2, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1645798895, "updated_utc": 1668619717, "body_sha1": "ab17923d49f4a95e2e003b8d4f44fe7ef431fe61", "utc_datetime_str": "2021-12-05 18:52:17"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "JoeBeOneKenobi", "author_created_utc": 1574026953, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_4dhtw20k", "author_patreon_flair": false, "author_premium": false, "body": "That explains a lot! Thanks! Appreciate you looking into it.\n\nI thought it might be because it\u2019s packed?\n\nI\u2019ll have a look at more emotet samples, on malware bazaar all the stage 2 payloads seem to be dll rather than exe.", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1638729870, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "hncrwwx", "is_submitter": true, "link_id": "t3_r9jhb5", "locked": false, "no_follow": true, "parent_id": 38417452144, "permalink": "/r/Malware/comments/r9jhb5/dll_to_exe/hncrwwx/", "score": 2, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1645799018, "updated_utc": 1668619716, "body_sha1": "133c359753ca4c49adab97d0980cb9522c756472", "utc_datetime_str": "2021-12-05 18:44:30"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "micropeenandproud", "author_created_utc": 1616868428, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_9514n60w", "author_patreon_flair": false, "author_premium": false, "body": "So in the case of normal exes and DLLs, you'd expect DLLs to have a bunch of exports (the different functions of the library) and an EXE file to have simply one export named \"entry\" which windows knows to call as the beginning of the code.\n\nYour sample actually seems pretty messed up/corrupt and doesn't look to be in a state that it could execute. Bad section sizes, only has one export, the DllEntryPoint but it seems to not have proper code in it. Will ask around and see if it can be fixed but maybe try a different sample\n\nEdit: have personally not heard converting to an exe ever be suggested as that's a bit of a strange thing to do,  but perhaps if the DLL only has a single export then it could technically be worth doing if only to get it to run in a sandbox. But even to do that you'd have to know the entry (main) function name to do so", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1638729661, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "hncrbsg", "is_submitter": false, "link_id": "t3_r9jhb5", "locked": false, "no_follow": false, "parent_id": 38417256908, "permalink": "/r/Malware/comments/r9jhb5/dll_to_exe/hncrbsg/", "score": 3, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1645799075, "updated_utc": 1668619715, "body_sha1": "81f433ad6e5296eda2ae569de17a99743926c162", "utc_datetime_str": "2021-12-05 18:41:01"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "JoeBeOneKenobi", "author_created_utc": 1574026953, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_4dhtw20k", "author_patreon_flair": false, "author_premium": false, "body": "Hi, thanks for the detailed reply.\n\nWhen i look at the dll in pestudio i can't see any exports, i assumed this was because it's a dll and thought if it was an exe i'd be able to see these.\n\nSee the screen shot below.\n\nThe dll is actually an emotet sample i downloaded from malware bazaar.\n\nI'm just wondering how i can extract and useful artefacts from it, and any guides i've read suggest the dll -&gt; exe as a good first step.\n\nlooks like my screenshot got removed! If you're interested the sha256 hash is 5e3312cc82d10726c4e7063365df227356abe27e24f782ed1327f4a3bf3fcdbf", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1638728208, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "hncn558", "is_submitter": true, "link_id": "t3_r9jhb5", "locked": false, "no_follow": true, "parent_id": 38417214760, "permalink": "/r/Malware/comments/r9jhb5/dll_to_exe/hncn558/", "score": 2, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1645799430, "updated_utc": 1668619710, "body_sha1": "b75d93ed229ecbd8aaa4f176c615d53f7ff6a9fa", "utc_datetime_str": "2021-12-05 18:16:48"}], "error": null, "metadata": {"es": {"took": 66, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 17, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1638691260000}}}, {"range": {"created_utc": {"lt": 1638777660000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1638691260000}}},{\"range\":{\"created_utc\":{\"lt\":1638777660000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1673017478.2578893, "api_request_start": 1674111553.7481823, "api_request_end": 1674111553.8623617, "api_total_time": 0.11417937278747559}}