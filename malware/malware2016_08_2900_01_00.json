{"data": [{"author_flair_text": null, "controversiality": 0, "created_utc": 1472526401, "edited": true, "link_id": "t3_4zgbu6", "distinguished": null, "parent_id": null, "author": "mcfoolin", "body": "Type into google: \"Microsoft certified technician your pc is infected\" and go to the later pages of results. The weirdly named links are usually the ones you are looking for. Look especially for ones that write in all caps and list a phone number to call. They will literally say in the google result \"YOUR PC IS INFECTED!!\". Would probably use chrome so you can block the popup spam.\n\nFollow that and you will find one of these site in 2 minutes guaranteed.\n\nEdit: found one on the 5th page of Bing using comic sans with an automated voice recording :O", "author_flair_css_class": null, "ups": 1, "stickied": false, "id": "d7259zr", "gilded": 0, "subreddit_id": "t5_2qrkp", "subreddit": "Malware", "score": 1, "retrieved_utc": 1473673520, "updated_utc": 1668787432, "body_sha1": "595c9e5ed15b5599f51a046c107e8fb5aaa16183", "edited_on": 1472526736, "nest_level": 1, "utc_datetime_str": "2016-08-30 03:06:41"}, {"distinguished": null, "author": "byteguard", "parent_id": 28724438014, "body": "This macro does indeed make the maxmind request and checks the resulting JSON for indicators that the   IP of the machine it is executing on isn't owned by AV companies. ", "created_utc": 1472523533, "author_flair_text": null, "controversiality": 0, "link_id": "t3_507buk", "edited": false, "subreddit": "Malware", "gilded": 0, "subreddit_id": "t5_2qrkp", "score": 3, "author_flair_css_class": null, "stickied": false, "id": "d723c0u", "ups": 3, "retrieved_utc": 1473672898, "updated_utc": 1668787431, "body_sha1": "ce2f210f7968f5a1e8291c7b0b5de13858eb2eaf", "utc_datetime_str": "2016-08-30 02:18:53"}, {"id": "d7231ix", "stickied": false, "ups": 1, "author_flair_css_class": null, "score": 1, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "gilded": 0, "link_id": "t3_507buk", "edited": false, "created_utc": 1472523098, "controversiality": 0, "author_flair_text": null, "body": "Dynamic analysis is by far the fastest way to analyze these macros.  Get you a VM with word installed.  Disconnect it from the network.  Preferably run winword in something like sandboxie but not required.  Open the doc up in winword and open the macro editor and then step into it.  I set a breakpoint at the end of the string decryption function and then just run it.  Look for method calls on objects like run and send as these are good indicators of places to put breakpoints.  ", "parent_id": null, "author": "byteguard", "distinguished": null, "retrieved_utc": 1473672802, "updated_utc": 1668787431, "body_sha1": "ed16dfe73ba83bed5f2932d817282b5387e8beec", "nest_level": 1, "utc_datetime_str": "2016-08-30 02:11:38"}, {"gilded": 0, "subreddit_id": "t5_2qrkp", "subreddit": "Malware", "score": 5, "author_flair_css_class": null, "ups": 5, "stickied": false, "id": "d71zjrp", "distinguished": null, "author": "iphelix", "parent_id": null, "body": "If this is a 64-bit system, try running fakenet64.exe instead. Also, if you are using compiled binaries, you don't need to install Python or any dependencies. Just drop the archive into your analysis box and double click on the respective binary.", "author_flair_text": null, "controversiality": 0, "created_utc": 1472517995, "edited": false, "link_id": "t3_508akk", "retrieved_utc": 1473671654, "updated_utc": 1668787427, "body_sha1": "8e28ca492f455e8a291dd18589fac3554b552ad5", "nest_level": 1, "utc_datetime_str": "2016-08-30 00:46:35"}, {"ups": 1, "stickied": false, "id": "d71wi2r", "author_flair_css_class": null, "score": 1, "gilded": 0, "subreddit_id": "t5_2qrkp", "subreddit": "Malware", "edited": false, "link_id": "t3_507buk", "author_flair_text": null, "controversiality": 0, "created_utc": 1472513553, "body": "Gotta say, that sounds tedious as hell.", "distinguished": null, "parent_id": 28724490282, "author": "Flalaski", "retrieved_utc": 1473670587, "updated_utc": 1668787423, "body_sha1": "71b4adf334264f2ff9cabf79a4108362fdbf3d42", "utc_datetime_str": "2016-08-29 23:32:33"}, {"edited": false, "link_id": "t3_507buk", "author_flair_text": null, "controversiality": 0, "created_utc": 1472509381, "body": "Huh, that's really clever. Thanks for taking a look at that, it's neat to see how malicious macros work. ", "distinguished": null, "parent_id": 28724470676, "author": "gnzla", "ups": 1, "stickied": false, "id": "d71tn50", "author_flair_css_class": null, "score": 1, "gilded": 0, "subreddit_id": "t5_2qrkp", "subreddit": "Malware", "retrieved_utc": 1473669626, "updated_utc": 1668787420, "body_sha1": "791dc11c6eefbc0d06f7e8538f802627001071b4", "utc_datetime_str": "2016-08-29 22:23:01"}, {"subreddit": "Malware", "subreddit_id": "t5_2qrkp", "gilded": 0, "score": 4, "author_flair_css_class": null, "id": "d71tiju", "stickied": false, "ups": 4, "author": "Urd", "parent_id": 28724476864, "distinguished": null, "body": "I did it by hand, just start renaming variables for what it seems like their doing and go from there.  There were a couple of functions that didn't do anything except return what they were passed so those could be removed.  Some things become easily recognizable once you see them enough, e.g. the obj.Open obj.Send obj.Status pattern is related to ajax requests, so it's probably downloading something.  That's very common in jscript/vbscript malware.  Then once I trimmed it down a bit I took out the decoder function into a vb file and executed it on all the obfuscated strings.", "created_utc": 1472509194, "controversiality": 0, "author_flair_text": null, "link_id": "t3_507buk", "edited": false, "retrieved_utc": 1473669585, "updated_utc": 1668787420, "body_sha1": "bfe06cabe43aac0f4a49815cfb7efdc8a0695ba0", "utc_datetime_str": "2016-08-29 22:19:54"}, {"id": "d71t874", "stickied": false, "ups": 1, "author_flair_css_class": null, "score": 1, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "gilded": 0, "link_id": "t3_507buk", "edited": false, "created_utc": 1472508781, "controversiality": 0, "author_flair_text": null, "body": "Dude!!! Thank you very much for this. Would you mind sharing how you deobfuscated the macro?", "author": "El_Dorado_Native", "parent_id": 28724470676, "distinguished": null, "retrieved_utc": 1473669492, "updated_utc": 1668787420, "body_sha1": "73729b842a03eceeb8e16d9c07da674b97210ba8", "utc_datetime_str": "2016-08-29 22:13:01"}, {"link_id": "t3_507buk", "edited": true, "created_utc": 1472508592, "controversiality": 0, "author_flair_text": null, "body": "Here is the gist of the deobfuscated code: http://pastebin.com/y16Qg4fK\n\n\nIt does a couple of checks to try to catch sandboxes and the like. First it checks if there are less than 3 recent files opened in word/excel, and if so stops execution.  Then it makes a request to maxmind to get the machines geoip city and compares it to a blacklist, stopping execution if there is a hit.  If both of those checks pass it executes some powershell to download and execute a file.\n\nHere is what is downloaded:\n\nhttps://www.virustotal.com/en/file/9e6c446fbd6312a031e0616b171292d94f3d91be634d50398b770bda18ec26a6/analysis/1472509616/\n\nhttps://www.hybrid-analysis.com/sample/9e6c446fbd6312a031e0616b171292d94f3d91be634d50398b770bda18ec26a6?environmentId=100\n\nhttps://malwr.com/analysis/ZTM2YzA3MTFjMTJiNGE0MmE4ZDVlZjIzOTQ2ODhmZDM/\n\n\nThe host that the downloaded payload is contacting seems to be fast-fluxing (http://domainsn.co/en/web-sniffer/obzvbpslwd.com).\n", "author": "Urd", "parent_id": null, "distinguished": null, "id": "d71t3f8", "stickied": false, "ups": 7, "author_flair_css_class": null, "score": 7, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "gilded": 0, "retrieved_utc": 1473669449, "updated_utc": 1668787420, "body_sha1": "62b963a233f59e26f3ba5f91e7e4ce4e0cb34e10", "edited_on": 1472510100, "nest_level": 1, "utc_datetime_str": "2016-08-29 22:09:52"}, {"author": "Sam-Gunn", "parent_id": 28724409237, "distinguished": null, "body": "teredo.ipv6.microsoft.com is normal. It's some sort of Ipv6 to IPv4 translation thingy the Windows OS runs. \n\nMaxmind is geo-ip stuff. But whether or not the malware made it is questionable. \n\nThose are pretty vague. \n\nDoes the macro attempt to modify anything outside of Word? Does it actually do anything?\n\nWe've run into a ton of these macros, half of them appear to be built just for confusion purposes and contain a lot of spaghetti code.", "created_utc": 1472507619, "controversiality": 0, "author_flair_text": null, "link_id": "t3_507buk", "edited": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "gilded": 0, "score": 1, "author_flair_css_class": null, "id": "d71se7y", "stickied": false, "ups": 1, "retrieved_utc": 1473669219, "updated_utc": 1668787419, "body_sha1": "d6997bb6f925e22cb5f9e44d0ef0352e3c918f73", "utc_datetime_str": "2016-08-29 21:53:39"}], "error": null, "metadata": {"es": {"took": 59, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 16, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1472454060000}}}, {"range": {"created_utc": {"lt": 1472540460000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1472454060000}}},{\"range\":{\"created_utc\":{\"lt\":1472540460000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1673017478.2171538, "api_request_start": 1674104926.8139625, "api_request_end": 1674104926.912956, "api_total_time": 0.09899353981018066}}