{"data": [{"subreddit": "Malware", "author": "f00l", "edited": false, "distinguished": null, "stickied": false, "author_flair_text": null, "created_utc": 1460097065, "gilded": 0, "author_flair_css_class": null, "subreddit_id": "t5_2qrkp", "score": 1, "parent_id": 28408690702, "body": "Dump the traffic. If Locky can't contact its hardcoded C2s it will initialize the DGA and you should see DNS-lookups of random looking domains.", "ups": 1, "id": "d1umvl5", "link_id": "t3_4dp5gc", "controversiality": 0, "retrieved_utc": 1463300719, "updated_utc": 1668782079, "body_sha1": "349627c1c5f4a0a3bc0f58df4600b21876133baa", "utc_datetime_str": "2016-04-08 06:31:05"}, {"stickied": false, "created_utc": 1460093999, "gilded": 0, "author_flair_text": null, "subreddit": "Malware", "author": "reload01", "edited": false, "distinguished": null, "parent_id": null, "score": 2, "body": "interesting articles, thanks!", "ups": 2, "controversiality": 0, "link_id": "t3_4dqnml", "id": "d1ulrhr", "subreddit_id": "t5_2qrkp", "author_flair_css_class": null, "retrieved_utc": 1463300195, "updated_utc": 1668782078, "body_sha1": "2b8fc38b58588fee60c19ad484fc6bd57af1caca", "nest_level": 1, "utc_datetime_str": "2016-04-08 05:39:59"}, {"distinguished": null, "edited": false, "subreddit": "Malware", "author": "iCkerous", "gilded": 0, "created_utc": 1460081663, "author_flair_text": null, "stickied": false, "subreddit_id": "t5_2qrkp", "author_flair_css_class": null, "controversiality": 0, "link_id": "t3_4dp5gc", "id": "d1uf6w4", "ups": 2, "body": "All the samples I've seen are not vm aware.  Do you have a sample that is? ", "parent_id": 28408097512, "score": 2, "retrieved_utc": 1463297032, "updated_utc": 1668782073, "body_sha1": "1bfac22ee144d85ba73549800511f2e87661a0bd", "utc_datetime_str": "2016-04-08 02:14:23"}, {"subreddit_id": "t5_2qrkp", "author_flair_css_class": null, "link_id": "t3_4dltmk", "controversiality": 0, "id": "d1u3qth", "parent_id": 28407923948, "score": 1, "ups": 1, "body": "Hello TheYear2045,\n\nTo answer your question, you should know how AVs or Endpoint protection works. Here is my opinion.\n\nThere is mainly two ways to detect malwares, you can use static detection or dynamic detection.\n\nThe old way was using some kind of checksums over the file, like a custom CRC which take the hash over some part of time, or something like a fuzzy hash, wildcards or probably using graphs. This is a simple static detection and you can see immediately how easy is to break that. Then, AVs start to use heuristics (statically) by trying to detect malwares in a more generic way by using some flags in the PE layout, like the entropy, data in the overlay, section names, API imported, etc. So now, with this kind of protection, a generic rule could detect all the samples because they are packed/crypted using the same packer/crypter. You can defeat this method just by changing your encryption, adding more junk code, permutations, trying to look like a clean app, etc.\n\nStatic detection is good because it is fast and does not require to run the file. But as you see, looking just at the file as a raw data to decide if it is malware or clean file is not practical and could also lead easily to false positives because clean apps also have the right to use custom packers..\n\nNow, AVs need a detect the malware whatever packer/crypter was used, then behavioral or dynamic analysis take places. So, AVs start to use some sandboxing either by emulation or virtualization. And there are many ways to achieve this. So now, if you're packer/crypter just crypt the file then unpack it at runtime, sandboxes would not care how hard your crypted your file because at some point you would need to unpack your code and show your malicious behavior, and they would catch you their. How ? they save same flags but for behaviors which then you can't hide easily. For example, a banker would need to inject into browser and hooking some apis. This is easily detectable because the sandboxe would catch this behavior by hooking some apis. So just imagine, DarkComet for example is a very well known RAT and all AVs should have a good behaviour detection over it, so even if you hardly crypt a darkcomet sample, at some point they payload will start then AVs will get it. Another example, many ransomwares delete shadow copy files like Locky. Imagine AV have a rule whhich say if you see that a process is trying to delete shadow file, block it. There is no way then you can hide this, so even runtime crypters would be quiet useless here because you can't escape that.\nSo bad guys start to insert fake apis, delay execution so they force the sandbox to leave early, use anti-emulation and anti-vm, decrypt strings on the fly and free memory after usage, use legitimate windows apps like powershell, wscript, abuse WMI, etc. So bad guys tries to attack the sandbox before getting to the payload. In the other side, AVs keep fixing anti-tricks and they react as well and keep improving their systems. But you can always fool them, let me give you an example, for example, some Tinba variants start to count the number of cores in CPU to catch automated systems or sandboxes. So as long as you find tricks like this, you defeat them.\n\nMachine learning is something that helps because if you already detect some early variant of some malwares, then that could help catching the new ones. But, ML need always that your trained your set against 'malwares' and it cannot see completely new malwares.\nThen, there is companies like CrowdStrike, Brodium, Cylance and .... They use sandboxing as well, in the cloud. It means they have their sandboxes running in the cloud. They use difference technologies, that could be just normal inline hooking like Cuckoo, it could be a full system emulation like Lastline or some hypervisor based approach. They are trying to perform more stealth monitoring and have full control over the sample. But theses systems also suffer from some problems. First, you can try to delay execution, they are numerous of ways to do so, you can detect easily that it is an automated system, does not matter how hard they are trying to make it looks like real by clicking on the mouse, changing background wallpaper of desktop, you can always find a way ... and that's how it is. Sometimes, some malware like Bedep are fileless, if they cannot block the exploit, then depending on the client which is (mostly a kernel mode driver) could miss that execution of the malware then nothing uploaded to their cloud to be scanned. Note the difference between AVs and End protection systems is that the number of samples which should be processed is significantly different.\n\nWhitelisting is another way to let only what you trust to run and prevent everything else. This is nothing new, I don't have experience to know how effective it is. But that would definitely not work for end users. Not practical IMHO.\nAll in all, behavior detection works well against crypters because you cannot hide some malicious events easily.\n\nNoteworthy.", "distinguished": null, "edited": false, "subreddit": "Malware", "author": "LordNoteworthy", "created_utc": 1460064550, "gilded": 0, "author_flair_text": null, "stickied": false, "retrieved_utc": 1463291575, "updated_utc": 1668782064, "body_sha1": "3859adc59bae21260a25fc4b1a5db474ac1d7dfb", "utc_datetime_str": "2016-04-07 21:29:10"}, {"author_flair_text": null, "gilded": 0, "created_utc": 1460063927, "stickied": false, "distinguished": null, "edited": true, "author": "[deleted]", "subreddit": "Malware", "id": "d1u3a8e", "controversiality": 0, "link_id": "t3_4dltmk", "body": "[deleted]", "ups": 1, "score": 1, "parent_id": null, "author_flair_css_class": null, "subreddit_id": "t5_2qrkp", "retrieved_utc": 1463291358, "updated_utc": 1668782064, "body_sha1": "228f7d207920fb84335fac5b2b06ed7b472ece9e", "edited_on": 1460064301, "nest_level": 1, "utc_datetime_str": "2016-04-07 21:18:47"}, {"author_flair_css_class": null, "subreddit_id": "t5_2qrkp", "id": "d1u1ewz", "controversiality": 0, "link_id": "t3_4dp5gc", "ups": 1, "body": "Lulz", "parent_id": 28407976550, "score": 1, "edited": false, "distinguished": null, "author": "pres82", "subreddit": "Malware", "author_flair_text": null, "gilded": 0, "created_utc": 1460061500, "stickied": false, "retrieved_utc": 1463290461, "updated_utc": 1668782061, "body_sha1": "51110af5d1b83f8a35b5f0936eee0e0c529fb86a", "utc_datetime_str": "2016-04-07 20:38:20"}, {"stickied": false, "author_flair_text": null, "created_utc": 1460056537, "gilded": 0, "subreddit": "Malware", "author": "LightningRurik", "edited": false, "distinguished": null, "score": 18, "parent_id": null, "body": "In my biased experience, 90% of it.\n\n%UserProfile%\n%AppData%\n%Temp%\n\nGone are the days of every user having local admin privileges, so easiest to just entrench in the user's folder. ", "ups": 18, "id": "d1txgyw", "link_id": "t3_4dsjg4", "controversiality": 0, "author_flair_css_class": null, "subreddit_id": "t5_2qrkp", "retrieved_utc": 1463288602, "updated_utc": 1668782055, "body_sha1": "6b7947fdf8c94553235433fee33ac54879370df9", "nest_level": 1, "utc_datetime_str": "2016-04-07 19:15:37"}, {"body": "This is most likely the case. I'm working on getting a newer version that will have their servers up.", "ups": 2, "parent_id": 28408686898, "score": 2, "controversiality": 0, "link_id": "t3_4dp5gc", "id": "d1tsu1a", "subreddit_id": "t5_2qrkp", "author_flair_css_class": null, "stickied": false, "gilded": 0, "created_utc": 1460050668, "author_flair_text": null, "author": "Pavlovs_Hot_Dogs", "subreddit": "Malware", "distinguished": null, "edited": false, "retrieved_utc": 1463286406, "updated_utc": 1668782051, "body_sha1": "fa1876aa5800c23e99215b98475e2fbf8787fe4a", "utc_datetime_str": "2016-04-07 17:37:48"}, {"author": "calicotrinket", "subreddit": "Malware", "distinguished": null, "edited": false, "stickied": false, "author_flair_text": null, "created_utc": 1460050567, "gilded": 0, "author_flair_css_class": null, "subreddit_id": "t5_2qrkp", "parent_id": null, "score": 2, "body": "Maybe the C2C server has changed and is not responding?", "ups": 2, "id": "d1tsr3m", "link_id": "t3_4dp5gc", "controversiality": 0, "retrieved_utc": 1463286367, "updated_utc": 1668782051, "body_sha1": "e10f47854bc90b8bc5fdaaf51600bb324bff9a39", "nest_level": 1, "utc_datetime_str": "2016-04-07 17:36:07"}, {"edited": false, "distinguished": null, "subreddit": "Malware", "author": "GlassSec", "author_flair_text": null, "gilded": 0, "created_utc": 1460040234, "stickied": false, "author_flair_css_class": null, "subreddit_id": "t5_2qrkp", "id": "d1tkide", "link_id": "t3_4dn5ng", "controversiality": 0, "body": "El_Zilcho, Ransomware can be complicated but, at the end of the day, there are some certain facts that remain pretty simple. Ransomware needs to know what files are present in order to work.", "ups": 1, "score": 1, "parent_id": 28407859739, "retrieved_utc": 1463282471, "updated_utc": 1668782047, "body_sha1": "3c0f8451bbd75e93c345becfe29f11ca05fb84d7", "utc_datetime_str": "2016-04-07 14:43:54"}], "error": null, "metadata": {"es": {"took": 111, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 21, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1460012460000}}}, {"range": {"created_utc": {"lt": 1460098860000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1460012460000}}},{\"range\":{\"created_utc\":{\"lt\":1460098860000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1673017478.2578893, "api_request_start": 1674104547.8371396, "api_request_end": 1674104547.9899893, "api_total_time": 0.15284967422485352}}