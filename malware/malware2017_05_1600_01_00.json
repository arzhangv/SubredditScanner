{"data": [{"author": "Sudosev", "author_flair_css_class": null, "author_flair_text": null, "body": "Please ensure that your testing environment is fit for dealing with Wcry.  If you edit it and allow a new variant to escape your lab, it could cause major issues.", "can_gild": true, "controversiality": 0, "created_utc": 1494995013, "distinguished": null, "edited": false, "gilded": 0, "id": "dhnuppv", "link_id": "t3_6blozd", "parent_id": null, "score": 15, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1496589567, "updated_utc": 1668771409, "body_sha1": "a0649c89a274e19c24aeb3f51598bc5a6d7e4a25", "nest_level": 1, "utc_datetime_str": "2017-05-17 04:23:33"}, {"author": "de_hatron", "author_flair_css_class": null, "author_flair_text": null, "body": "https://gist.github.com/rain-1/989428fa5504f378b993ee6efbc0b168", "can_gild": true, "controversiality": 0, "created_utc": 1494994067, "distinguished": null, "edited": false, "gilded": 0, "id": "dhnu4o9", "link_id": "t3_6blozd", "parent_id": null, "score": 7, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1496589287, "updated_utc": 1668771408, "body_sha1": "8c9022d4b06197e0072f94d8406efba85fe6f254", "nest_level": 1, "utc_datetime_str": "2017-05-17 04:07:47"}, {"author": "hacksauce", "author_flair_css_class": null, "author_flair_text": null, "body": "I regularly see other 'scareware' style webpages that purport to be ransomware and ask for money.  All they are is a browser instance. and they're fairly harmless, if scary for most end users.  I've not seen one that uses Wannacrypt yet, but I'm not surprised that someone is doing so. ", "can_gild": true, "controversiality": 0, "created_utc": 1494988512, "distinguished": null, "edited": false, "gilded": 0, "id": "dhnq1d7", "link_id": "t3_6biltl", "parent_id": null, "score": 1, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1496587318, "updated_utc": 1668771399, "body_sha1": "b5d00ed99aeb3c9ad99d2d4851b2cf1fd68d83c3", "nest_level": 1, "utc_datetime_str": "2017-05-17 02:35:12"}, {"author": "maha420", "author_flair_css_class": null, "author_flair_text": null, "body": "The domain that acts as a killswitch has been registered and sinkholed, rendering the original version of this fairly benign, as long as your PC can resolve it.  There are apparently variants without killswitch domains, though.  This thing spreads via SMB, so make sure you're blocking port 445.  With windows firewall if nothing else. ", "can_gild": true, "controversiality": 0, "created_utc": 1494987928, "distinguished": null, "edited": false, "gilded": 0, "id": "dhnpjpm", "link_id": "t3_6biltl", "parent_id": null, "score": 3, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1496587079, "updated_utc": 1668771398, "body_sha1": "509831718abb88341e13c263e212bf3e9d8887c0", "nest_level": 1, "utc_datetime_str": "2017-05-17 02:25:28"}, {"author": "[deleted]", "author_flair_css_class": null, "author_flair_text": null, "body": "[removed]", "can_gild": true, "controversiality": 0, "created_utc": 1494977321, "distinguished": null, "edited": false, "gilded": 0, "id": "dhngutd", "link_id": "t3_6bkvlt", "parent_id": null, "score": 1, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1496582828, "updated_utc": 1668771380, "body_sha1": "fe993932d6dced4c0a879e9aa5d7a6e0fbb467f5", "nest_level": 1, "utc_datetime_str": "2017-05-16 23:28:41"}, {"author": "NickCano", "author_flair_css_class": null, "author_flair_text": null, "body": "Also, a friend linked me to [this](https://yurichev.com/blog/weird_loop_optimization/) and said it may be something along these lines.", "can_gild": true, "controversiality": 0, "created_utc": 1494975739, "distinguished": null, "edited": false, "gilded": 0, "id": "dhnfnkx", "link_id": "t3_6bibke", "parent_id": 29365423179, "score": 1, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1496582249, "updated_utc": 1668771378, "body_sha1": "67c2e2ea25a8355719bb16633b9df32fe3285c6c", "utc_datetime_str": "2017-05-16 23:02:19"}, {"author": "[deleted]", "author_flair_css_class": null, "author_flair_text": null, "body": "[removed]", "can_gild": true, "controversiality": 0, "created_utc": 1494975507, "distinguished": null, "edited": false, "gilded": 0, "id": "dhnfh2c", "link_id": "t3_6bkvlt", "parent_id": null, "score": 1, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1496582160, "updated_utc": 1668771378, "body_sha1": "fe993932d6dced4c0a879e9aa5d7a6e0fbb467f5", "nest_level": 1, "utc_datetime_str": "2017-05-16 22:58:27"}, {"author": "NickCano", "author_flair_css_class": null, "author_flair_text": null, "body": "Some food for thought:\n\n1. There's an assumption here that this is a `__thiscall`. Have you validated this assumption? Are you sure it's not a `__fastcall` using `esi` to carry first arg?\n2. Even if it is a `__thiscall`, have you verified that this is, in fact, a vtable (is it in a section loaded from binary, is memory RO, do values point to functions)? A non-abstract class can be compiled with no vtable, and just happen to have a pointer to an array of pointers as it's first member.\n\nIf you're sure it's a `__thiscall` with a vtable, then it could simply be some function length calculation code. e.g.\n\n    void myfunc1() { // some code }\n    void myfunc2() { // nothing }\n    auto sizeOfMyfunc1 = (reinterpret_cast&lt;size_t&gt;(&amp;myfunc2) - reinterpret_cast&lt;size_t&gt;(&amp;myfunc1));\n\nAssuming the linker doesn't act funny and move shit around or inline anything, this can give you the number of bytes that comprise the code of `myfunc1`. Considering `&gt;&gt; 2` is the same as dividing by 4, they could be preparing to do something like copying the code into an array of pointer-sized elements, or overwriting it with a bunch of 4-byte operations.", "can_gild": true, "controversiality": 0, "created_utc": 1494974821, "distinguished": null, "edited": true, "gilded": 0, "id": "dhnexjf", "link_id": "t3_6bibke", "parent_id": 29364839137, "score": 2, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1496581899, "updated_utc": 1668771377, "body_sha1": "94e94adbb89119b79ab1864dad5ad0eb1746a0be", "edited_on": 1494975134, "utc_datetime_str": "2017-05-16 22:47:01"}, {"author": "peter_mack", "author_flair_css_class": null, "author_flair_text": null, "body": "as others have pointed out it could have just been a prank, maybe a picture sent on email or whatever. however it could still of been malware, just not actually wannacry. if malwarebytes didn't find anything you might want to try another product in case it missed it and something is still on the machine. Sophos are offering a free one year trial of their Home Premium product which actually includes their anti ransomware product which stopped the WannaCry attack. https://home.sophos.com/register/beta", "can_gild": true, "controversiality": 0, "created_utc": 1494970936, "distinguished": null, "edited": false, "gilded": 0, "id": "dhnbrcf", "link_id": "t3_6biltl", "parent_id": null, "score": 1, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1496580373, "updated_utc": 1668771374, "body_sha1": "74c201cc41a2c65c68efe8b430cff14932c6a739", "nest_level": 1, "utc_datetime_str": "2017-05-16 21:42:16"}, {"author": "ThePixelCoder", "author_flair_css_class": null, "author_flair_text": null, "body": "Thanks a lot! I'll definitely try that!", "can_gild": true, "controversiality": 0, "created_utc": 1494962900, "distinguished": null, "edited": false, "gilded": 0, "id": "dhn4jqn", "link_id": "t3_6bhulj", "parent_id": 29364826191, "score": 1, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "retrieved_utc": 1496576903, "updated_utc": 1668771364, "body_sha1": "ea0ee2d1dc50580b08f9c010a7832fe81dd85403", "utc_datetime_str": "2017-05-16 19:28:20"}], "error": null, "metadata": {"es": {"took": 239, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 33, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1494918060000}}}, {"range": {"created_utc": {"lt": 1495004460000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1494918060000}}},{\"range\":{\"created_utc\":{\"lt\":1495004460000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1673017478.2171538, "api_request_start": 1674105617.8201423, "api_request_end": 1674105618.093923, "api_total_time": 0.27378082275390625}}