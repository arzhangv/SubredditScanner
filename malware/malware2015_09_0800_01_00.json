{"data": [{"ups": 1, "gilded": 0, "distinguished": null, "score": 1, "author_flair_css_class": null, "created_utc": 1441766764, "author": "skiz420", "subreddit": "Malware", "id": "cuv6t2i", "body": "What are you filtering on to find the change to the file? What we are currently using is FSRM since we're a windows shop and using passive file screening to trip alerts via email to us based on file creation using a handful of broad keywords, primarily *decrypt* and *help_*. You can also make it email the user or run a script to disable the account or shutdown the machine if you can work out something. The help_ will flag for false positives but a few exclusions make quick work of any noise. It works well since the email hits the mailbox within a second and creates a ticket within 3-5. This also notes he location and owner of the file in the email alert so SOP we shut the machine down to minimize damage, restore the data and review the infected machine offline for any local data that can be saved from shadows before reimaging. I have some docs on step by step setup if anyone's interested. Always interested in new detection methods, I've built and played with probably 5 solutions and detection or prevention is the best I've found thus far.\n\nEdit: The keywords decrypt and help_ are wrapped in asterisk's but they don't agree with reddit formatting", "edited": true, "link_id": "t3_3k5cju", "controversiality": 0, "author_flair_text": null, "subreddit_id": "t5_2qrkp", "parent_id": null, "retrieved_utc": 1444249545, "updated_utc": 1668798252, "body_sha1": "e59eede6eb30f1fe56da4fb0c37e20b82f7b61b6", "edited_on": 1441767141, "nest_level": 1, "utc_datetime_str": "2015-09-09 02:46:04"}, {"id": "cuv5iuu", "body": "Thanks! I'll to check that out when I get to the office tomorrow. \n\nI've got the script in a working state to the point that if the files are tripped it send and email and then depending on the client its running on run execute a script. \n\nIt's working with me tripping it just need to try it in a somewhat live environment. \n\nWill defiantly post the script once I get to a point of release.", "edited": false, "link_id": "t3_3k5cju", "author_flair_text": null, "controversiality": 0, "parent_id": 27987455930, "subreddit_id": "t5_2qrkp", "ups": 2, "gilded": 0, "distinguished": null, "score": 2, "author_flair_css_class": null, "created_utc": 1441764624, "subreddit": "Malware", "author": "Novalok", "retrieved_utc": 1444248941, "updated_utc": 1668798250, "body_sha1": "15eede5d995d36389c0ac7a81efa0349bc94c64d", "utc_datetime_str": "2015-09-09 02:10:24"}, {"score": 1, "distinguished": null, "gilded": 0, "ups": 1, "subreddit": "Malware", "author": "_DMEW", "created_utc": 1441760976, "author_flair_css_class": null, "link_id": "t3_3j967o", "edited": false, "id": "cuv3bru", "body": "Thanks guys. I may do the NT hooking for more thorough analysis later on. For now, I found a really handy Cuckoo setting which is \"procmemdump=yes\". This flag will dump process memory from the coresponding analysis package. You can even do yara scanning on them during the processing/reporting stage.", "subreddit_id": "t5_2qrkp", "parent_id": null, "author_flair_text": null, "controversiality": 0, "retrieved_utc": 1444247905, "updated_utc": 1668798249, "body_sha1": "16d4675ddf675fc5f82271fd0041f84bd78e941d", "nest_level": 1, "utc_datetime_str": "2015-09-09 01:09:36"}, {"link_id": "t3_3jy3lu", "edited": false, "body": "All good dude. Don't think it caused that anyway. ", "id": "cuv1n5n", "subreddit_id": "t5_2qrkp", "parent_id": 27986917656, "controversiality": 0, "author_flair_text": null, "score": 1, "distinguished": null, "gilded": 0, "ups": 1, "subreddit": "Malware", "author": "Jatexi", "created_utc": 1441758103, "author_flair_css_class": null, "retrieved_utc": 1444247046, "updated_utc": 1668798248, "body_sha1": "7a2aa79aa59310a0657c12c53c6de4af9d467ef0", "utc_datetime_str": "2015-09-09 00:21:43"}, {"id": "cuv0b7e", "body": "You can try building this piece of crap: [hidden-tear](https://github.com/utkusen/hidden-tear), it should be exactly what you need and is not limited to needing an active C2. EDIT: It even has an offline mode already there for you. I'm curious to see your product when it is complete. ", "edited": false, "link_id": "t3_3k5cju", "controversiality": 0, "author_flair_text": null, "subreddit_id": "t5_2qrkp", "parent_id": null, "ups": 3, "gilded": 0, "distinguished": null, "score": 3, "author_flair_css_class": null, "created_utc": 1441755776, "author": "Nugsly", "subreddit": "Malware", "retrieved_utc": 1444246419, "updated_utc": 1668798247, "body_sha1": "2a02002ad7f9ec0a3f9aa1e7e512666aa012a08c", "nest_level": 1, "utc_datetime_str": "2015-09-08 23:42:56"}, {"score": 2, "distinguished": null, "gilded": 0, "ups": 2, "subreddit": "Malware", "author": "dtfinch", "created_utc": 1441753574, "author_flair_css_class": null, "link_id": "t3_3k5cju", "edited": false, "body": "I just replaced a random document with garbage and waited for the tripwire to detect that the previously known-valid file was now corrupted.\n\nNone of the file sizes or dates were modified in the attack I witnessed, and I'd expect any \"how to decrypt\" files they leave may vary in name in the future.", "id": "cuuz1ly", "subreddit_id": "t5_2qrkp", "parent_id": null, "controversiality": 0, "author_flair_text": null, "retrieved_utc": 1444245822, "updated_utc": 1668798247, "body_sha1": "9d6cc760c184db097cec9d85c87770b1d8b7ef60", "nest_level": 1, "utc_datetime_str": "2015-09-08 23:06:14"}, {"ups": 2, "gilded": 0, "distinguished": null, "score": 2, "author_flair_css_class": null, "created_utc": 1441751748, "subreddit": "Malware", "author": "iCkerous", "body": "And the c2s are normally changed after an attack.  Generally you need to obtain a sample that is hours old for it to still be active.\n\nGood luck!", "id": "cuuxzr9", "edited": false, "link_id": "t3_3k5cju", "author_flair_text": null, "controversiality": 0, "parent_id": 27987309504, "subreddit_id": "t5_2qrkp", "retrieved_utc": 1444245326, "updated_utc": 1668798246, "body_sha1": "48aef34b83a25f84fa72b79d634a197e832ac829", "utc_datetime_str": "2015-09-08 22:35:48"}, {"author_flair_css_class": null, "author": "lawrenceabrams", "subreddit": "Malware", "created_utc": 1441750372, "gilded": 0, "ups": 3, "score": 3, "distinguished": null, "author_flair_text": null, "controversiality": 0, "parent_id": null, "subreddit_id": "t5_2qrkp", "edited": false, "id": "cuux680", "body": "If C2 servers are down it's not going to kick in.  Try malwr.com", "link_id": "t3_3k5cju", "retrieved_utc": 1444244939, "updated_utc": 1668798246, "body_sha1": "e94ec6e40486c7c4826b0b00c1c5d3367d533953", "nest_level": 1, "utc_datetime_str": "2015-09-08 22:12:52"}, {"gilded": 0, "ups": 1, "score": 1, "distinguished": null, "author_flair_css_class": null, "author": "0x--", "subreddit": "Malware", "created_utc": 1441737385, "edited": false, "body": "Are you sure it's this link that caused that?\n\nIf so I think it's still in place I say sorry, so....sorry.", "id": "cuuorvc", "link_id": "t3_3jy3lu", "controversiality": 0, "author_flair_text": null, "parent_id": 27986314229, "subreddit_id": "t5_2qrkp", "retrieved_utc": 1444240916, "updated_utc": 1668798240, "body_sha1": "91436db96d26b0bb543377ad7df7acf86bffd5bd", "utc_datetime_str": "2015-09-08 18:36:25"}, {"link_id": "t3_3k3fw7", "id": "cuuih7n", "body": "http://securitywarrior.ca/index.php/2015/09/08/carbanak-gang-is-back-and-with-new-arsenal/", "edited": false, "subreddit_id": "t5_2qrkp", "parent_id": null, "controversiality": 0, "author_flair_text": null, "distinguished": null, "score": 2, "ups": 2, "gilded": 0, "created_utc": 1441727660, "author": "cyberphunkz", "subreddit": "Malware", "author_flair_css_class": null, "retrieved_utc": 1444237882, "updated_utc": 1668798236, "body_sha1": "1dfc5ed762c0f97dac96dc6f98bcbd451bc695f4", "nest_level": 1, "utc_datetime_str": "2015-09-08 15:54:20"}], "error": null, "metadata": {"es": {"took": 77, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 20, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1441695660000}}}, {"range": {"created_utc": {"lt": 1441782060000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1441695660000}}},{\"range\":{\"created_utc\":{\"lt\":1441782060000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1673017478.254743, "api_request_start": 1674103987.762008, "api_request_end": 1674103987.8779805, "api_total_time": 0.11597251892089844}}