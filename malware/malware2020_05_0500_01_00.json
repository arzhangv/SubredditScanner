{"data": [{"all_awardings": [], "associated_award": null, "author": "mmd0xFF", "author_created_utc": 1401729884, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_gtgda", "author_patreon_flair": false, "author_premium": false, "awarders": [], "body": "Okay, I let's assume you have a symbol's super stripped binaries that makes most of the sections is irrelevant, similar in their built process (i.e. both using gcc or both using cmake), same arch &amp; endianness. The below question is important:\n\n*\"Is the other's ELF main() function big or complexly coded, or having argument(s)? \"*\n\nComplex by meaning of: having plenty of calls to other original functions (omit the syscalls &amp; its wrappers), or involving encryption/packed/encoding process, or having some embedded files or data etc.\n\nIf this is the case then it would be better if you just reverse-engineered both and re-coded them into one code and recompiled. If I were you I would do this.\n\nIf the second ELF's main() is simple, straight (not packed/obfudcated) and short, like i.e. a shellcode, you **maybe** have a **slight** chance to tweak the first ELF's binary, as the base, to make its main() to call the desired opcodes as additional embedded offset somewhere to the first one (which is the code of main() from 2nd ELF) , and return back to first ELF main() at some point, or jump, depends on what you want.\n\nBut, that really depends on how the 2nd ELF's main() works, and you may need **to adjust headers of the first ELF** too if you embed it bigger than max recorded size in the headers. The formula to adjust size in header is like: \n\n    e_shoff + ( e_shentsize * e_shnum ) = +/- file_size\n\nSee [this info](https://en.wikipedia.org/wiki/Executable_and_Linkable_Format) for those header name's meanings.\n\nIf I may advise, re-coded them is lesser energy and work.", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "controversiality": 0, "created_utc": 1588716692, "distinguished": null, "edited": true, "gilded": 0, "gildings": {}, "id": "fplox3y", "is_submitter": false, "link_id": "t3_gdt0tw", "locked": false, "no_follow": true, "parent_id": 34198031435, "permalink": "/r/Malware/comments/gdt0tw/combine_two_elf_binaries/fplox3y/", "quarantined": false, "removal_reason": null, "score": 3, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1595045621, "updated_utc": 1668714966, "body_sha1": "97fc5ec59f32f56318e6cbdf0636f248dc707e5c", "edited_on": 1588720810, "utc_datetime_str": "2020-05-05 22:11:32"}, {"all_awardings": [], "associated_award": null, "author": "bangbinbash", "author_created_utc": null, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_59nbhepl", "author_patreon_flair": false, "author_premium": false, "awarders": [], "body": "Thanks I'll look at it again.\n\nI was looking at that site when grabbing some samples originally but it looked like every link just led to ads.\n\nMight have not hovered over the right link.", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "controversiality": 0, "created_utc": 1588703867, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "fpkzsbm", "is_submitter": false, "link_id": "t3_ge2tpo", "locked": false, "no_follow": true, "parent_id": 34198639540, "permalink": "/r/Malware/comments/ge2tpo/lokibot_jigsaw_malware_with_the_process_name/fpkzsbm/", "quarantined": false, "removal_reason": null, "score": 4, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1595033601, "updated_utc": 1668714936, "body_sha1": "4d22959a1e80280689832623891ac606e837d433", "utc_datetime_str": "2020-05-05 18:37:47"}, {"all_awardings": [], "associated_award": null, "author": "LMJR500Army", "author_created_utc": 1546746428, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_2xnjb0tb", "author_patreon_flair": false, "author_premium": false, "awarders": [], "body": "You could download a copy on tutorialjinni", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "controversiality": 0, "created_utc": 1588703741, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "fpkzj5g", "is_submitter": true, "link_id": "t3_ge2tpo", "locked": false, "no_follow": true, "parent_id": 34198595803, "permalink": "/r/Malware/comments/ge2tpo/lokibot_jigsaw_malware_with_the_process_name/fpkzj5g/", "quarantined": false, "removal_reason": null, "score": 4, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1595033460, "updated_utc": 1668714935, "body_sha1": "c218af3b22b1d54fa9e87c7ab92ab7ca630b388b", "utc_datetime_str": "2020-05-05 18:35:41"}, {"all_awardings": [], "associated_award": null, "author": "bangbinbash", "author_created_utc": null, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_59nbhepl", "author_patreon_flair": false, "author_premium": false, "awarders": [], "body": "Would like to get a copy if possible. \n\nI\u2019m running a POC for a new AV solution and I wanted to try some newer ransomware against it. \n\nThey\u2019ve all been able to detect wannacry, petrwrap and sodinokibi with the exception of one. (One didn\u2019t detect sodinokibi).", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "controversiality": 0, "created_utc": 1588703284, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "fpkylej", "is_submitter": false, "link_id": "t3_ge2tpo", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/ge2tpo/lokibot_jigsaw_malware_with_the_process_name/fpkylej/", "quarantined": false, "removal_reason": null, "score": 4, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1595033012, "updated_utc": 1668714934, "body_sha1": "35a48993a5adc4ba79b8f3fceb980d1935862995", "nest_level": 1, "utc_datetime_str": "2020-05-05 18:28:04"}, {"all_awardings": [], "associated_award": null, "author": "AutoModerator", "author_created_utc": 1325741068, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_6l4z3", "author_patreon_flair": false, "author_premium": true, "awarders": [], "body": "It looks like you are posting a question, possibly looking for technical support. \n\nThis subreddit\u2019s purpose is to discuss malware internals and technical details. *This is NOT a place for help with malware removal or various other end-user questions. Please redirect questions related to malware removal to /r/Antivirus or /r/techsupport. Ransomware related questions can be directed to /r/ransomware*\n\nIf this was removed in error, please message the moderators - we love reading quality content just as much as you do!\n\n\n*I am a bot, and this action was performed automatically. Please [contact the moderators of this subreddit](/message/compose/?to=/r/Malware) if you have any questions or concerns.*", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "controversiality": 0, "created_utc": 1588701381, "distinguished": "moderator", "edited": false, "gilded": 0, "gildings": {}, "id": "fpkur7v", "is_submitter": false, "link_id": "t3_ge2lul", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/ge2lul/lokibot_jigsaw_malware_process_not_even_a_single/fpkur7v/", "quarantined": false, "removal_reason": null, "score": 1, "send_replies": false, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1595031137, "updated_utc": 1668714930, "body_sha1": "240ff2447bb15e3553a1a89555ccd732d7f241bc", "nest_level": 1, "utc_datetime_str": "2020-05-05 17:56:21"}, {"all_awardings": [], "associated_award": null, "author": "TheMouthOfInfinity", "author_created_utc": 1510680406, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_kwo4054", "author_patreon_flair": false, "author_premium": false, "awarders": [], "body": "Pretty much this, it's absolutely not trivial and would need a lot of fixups, including (but not limited to) the things you mentioned.\n\nAlso, the target architecture must match, the ABI, the linked libraries etc.\nAlso, one of the programs might set up the memory or the environment in such a way it would still be incompatible woth the second program under the same process.\n\nIt's certainly doable, but it's a lot of work.\n\nIf you need it to be inside a single executable, and just one program executing the other, you'd have way more success just packaging them both into one binary, where the first executed program would then unpack and deploy the second once, from it's own memory.", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "controversiality": 0, "created_utc": 1588697604, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "fpkn466", "is_submitter": false, "link_id": "t3_gdt0tw", "locked": false, "no_follow": true, "parent_id": 34196020895, "permalink": "/r/Malware/comments/gdt0tw/combine_two_elf_binaries/fpkn466/", "quarantined": false, "removal_reason": null, "score": 2, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1595027459, "updated_utc": 1668714922, "body_sha1": "fa363ff7a7f8d831cbbcd8445ddf5d00aabfc27b", "utc_datetime_str": "2020-05-05 16:53:24"}, {"all_awardings": [], "associated_award": null, "author": "promach", "author_created_utc": 1368753149, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_bpftl", "author_patreon_flair": false, "author_premium": false, "awarders": [], "body": "No, I need two main() in two different ELF binaries to combine into a single main() in a single ELF binary.", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "controversiality": 0, "created_utc": 1588697300, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "fpkmhxn", "is_submitter": true, "link_id": "t3_gdt0tw", "locked": false, "no_follow": true, "parent_id": 34197232975, "permalink": "/r/Malware/comments/gdt0tw/combine_two_elf_binaries/fpkmhxn/", "quarantined": false, "removal_reason": null, "score": 1, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1595027162, "updated_utc": 1668714921, "body_sha1": "8b98e28dcbbc02fd6eb7836fbcbbfc521b148415", "utc_datetime_str": "2020-05-05 16:48:20"}, {"all_awardings": [], "associated_award": null, "author": "dkaye_mal_anst18", "author_created_utc": 1523825453, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_1760bxiz", "author_patreon_flair": false, "author_premium": false, "awarders": [], "body": "yeah no problem, thanks for your feedback :)", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "controversiality": 0, "created_utc": 1588693247, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "fpkejvw", "is_submitter": true, "link_id": "t3_gd1tl5", "locked": false, "no_follow": true, "parent_id": 34196907351, "permalink": "/r/Malware/comments/gd1tl5/systemcarefakeav_malware_analysis_paper/fpkejvw/", "quarantined": false, "removal_reason": null, "score": 2, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1595023281, "updated_utc": 1668714912, "body_sha1": "c61cc26eacf758743eb9bd24baf8084fd673fa4d", "utc_datetime_str": "2020-05-05 15:40:47"}, {"all_awardings": [], "associated_award": null, "author": "mmd0xFF", "author_created_utc": 1401729884, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_gtgda", "author_patreon_flair": false, "author_premium": false, "awarders": [], "body": "I did a couple efforts for the similar situation, for the research purpose, the first binary is small as a compiled ELF w/wrapped shellcode as the payload, and the second one is a tweaked \"ls\" binary that I want to run first bin's shellcode from.\n\nThe thing is, by the time I was about to tweak second one to call the shellcode loader called in the first one (which invoking both bins execution) I figured that's just as much effort as I needed just to patch the 2nd one with the 1st one and save executable code somewhere else in the first ELF as a data (db) to assembly load, and doing the approach afterward. Of course the same opcode's assembly and architecture will be needed.\n\nAnother approach was happened which in the end I have to compile both binaries in assembly using small ELF wrapper. \n\nIn my opinion, if your asked question is about the binary after execution in the memory the patch method also can be applied, you'll just have to be sure which workspace are those, a peek in /proc/pid/maps may help you.", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "controversiality": 0, "created_utc": 1588688314, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "fpk5du7", "is_submitter": false, "link_id": "t3_gdt0tw", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/gdt0tw/combine_two_elf_binaries/fpk5du7/", "quarantined": false, "removal_reason": null, "score": 2, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1595016510, "updated_utc": 1668714902, "body_sha1": "4ea134289e1accd13ef23336442603c385a64a13", "nest_level": 1, "utc_datetime_str": "2020-05-05 14:18:34"}, {"all_awardings": [], "associated_award": null, "author": "randomperson83", "author_created_utc": null, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_41oeegtz", "author_patreon_flair": false, "author_premium": false, "awarders": [], "body": "If they were compiled on the same machine you won't have an ABI mixup", "can_gild": true, "can_mod_post": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "controversiality": 0, "created_utc": 1588687136, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "fpk3bhy", "is_submitter": false, "link_id": "t3_gdt0tw", "locked": false, "no_follow": true, "parent_id": 34196037243, "permalink": "/r/Malware/comments/gdt0tw/combine_two_elf_binaries/fpk3bhy/", "quarantined": false, "removal_reason": null, "score": 2, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "retrieved_utc": 1595015416, "updated_utc": 1668714900, "body_sha1": "934cea3c1788bb61e0200f7782dec522152b7ff9", "utc_datetime_str": "2020-05-05 13:58:56"}], "error": null, "metadata": {"es": {"took": 111, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 24, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1588662060000}}}, {"range": {"created_utc": {"lt": 1588748460000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1588662060000}}},{\"range\":{\"created_utc\":{\"lt\":1588748460000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1673017478.2022774, "api_request_start": 1674109978.013194, "api_request_end": 1674109978.1703973, "api_total_time": 0.15720319747924805}}