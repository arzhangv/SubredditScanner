{"data": [{"created_utc": 1469245595, "author_flair_text": null, "score": 2, "author": "[deleted]", "controversiality": 0, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "stickied": false, "edited": true, "gilded": 0, "body": "[deleted]", "distinguished": null, "id": "d5n9pu9", "link_id": "t3_4tfrja", "parent_id": 28638298305, "author_flair_css_class": null, "ups": 2, "retrieved_utc": 1471619316, "updated_utc": 1668785979, "body_sha1": "228f7d207920fb84335fac5b2b06ed7b472ece9e", "edited_on": 1471355541, "utc_datetime_str": "2016-07-23 03:46:35"}, {"ups": 0, "author_flair_css_class": null, "parent_id": null, "link_id": "t3_4u2wgr", "distinguished": null, "id": "d5n0m7j", "body": "/r/outoftheloop", "gilded": 0, "edited": false, "stickied": false, "subreddit_id": "t5_2qrkp", "subreddit": "Malware", "author_flair_text": null, "author": "peeonyou", "score": 0, "controversiality": 0, "created_utc": 1469229419, "retrieved_utc": 1471614949, "updated_utc": 1668785972, "body_sha1": "b6287b3390ab20e13ca1c1de00f96cdb2e6339c9", "nest_level": 1, "utc_datetime_str": "2016-07-22 23:16:59"}, {"distinguished": null, "id": "d5mwe5a", "link_id": "t3_4u2wgr", "parent_id": null, "author_flair_css_class": null, "ups": 3, "created_utc": 1469222854, "author_flair_text": null, "score": 3, "author": "moutonplacide", "controversiality": 0, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "stickied": false, "edited": false, "body": "There is also other algorithms being used like in CTB-Locker with Elliptic Curves Crypto (ECC): https://blogs.sophos.com/2015/12/31/the-current-state-of-ransomware-ctb-locker/\n\nOthers play with ZIP or RAR formats (quite dumb, still efficient): http://www.bleepingcomputer.com/news/security/cryptohost-decrypted-locks-files-in-a-password-protected-rar-file/\n\nBut yes, I think that for ransomware coders, the easiest and most documented method is to use the RSA-AES combo.", "gilded": 0, "retrieved_utc": 1471612936, "updated_utc": 1668785968, "body_sha1": "ae5c4971d74b04c8953bcb04f05c236c4d01f599", "nest_level": 1, "utc_datetime_str": "2016-07-22 21:27:34"}, {"stickied": false, "subreddit_id": "t5_2qrkp", "body": "Thanks. You seem to be so passionate about infosec, as I am.\nI appreciate your advice, really helpful. \n\nHow much are you comfortable with networking ? Did you stop on the Net+ level, or studied more, such as the CCNA R&amp;S material, or the TCP/IP 1+2 volumes ? Do you find the Net+ level enough for hacking ? -Considering you job isn't pure pentesting though\n\nDo you plan to have the OSCP ?\nI will do my best, to be the best.", "gilded": 0, "edited": false, "created_utc": 1469219080, "subreddit": "Malware", "author_flair_text": null, "score": 1, "author": "LonVenu", "controversiality": 0, "author_flair_css_class": null, "parent_id": 28638252492, "ups": 1, "link_id": "t3_4tfbz6", "distinguished": null, "id": "d5mtmpa", "retrieved_utc": 1471611635, "updated_utc": 1668785966, "body_sha1": "241a5ad50885aceebd044e7927253e9f6c96477b", "utc_datetime_str": "2016-07-22 20:24:40"}, {"ups": 1, "parent_id": 28638490722, "author_flair_css_class": null, "id": "d5ms8t1", "distinguished": null, "link_id": "t3_4u2wgr", "edited": false, "gilded": 0, "body": "So your problem, as the ransomware author, is that you need to securely communicate some data to the victim. Assuming that this is not a targeted attack, you don't know who your victim is, ahead of time.\n\nNow, you can either 'bake-in' or include the necessary private/public keys into your malware, but then if that malware is analyzed, those keys are now known. Which means that someone could send data to your C&amp;C that was not originally intended for it. Exploitation could occur because of this.\n\nThe obvious mitigation is to only use those keys one time. Each instance of your ransomware would have a baked-in key before it is spammed to some target.\n\nOR\n\nYou could trust the victim machine to generate a proper RSA keypair for you. This means the ransomware is larger, and takes longer to communicate with C&amp;C after infection.\n\nIn each of the above instances, the ransomware must decrypt/encrypt RSA and AES + whatever else it is supposed to do.\n\nIt occurred to me, while typing this, that there is another way to perform this. (Shit, I think you mentioned it, re-reading your post.)\n\nYou could provide only RSA encrypt, and a public key from the C&amp;C. Have the victim PC generate a session key (an AES key) that is encrypted along with victim information, and sent to the C&amp;C server. At that point, you can drop RSA.\n\nThe C&amp;C server can then just encrypt with your AES session key (rotating it as the message) and the 2 of you can talk all day. The ransomware can then receive the AES key for encryption, without it going over the internet as plain text.\n\nPayment wouldn't be checked until the user attempted to verify payment. At that point, the same public key, and a random session key could be generated (because it doesn't matter anymore) by the victim, so that the AES key used for encryption can be properly delivered to a 'paying victim.' That reduces overhead, and the size of the ransomware, with only a loss to message authentication and authenticity.", "subreddit_id": "t5_2qrkp", "stickied": false, "controversiality": 0, "author_flair_text": null, "author": "jarxlots", "score": 1, "subreddit": "Malware", "created_utc": 1469217260, "retrieved_utc": 1471610982, "updated_utc": 1668785965, "body_sha1": "1dcc2bdc51fd8d94df1ddec7cbb296398c829e12", "utc_datetime_str": "2016-07-22 19:54:20"}, {"ups": 2, "parent_id": 28638212498, "author_flair_css_class": null, "id": "d5mm8v6", "distinguished": null, "link_id": "t3_4u2wgr", "edited": true, "body": "I know nothing about ransomware. Why a public/private key is generated on the victim's machine? I would think it would be less risky to use a public key provided by the C&amp;C server to establish a secure channel to share the keys, etc.. It could also be hardcoded or at least verify the CA on the victim's machine against tampering.", "gilded": 0, "subreddit_id": "t5_2qrkp", "stickied": false, "controversiality": 0, "author_flair_text": null, "author": "ecosystem_matters", "score": 2, "subreddit": "Malware", "created_utc": 1469209717, "retrieved_utc": 1471608074, "updated_utc": 1668785961, "body_sha1": "d9f722f7ebfe842a26c35c69d12091ee05c28669", "edited_on": 1469255086, "utc_datetime_str": "2016-07-22 17:48:37"}, {"body": "The confusion is my fault entirely. \n\nThat RSA key pair should be generated on the victim's PC, however, only the public key of the C&amp;C server is actually needed. It could just be included in the ransomware download, bypassing the time needed to generate an RSA keypair, and mitigating the possibility that the victim's PC will purposefully generate 'bad' RSA keys.\n\nInformation about the client (IDK what, probably IP address information, and PC hardware information to isolate individual victims into accounts that can be restored.) is sent to the C&amp;C, encrypted by the C&amp;C's public key. At that point, the C&amp;C could reply, but not in an encrypted form. The victim PC must share an RSA keypair, or one could be hardcoded into the ransomware. Either way, in order for the C&amp;C server to respond in an encrypted manner, the victim PC must have some RSA keypair, and that keypair's public must be held by the C&amp;C server, before, or during the infection process (but not before the encrypting of all of your data occurs.)\n\n1. You are infected by the ransomware. It communicates information about your PC, to a C&amp;C and it either has an RSA keypair, or generates an RSA keypair and sends the public key to the C&amp;C server. This sets up the encrypted channel between the C&amp;C and your PC.\n\n2. The C&amp;C server receives the information you sent, generates any necessary account information for tracking payment, and fulfillment (decrypting data for a paying victim.) on the back end. That's never communicated to your PC.\n\n3. The C&amp;C server generates an AES encryption key, and, using the public RSA key it received, or already knew about, it encrypts that AES key, and sends it back to the victim's PC.\n\n4. The victim's PC receives the encrypted message, decrypts with their built-in, or generated, private RSA key, then uses that decrypted AES key to encrypt data on the drive.\n\n5. When the ransomware has completed encrypting the data on the drive, the AES key is overwritten (lost, trashed) and messages describing how to pay your ransom, start showing up.\n\n6. You pay the ransom. The C&amp;C network verifies the transaction, and the AES key is again encrypted with the victim's public key, and sent to the victim's PC. Only this time, it will be decrypting data.", "gilded": 0, "edited": false, "stickied": false, "subreddit_id": "t5_2qrkp", "subreddit": "Malware", "score": 6, "author_flair_text": null, "author": "jarxlots", "controversiality": 0, "created_utc": 1469206951, "ups": 6, "author_flair_css_class": null, "parent_id": 28638311861, "link_id": "t3_4u2wgr", "distinguished": null, "id": "d5mk0du", "retrieved_utc": 1471606940, "updated_utc": 1668785959, "body_sha1": "1cf3e35f80fe3197240e1e55705f94f58c708e91", "utc_datetime_str": "2016-07-22 17:02:31"}, {"subreddit": "Malware", "controversiality": 0, "score": 1, "author_flair_text": null, "author": "Banangurkamacka", "created_utc": 1469205490, "gilded": 0, "body": "I think that the password is generated on the infected host not the c&amp;c. So the malware generate an AESkey then it encrypts it with a RSA public key downloaded from the c&amp;c.\n\nThis way no private keys need to be hardcoded into the malware and mitm-attacks are a non-issue", "edited": false, "stickied": false, "subreddit_id": "t5_2qrkp", "link_id": "t3_4u2wgr", "id": "d5miuql", "distinguished": null, "ups": 1, "author_flair_css_class": null, "parent_id": 28638311861, "retrieved_utc": 1471606396, "updated_utc": 1668785958, "body_sha1": "b935fafd9e67aad2459a3dfaa31f34917f9c3aec", "utc_datetime_str": "2016-07-22 16:38:10"}, {"author": "QSCFE", "author_flair_text": null, "score": 2, "controversiality": 0, "subreddit": "Malware", "created_utc": 1469204917, "edited": false, "body": "&gt;  delivering information about your PC to the ransomware's distributors, along with an RSA public key\n\nIs ransomware use built-in public RSA-key.  \n\n........\n\n1- you infected by spam or exploit, and after that The ransomware will communicate with  C&amp;C and upload information about your PC  and RSA public key.  \n2- After that i get lost.", "gilded": 0, "subreddit_id": "t5_2qrkp", "stickied": false, "distinguished": null, "id": "d5mieut", "link_id": "t3_4u2wgr", "ups": 2, "parent_id": 28638212498, "author_flair_css_class": null, "retrieved_utc": 1471606188, "updated_utc": 1668785958, "body_sha1": "bd740b562ca498b7e06bf336ad2431361e9e18e1", "utc_datetime_str": "2016-07-22 16:28:37"}, {"link_id": "t3_4tfrja", "distinguished": "admin", "id": "d5mi4e9", "ups": 6, "author_flair_css_class": null, "parent_id": null, "subreddit": "Malware", "author_flair_text": null, "author": "mmidden", "score": 6, "controversiality": 0, "created_utc": 1469204535, "gilded": 0, "body": "Really appreciate you bringing this to our attention \u2014 we take malware threats and reports very seriously. We've looked into this and have tracked down and removed the offending ad, and blacklisted the distributor. The steps we've actively taken to help prevent this from happening again are three fold:\n\n*Reduced live ad partners down to one that we trust is the best contender for preventing and resolving malvertising,\n\n*Took measures to reduce lower value bids within our ad exchange partner to filter out bad actors attempting to propagate malware at scale,\n\n*Looking into direct relationship with an external threat scanning service to assist in monitoring 100% of our ad inventory to allow immediate action in these cases \n\nThanks again,\n\nu/mmidden", "edited": true, "stickied": false, "subreddit_id": "t5_2qrkp", "retrieved_utc": 1471606051, "updated_utc": 1668785958, "body_sha1": "ad0919477f569544416a9726c02aa8c82e63c0a4", "edited_on": 1469204762, "nest_level": 1, "utc_datetime_str": "2016-07-22 16:22:15"}], "error": null, "metadata": {"es": {"took": 72, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 14, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1469170860000}}}, {"range": {"created_utc": {"lt": 1469257260000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1469170860000}}},{\"range\":{\"created_utc\":{\"lt\":1469257260000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1673945683.810305, "api_request_start": 1674104827.1382613, "api_request_end": 1674104827.240742, "api_total_time": 0.10248064994812012}}