{"data": [{"author_flair_text": null, "id": "ddxkk2s", "subreddit_id": "t5_2qrkp", "stickied": false, "edited": true, "controversiality": 0, "link_id": "t3_5uukf4", "author_flair_css_class": null, "created_utc": 1487489876, "body": "Yeah, I've definitely seen some different instances online of svchost.exe being infected by malware. So as you said, it makes more sense for svchost to be infected.. but since the white paper didn't mention it, does that mean it definitely wasn't zeroaccess? I guess I just don't know how \"wide ranging\" the paper is (I.e some zeroaccess might infect svchost.exe, but it was not mentioned or something) \n\n\nI read somewhere that there are different kinds or variations of meterpreter. Will they all be detectable by the procdump? \n\nI was also reading about custom payloads with similar capabilities of meterpreter.. I'm guessing it would be impossible to find these if they were used?", "gilded": 0, "score": 1, "subreddit": "Malware", "parent_id": 29140253394, "author": "Thrones33", "distinguished": null, "retrieved_utc": 1488963556, "updated_utc": 1668776879, "body_sha1": "6ae8bc8a55210c6a0463042e047b4b10d98ea46b", "edited_on": 1487490095, "utc_datetime_str": "2017-02-19 07:37:56"}, {"link_id": "t3_5uukf4", "controversiality": 0, "author_flair_css_class": null, "created_utc": 1487474104, "gilded": 0, "score": 3, "body": "Not a noob question at all. I misquoted your scenario. Explorer and svchost(s) are definitely different processes. \n\nActually it makes more sense (in many cases) for malware to inject into (or \"infect\") a svchost process. Explorer process lives in userland which does not give the malware SYSTEM privileges. This is debatable for being \"good\" or not from a malware perspective, because there are some benefits to having user privileges because of the way Windows Vista and newer versions segregate functionality between system and user processes. Either way svchost is a common place to inject malware.\n\nOnly way to get process artifacts is from a running process or a dump. You may find other artifacts on the hard drive though. Easiest way to see the meterpreter string I mentioned is to start a meterpreter session on a VM type:\n\ngetpid\nrun process_memdump -p &lt;pid from previous cmd&gt;\n\n[This is the process_memdump script by Carlos Perez](https://github.com/rapid7/metasploit-framework/blob/master/scripts/meterpreter/process_memdump.rb)\n\nIt is a meterpreter script.", "distinguished": null, "subreddit": "Malware", "parent_id": 29140174962, "author": "metapwnage", "author_flair_text": null, "id": "ddxcrf6", "stickied": false, "subreddit_id": "t5_2qrkp", "edited": false, "retrieved_utc": 1488959790, "updated_utc": 1668776872, "body_sha1": "019a8c9d6495c1be33df1fd37a15e43c7320e8e0", "utc_datetime_str": "2017-02-19 03:15:04"}, {"author_flair_css_class": null, "created_utc": 1487471494, "link_id": "t3_5uukf4", "controversiality": 0, "distinguished": null, "parent_id": 29139605186, "subreddit": "Malware", "author": "Thrones33", "gilded": 0, "score": 1, "body": "Very interesting, thanks for the detailed response! Hope you don't mind me throwing some noob questions your way..\n\nYou (and the white paper) mention explorer.exe as being infected, but I didn't see anything about svchost.exe in the article. (in my case it was svchost.exe) Are they intertwined or something? Like an infected svchost.exe is the same as an infected explorer.exe?\n\n\nThe infected computer doesn't run anymore, but I have the external drive. Will the procdump software still work in this situation? I may scan the contents of the drive for meterpreter and see what comes up for fun.\n\n\n\n", "author_flair_text": null, "id": "ddxb2wi", "edited": false, "stickied": false, "subreddit_id": "t5_2qrkp", "retrieved_utc": 1488958863, "updated_utc": 1668776871, "body_sha1": "b14c58d6eb1b433927438d62774a4127b6532112", "utc_datetime_str": "2017-02-19 02:31:34"}, {"id": "ddx9ol1", "author_flair_text": null, "stickied": false, "subreddit_id": "t5_2qrkp", "edited": false, "link_id": "t3_5uukf4", "controversiality": 0, "created_utc": 1487469338, "author_flair_css_class": null, "score": 1, "gilded": 0, "body": "Thank you for the link to that white paper. Very interesting read.", "distinguished": null, "author": "DanSec", "parent_id": 29139605186, "subreddit": "Malware", "retrieved_utc": 1488958156, "updated_utc": 1668776869, "body_sha1": "f75b1bcdf7a5fb0e4de92989c6f5c4016e5ebb5c", "utc_datetime_str": "2017-02-19 01:55:38"}, {"author_flair_css_class": null, "created_utc": 1487452883, "link_id": "t3_5uukf4", "controversiality": 0, "distinguished": null, "parent_id": null, "subreddit": "Malware", "author": "metapwnage", "gilded": 0, "score": 5, "body": "If you dump the process memory and run strings on the dump, you will conveniently see the word 'meterpreter' if I recall correctly. It's been a while since I did it, but give that a whirl. You can just use ProcDump from sysinternals to dump the memory of a process. SysInternals also has a windows implementation of strings.\n\nEdit:\nYes, some malware uses winlogon. I don't remember, but I think some malware uses winlogon to hook users as they login.\n\nThere is a registry key for winlogon that will usually just run userinit.exe but can be modified to run something else (malware). You can read about some persistence mechanisms [here](http://resources.infosecinstitute.com/common-malware-persistence-mechanisms/#gref)\n\nYou probably have winlogon from something injecting during boot, and have Explorer.exe injected after someone logs in - 2 processes. The winlogon stays perhaps in case a user logs off or another one logs on. There are other reasons malware might use more than one process, but this makes the most sense to me from the description of your issue.\n\nEdit2:\n\nnoaccess does apparently use the winlogon registry key in what Symantec calls a \"Type III infection\":\n\nHKEY_CURRENT_USER\\Software\\Microsoft\\Windows NT\\CurrentVersion\\Winlogon\\\n\nIf there is anything like this, you are still infected:\n\u201cShell\u201d = \u201cC:\\Documents and Settings\\Administrator\\Local Settings\\Application Data\\76c62c8e\\X\n\nSymantec has a white paper on noaccess, [Here](http://www.symantec.com/content/en/us/enterprise/media/security_response/whitepapers/zeroaccess_indepth.pdf), that goes into some good detail though it was written in 2013. Looks like a nasty rootkit with also nasty capabilities.", "author_flair_text": null, "id": "ddwyv9e", "edited": true, "stickied": false, "subreddit_id": "t5_2qrkp", "retrieved_utc": 1488952637, "updated_utc": 1668776858, "body_sha1": "ae6b86c70e94dc5be647d77507cf456f0ad9dcf3", "edited_on": 1487467709, "nest_level": 1, "utc_datetime_str": "2017-02-18 21:21:23"}, {"link_id": "t3_5mpzi0", "controversiality": 0, "author_flair_css_class": null, "created_utc": 1487448662, "gilded": 0, "score": 1, "body": "Sorry to bug you again, just thought of another question for you :)\n\nWould it be common for a TDSS infection to inject code into system processes such as svchost.exe and winlogon.exe? I'm not sure it would even do that for one, let alone two processes.", "distinguished": null, "subreddit": "Malware", "parent_id": 29109567781, "author": "Thrones33", "author_flair_text": null, "id": "ddww0oi", "stickied": false, "subreddit_id": "t5_2qrkp", "edited": false, "retrieved_utc": 1488951263, "updated_utc": 1668776856, "body_sha1": "67b3e3ed503cd126c549d5e909e1b90d72f0f205", "utc_datetime_str": "2017-02-18 20:11:02"}, {"distinguished": null, "author": "Thrones33", "subreddit": "Malware", "parent_id": 29035252197, "score": 1, "gilded": 0, "body": "Hello again,\n\nWould it be common for a TDSS infection to inject code into system processes such as svchost.exe and winlogon.exe? I'm not sure it would even do that for one, let alone two processes. \n", "created_utc": 1487448603, "author_flair_css_class": null, "link_id": "t3_5mpzi0", "controversiality": 0, "edited": false, "stickied": false, "subreddit_id": "t5_2qrkp", "id": "ddwvz7c", "author_flair_text": null, "retrieved_utc": 1488951243, "updated_utc": 1668776856, "body_sha1": "42ebadd7ca22e89b1efe15c459f845ee1c5cfb54", "utc_datetime_str": "2017-02-18 20:10:03"}, {"author": "[deleted]", "subreddit": "Malware", "parent_id": null, "distinguished": null, "body": "[removed]", "score": 1, "gilded": 0, "created_utc": 1487431560, "author_flair_css_class": null, "controversiality": 0, "link_id": "t3_5ug1f0", "edited": false, "subreddit_id": "t5_2qrkp", "stickied": false, "id": "ddwkh70", "author_flair_text": null, "retrieved_utc": 1488945712, "updated_utc": 1668776845, "body_sha1": "fe993932d6dced4c0a879e9aa5d7a6e0fbb467f5", "nest_level": 1, "utc_datetime_str": "2017-02-18 15:26:00"}, {"gilded": 0, "score": 1, "body": "mine too", "distinguished": null, "subreddit": "Malware", "parent_id": null, "author": "JanetBlair001", "link_id": "t3_5ube3l", "controversiality": 0, "author_flair_css_class": null, "created_utc": 1487409986, "stickied": false, "subreddit_id": "t5_2qrkp", "edited": false, "author_flair_text": null, "id": "ddwcfcr", "retrieved_utc": 1488941845, "updated_utc": 1668776836, "body_sha1": "ee1bb8e245d2fbdffdbfece8913bf0adfd936a4a", "nest_level": 1, "utc_datetime_str": "2017-02-18 09:26:26"}], "error": null, "metadata": {"es": {"took": 72, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 9, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1487404860000}}}, {"range": {"created_utc": {"lt": 1487491260000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1487404860000}}},{\"range\":{\"created_utc\":{\"lt\":1487491260000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1674057444.3751245, "api_request_start": 1674105386.6217945, "api_request_end": 1674105386.7288802, "api_total_time": 0.1070857048034668}}