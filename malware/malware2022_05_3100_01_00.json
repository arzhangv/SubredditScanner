{"data": [{"all_awardings": [], "archived": false, "associated_award": null, "author": "sumdude1849", "author_created_utc": 1513973723, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_p9kakuv", "author_patreon_flair": false, "author_premium": false, "body": "Threat hunting should definitely involve reviewing new/novel/rare code execution in the environment, that should be one of the first sets of use cases set up. I don't think the process of proactive execution monitoring you describe can exist at all.\n\nTry setting this up in your environment now. As part of threat hunting, you should be collecting details of binaries executed in the environment. With this data you should be able to determine a few basic things about the type of review you're proposing, such as how many samples per week would need to be reviewed, what kind of safe-listing might work effectively, and so on. You can also start reviewing the samples to determine things like how long the reviews take on average, how many true positives are yielded, and what the impact is. If your review yields true positives the SOC missed, you will even have demonstrated the value that your process could have yielded. A key metric will be how much delay and lost productivity you introduce into the business processes where you propose implementing this solution, as you'll need to demonstrate that your solution is more valuable than the productivity lost.\n\nI suspect you will find that real-time human review of all new code execution yields little value, and is extremely expensive. I also expect that it will be quite error-prone, and lead to lots of lost business value. More automated/streamlined processes like application whitelisting, EDR tuning, etc are likely better routes.", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1654065160, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "iaravyr", "is_submitter": false, "link_id": "t3_v23fn9", "locked": false, "no_follow": true, "parent_id": 39831398114, "permalink": "/r/Malware/comments/v23fn9/preventing_malware_with_a_security_analyst/iaravyr/", "score": 2, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1655324799, "updated_utc": 1667912684, "body_sha1": "4f85369517f235822031c65eb2bddb98ce386ec7", "utc_datetime_str": "2022-06-01 06:32:40"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "Nesher86", "author_created_utc": 1613933574, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_886cosjl", "author_patreon_flair": false, "author_premium": false, "body": "We have something much simpler and effective than this, we use the malware's own defenses &amp; evasion techniques against it by changing the environment make it look like it's in a sandbox environment, VM or any other security tool/environment that it tries to avoid.. usually we stop the malware within a second or 2.. :)\n\nThe idea is to get a head of the threat actors and reducing overall operational load.. not to create additional load IMO (having the personnel doesn't mean that this is the way to use it)", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1654056420, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "iaqybol", "is_submitter": false, "link_id": "t3_v23fn9", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/v23fn9/preventing_malware_with_a_security_analyst/iaqybol/", "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1655325474, "updated_utc": 1667912665, "body_sha1": "705bc113269af227246b75bb9a3105dd458a4515", "nest_level": 1, "utc_datetime_str": "2022-06-01 04:07:00"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "greyyit", "author_created_utc": 1389287245, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_eqei1", "author_patreon_flair": false, "author_premium": false, "body": "Thanks for the reply.  I didn't think about threat hunting as looking at new code executed, but this approval of new code execution is even more pro-active than threat hunting.  You don't think they could co-exist?  I see this as way more of an effective solution for malware than AV.\n\nWhat are the better more streamlined ways to do this?  I was looking at Windows Defender Application Control and it looks like it took a major step back from AppLocker in its ease of use.", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1654049438, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "iaql3he", "is_submitter": true, "link_id": "t3_v23fn9", "locked": false, "no_follow": true, "parent_id": 39831295963, "permalink": "/r/Malware/comments/v23fn9/preventing_malware_with_a_security_analyst/iaql3he/", "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1655326299, "updated_utc": 1667912654, "body_sha1": "6e4c0a88a6ca53b459fddd6b7006910c3429c460", "utc_datetime_str": "2022-06-01 02:10:38"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "sumdude1849", "author_created_utc": 1513973723, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_p9kakuv", "author_patreon_flair": false, "author_premium": false, "body": "I appreciate the effort to think outside the box, but I think this idea is pretty off base. To be honest your SOC should already be looking at new code executed on the network via threat hunting. This doesn't have the up-to-the-minute review you propose, but I think your idea for the review is unrealistic. What person with the requisite skill to triage a binary is going to sit and work shift work looking at random shit all day? What quality of work will they produce with immediately responsive SLA's?  There are better, more streamlined ways to do this type of work already. The process you propose is just going to cause lots of business issues and heartache.", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1654048378, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "iaqiwnv", "is_submitter": false, "link_id": "t3_v23fn9", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/v23fn9/preventing_malware_with_a_security_analyst/iaqiwnv/", "score": 3, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1655326397, "updated_utc": 1667912652, "body_sha1": "a0211d81b2b7ffe500702fe1cca44fc872ecda50", "nest_level": 1, "utc_datetime_str": "2022-06-01 01:52:58"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "greyyit", "author_created_utc": 1389287245, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_eqei1", "author_patreon_flair": false, "author_premium": false, "body": "EDR is about detection and response, this application control is about prevention.  All code in the gold OS image that gets rolled out to workstations would be automatically approved because it's all known good.  Only *new programs* would get sent for approval.\n\nThis would be a streamlined malware analysis.  For example if the digital signature matches Microsoft then it's a probably an automatic go.  If there is no signature then VirusTotal checks are in order.  If it's never been seen by VirusTotal or has a few hits then maybe check the Sandbox report.  The average investigation time might be 10-15 minutes.\n\nThe scripts would be sent for investigation as well and go through a similar process as the binaries.  Is it encoded?  Obfuscated?  Does it use the internet? etc.", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1654047813, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "iaqhqjw", "is_submitter": true, "link_id": "t3_v23fn9", "locked": false, "no_follow": true, "parent_id": 39830983259, "permalink": "/r/Malware/comments/v23fn9/preventing_malware_with_a_security_analyst/iaqhqjw/", "score": -3, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1655326450, "updated_utc": 1667912651, "body_sha1": "1f6e00b5a5718fa8829eb9f1df487dcdd4f4d501", "utc_datetime_str": "2022-06-01 01:43:33"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "greyyit", "author_created_utc": 1389287245, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_eqei1", "author_patreon_flair": false, "author_premium": false, "body": "I read that paper before and this is different.  It wouldn't require that much overhead in a corporate environment where they're already paying for IDS and EDR analysts.  It could also be like AV for home users where you get a team of people reversing malware by paying a subscription.\n\nA Software Execution Approval company could get Sysmon like logs from home users and approve/deny software for all of their customers.  Similar to how AV companies create blacklists, a SEA(?) company would create whitelists.  For example if there's a new program that has never been seen by them before, the reverse engineer would get the entire binary, hash, etc. and do a quick analysis.  Let's say 10-15 minutes.  It would only be a 10-15 minute wait for just 1 person.  Everyone else would get the updated execution signature as a deny of that digital signature/hash if it was malware.\n\nI'm really interested in commercial software that might be like this.  Do you know what the name of the software?\n\nThanks for your reply!", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1654047113, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "iaqg8yz", "is_submitter": true, "link_id": "t3_v23fn9", "locked": false, "no_follow": true, "parent_id": 39830661195, "permalink": "/r/Malware/comments/v23fn9/preventing_malware_with_a_security_analyst/iaqg8yz/", "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1655326516, "updated_utc": 1667912650, "body_sha1": "ac429d6b317bc10c298b18106b8fa2cc54ccd1ed", "utc_datetime_str": "2022-06-01 01:31:53"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "lakitustanfield", "author_created_utc": 1586677361, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_5xn3tjxu", "author_patreon_flair": false, "author_premium": false, "body": "Uh... very much no. Like the other person said, application whitelisting is probably what you seek to implement. Assessing whether a piece of new software is actually safe is a time-consuming process. If you want a simple process like hashing a file and querying Virustotal, pretty much any endpoint agent/EDR can be configured to do that. But you're just giving yourself a largely false sense of security. There will be a high rate of unknown, benign or just random files if you send everything to an analyst without some sort of business need and approval process. In an organization of any size, the quantity of files coming in would be outrageous. The analyst would and should be pissed if that were their job. No, they should be handling EDR alerts on suspicious behavior or known-malicious files. \n\nI'd say in general, your proposed process is lacking experience with scale. The amount of executions that happen in a moment across an organization is enormous. Companies like Red Canary have a lot of experience ingesting command-line execution and behavioral data and detecting new threats, but they are *out of band*. They do not stop an execution just because it looks phishy because any false positives AT ALL would be catastrophic for their customers. Just try to audit \"suspicious looking executions\" on PowerShell.exe alone. It's a trip without a good EDR, and worse if you're not experienced.\n\nThe way a malware analysis pipeline typically works is that you get a file that you run in some kind of sandbox, audit its behavior and capabilities and some code, then determine if the business use case outweighs the risk. It's unlikely anyone reverse-engineers anywhere near the whole file, especially if it's over 1 megabyte of code.  If you have no behaviors or indications of maliciousness you have little to go on, but this should NOT mean that the software is approved everywhere, let alone signed. It should not go in the gold image, it should only be allowed on individual systems that have a use case. There should be EDR agents on these machines so activity can be monitored.\n\nAnd of course, it's more complicated than just whether the parent file and parameters are signed. Lots of cybercriminals use legitimate windows software to launch script payloads like PowerShell or VBScript. If in-memory payloads are running in signed/verified processes, you'll still have a huge blind spot. DLL hijacking is a big problem with that too. And honestly this is what happens in most modern incidents. Being file-centric instead of behavior-centric is bound to get you in trouble.", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1654045226, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "iaqc7dn", "is_submitter": false, "link_id": "t3_v23fn9", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/v23fn9/preventing_malware_with_a_security_analyst/iaqc7dn/", "score": 5, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1655326811, "updated_utc": 1667912647, "body_sha1": "a64a982a1c3381a880e0f29ecf9dd24ca51776a4", "nest_level": 1, "utc_datetime_str": "2022-06-01 01:00:26"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "allisbright", "author_created_utc": 1421599310, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_ksfyc", "author_patreon_flair": false, "author_premium": false, "body": "Application whitelisting is arguably only a good malware prevention solution if you're working in an industry that requires that level of security and is tolerant of the associated overhead. NIST has an excellent whitepaper on concepts, tradeoffs, and how to evaluate solutions: [https://nvlpubs.nist.gov/nistpubs/specialpublications/nist.sp.800-167.pdf](https://nvlpubs.nist.gov/nistpubs/specialpublications/nist.sp.800-167.pdf)\n\nThere are few security problems that are best solved by throwing security analysts at them for manual lookups and approval. I'm also not sure what the purpose of having them sign random unsigned code would be. There is plenty of commercial software that isn't Applocker that can be used rather than reinventing the wheel.", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1654041892, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "iaq5avf", "is_submitter": false, "link_id": "t3_v23fn9", "locked": false, "no_follow": false, "parent_id": null, "permalink": "/r/Malware/comments/v23fn9/preventing_malware_with_a_security_analyst/iaq5avf/", "score": 6, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1655327120, "updated_utc": 1667912640, "body_sha1": "62feb99e783be533421a0b0819e80eedc102a2b8", "nest_level": 1, "utc_datetime_str": "2022-06-01 00:04:52"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "[deleted]", "author_created_utc": null, "author_flair_background_color": "", "author_flair_css_class": null, "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": "dark", "body": "[removed]", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1654041077, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "iaq3n4s", "is_submitter": false, "link_id": "t3_v1s9rf", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/v1s9rf/warning_chrome_loader_targets_browser_with/iaq3n4s/", "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1655327194, "updated_utc": 1667924148, "body_sha1": "fe993932d6dced4c0a879e9aa5d7a6e0fbb467f5", "nest_level": 1, "utc_datetime_str": "2022-05-31 23:51:17"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "AutoModerator", "author_created_utc": 1325741068, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_6l4z3", "author_patreon_flair": false, "author_premium": true, "body": "It looks like you are posting a question, possibly looking for technical support. \n\nThis subreddit\u2019s purpose is to discuss malware internals and technical details. *This is NOT a place for help with malware removal or various other end-user questions. Please redirect questions related to malware removal to /r/Antivirus or /r/techsupport. Ransomware related questions can be directed to /r/ransomware*\n\nIf this was removed in error, please message the moderators **and be sure to include the link to the post** - we love reading quality content just as much as you do!\n\n\n*I am a bot, and this action was performed automatically. Please [contact the moderators of this subreddit](/message/compose/?to=/r/Malware) if you have any questions or concerns.*", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1654040911, "distinguished": "moderator", "edited": false, "gilded": 0, "gildings": {}, "id": "iaq3ani", "is_submitter": false, "link_id": "t3_v23j3e", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/v23j3e/preventing_malware_with_a_security_analyst/iaq3ani/", "score": 1, "score_hidden": false, "send_replies": false, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1655327210, "updated_utc": 1667924148, "body_sha1": "8f3bc8591114934970af180642927ea5aec9802e", "nest_level": 1, "utc_datetime_str": "2022-05-31 23:48:31"}], "error": null, "metadata": {"es": {"took": 171, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 816, "failed": 0}, "hits": {"total": {"value": 20, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1653980460000}}}, {"range": {"created_utc": {"lt": 1654066860000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1653980460000}}},{\"range\":{\"created_utc\":{\"lt\":1654066860000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1674057444.3751245, "api_request_start": 1674112028.653401, "api_request_end": 1674112028.8665237, "api_total_time": 0.21312284469604492}}