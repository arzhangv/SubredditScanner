{"data": [{"all_awardings": [], "archived": false, "associated_award": null, "author": "AutoModerator", "author_created_utc": 1325741068, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_6l4z3", "author_patreon_flair": false, "author_premium": true, "body": "It looks like you are posting a question, possibly looking for technical support. \n\nThis subreddit\u2019s purpose is to discuss malware internals and technical details. *This is NOT a place for help with malware removal or various other end-user questions. Please redirect questions related to malware removal to /r/Antivirus or /r/techsupport. Ransomware related questions can be directed to /r/ransomware*\n\nIf this was removed in error, please message the moderators **and be sure to include the link to the post** - we love reading quality content just as much as you do!\n\n\n*I am a bot, and this action was performed automatically. Please [contact the moderators of this subreddit](/message/compose/?to=/r/Malware) if you have any questions or concerns.*", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1637815993, "distinguished": "moderator", "edited": false, "gilded": 0, "gildings": {}, "id": "hlzxoza", "is_submitter": false, "link_id": "t3_r1od0a", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/r1od0a/how_to_remove_malwarevirus/hlzxoza/", "score": 1, "score_hidden": false, "send_replies": false, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1645916296, "updated_utc": 1668635696, "body_sha1": "8f3bc8591114934970af180642927ea5aec9802e", "nest_level": 1, "utc_datetime_str": "2021-11-25 04:53:13"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "anotherfakeassdude", "author_created_utc": 1591827233, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_6qafus6y", "author_patreon_flair": false, "author_premium": false, "body": "This looks like cobalt strike with its reflective dll injection. If this has been executed I would try and run 1768 on it to see if you can get any other beacon information from it.  I will also link a few other things.  I'm just a blue teamer just trying to help. Don't roast me if I am 100% off. \n\n1768.py:\n\n[https://github.com/DidierStevens/DidierStevensSuite/blob/master/1768.py](https://github.com/DidierStevens/DidierStevensSuite/blob/master/1768.py)\n\nCobalt Strike breakdown:\n\n[https://mez0.cc/posts/cobaltstrike-powershell-exec/](https://mez0.cc/posts/cobaltstrike-powershell-exec/) \n\nps.ps1\n\n[https://www.hybrid-analysis.com/sample/890746fdbea080fc3c42d8c2f485fa387eb38e2a92d9fb3f0c4004dc84d49c63/5ee5e7c361acad696a42de84](https://www.hybrid-analysis.com/sample/890746fdbea080fc3c42d8c2f485fa387eb38e2a92d9fb3f0c4004dc84d49c63/5ee5e7c361acad696a42de84)", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1637781824, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "hlxrmls", "is_submitter": false, "link_id": "t3_r0sl8b", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/r0sl8b/help_figuring_out_what_a_powershell_based_malware/hlxrmls/", "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1645920949, "updated_utc": 1668635508, "body_sha1": "5b5ea8788146a917fddfa9a071f72a29947595c5", "nest_level": 1, "utc_datetime_str": "2021-11-24 19:23:44"}, {"all_awardings": [], "archived": false, "associated_award": null, "author": "rickuf", "author_created_utc": 1485627059, "author_flair_background_color": null, "author_flair_css_class": null, "author_flair_richtext": [], "author_flair_template_id": null, "author_flair_text": null, "author_flair_text_color": null, "author_flair_type": "text", "author_fullname": "t2_14uyur", "author_patreon_flair": false, "author_premium": false, "body": "Just to add to the other comment, what you thought was a hexdump ist the actual shellcode that is executed. The script does the following using native API calls: allocate read-write-execute memory (VirtualAllocEx), copy the shellcode to that memory location (RtlMoveMemory) and execute it by creating a new thread (CreateThread). To know what that actual payload is, you have to analyze the shellcode. Maybe I'll take a look at it later when I find the time.", "can_gild": true, "collapsed": false, "collapsed_because_crowd_control": null, "collapsed_reason": null, "collapsed_reason_code": null, "comment_type": null, "controversiality": 0, "created_utc": 1637777595, "distinguished": null, "edited": false, "gilded": 0, "gildings": {}, "id": "hlxgrht", "is_submitter": false, "link_id": "t3_r0sl8b", "locked": false, "no_follow": true, "parent_id": null, "permalink": "/r/Malware/comments/r0sl8b/help_figuring_out_what_a_powershell_based_malware/hlxgrht/", "score": 1, "score_hidden": false, "send_replies": true, "stickied": false, "subreddit": "Malware", "subreddit_id": "t5_2qrkp", "subreddit_name_prefixed": "r/Malware", "subreddit_type": "public", "top_awarded_type": null, "total_awards_received": 0, "treatment_tags": [], "unrepliable_reason": null, "retrieved_utc": 1645921588, "updated_utc": 1668635483, "body_sha1": "2d062895779f3f87aa9c888e3c4c3706d4300d4c", "nest_level": 1, "utc_datetime_str": "2021-11-24 18:13:15"}], "error": null, "metadata": {"es": {"took": 206, "timed_out": false, "_shards": {"total": 824, "successful": 824, "skipped": 820, "failed": 0}, "hits": {"total": {"value": 3, "relation": "eq"}, "max_score": null}}, "es_query": {"size": 10, "query": {"bool": {"must": [{"bool": {"must": [{"range": {"created_utc": {"gte": 1637740860000}}}, {"range": {"created_utc": {"lt": 1637827260000}}}]}}, {"bool": {"should": [{"match": {"subreddit": "malware"}}], "minimum_should_match": 1}}]}}, "aggs": {}, "sort": {"created_utc": "desc"}}, "es_query2": "{\"size\":10,\"query\":{\"bool\":{\"must\":[{\"bool\":{\"must\":[{\"range\":{\"created_utc\":{\"gte\":1637740860000}}},{\"range\":{\"created_utc\":{\"lt\":1637827260000}}}]}},{\"bool\":{\"should\":[{\"match\":{\"subreddit\":\"malware\"}}],\"minimum_should_match\":1}}]}},\"aggs\":{},\"sort\":{\"created_utc\":\"desc\"}}", "api_launch_time": 1673017478.2273905, "api_request_start": 1674111523.5021534, "api_request_end": 1674111523.7345223, "api_total_time": 0.23236894607543945}}